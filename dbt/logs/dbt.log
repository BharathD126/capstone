[0m13:17:14.950689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A475597FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4757CAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4757CBD10>]}


============================== 13:17:14.951722 | e18204a7-2ac3-4178-9768-8df9a00b249a ==============================
[0m13:17:14.951722 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:17:14.966129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:17:15.031646 [info ] [MainThread]: dbt version: 1.9.1
[0m13:17:15.038299 [info ] [MainThread]: python version: 3.11.3
[0m13:17:15.040505 [info ] [MainThread]: python path: C:\Users\Bharath\Desktop\Trainings\venv\Scripts\python.exe
[0m13:17:15.043972 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m13:17:16.001053 [info ] [MainThread]: Using profiles dir at C:\Users\Bharath\.dbt
[0m13:17:16.007305 [info ] [MainThread]: Using profiles.yml file at C:\Users\Bharath\.dbt\profiles.yml
[0m13:17:16.008479 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Bharath\Desktop\Trainings\capston\dbt_project.yml
[0m13:17:16.011007 [info ] [MainThread]: adapter type: snowflake
[0m13:17:16.012004 [info ] [MainThread]: adapter version: 1.8.4
[0m13:17:16.127522 [info ] [MainThread]: Configuration:
[0m13:17:16.142980 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:17:16.144275 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:17:16.147094 [info ] [MainThread]: Required dependencies:
[0m13:17:16.148075 [debug] [MainThread]: Executing "git --help"
[0m13:17:16.161495 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m13:17:16.176124 [info ] [MainThread]: Connection:
[0m13:17:16.181211 [info ] [MainThread]:   account: cjepwka-vg49205
[0m13:17:16.182208 [info ] [MainThread]:   user: DBHARATH
[0m13:17:16.183996 [info ] [MainThread]:   database: BHARATH_SRC
[0m13:17:16.185991 [info ] [MainThread]:   warehouse: 'COMPUTE_WH'
[0m13:17:16.186992 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:17:16.188103 [info ] [MainThread]:   schema: DEV_SOUTCE_DB
[0m13:17:16.189669 [info ] [MainThread]:   authenticator: None
[0m13:17:16.192697 [info ] [MainThread]:   oauth_client_id: None
[0m13:17:16.194960 [info ] [MainThread]:   query_tag: None
[0m13:17:16.196714 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:17:16.198580 [info ] [MainThread]:   host: None
[0m13:17:16.199854 [info ] [MainThread]:   port: None
[0m13:17:16.200956 [info ] [MainThread]:   proxy_host: None
[0m13:17:16.202697 [info ] [MainThread]:   proxy_port: None
[0m13:17:16.203953 [info ] [MainThread]:   protocol: None
[0m13:17:16.204950 [info ] [MainThread]:   connect_retries: 1
[0m13:17:16.208488 [info ] [MainThread]:   connect_timeout: None
[0m13:17:16.210903 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:17:16.211939 [info ] [MainThread]:   retry_all: False
[0m13:17:16.213659 [info ] [MainThread]:   insecure_mode: False
[0m13:17:16.215350 [info ] [MainThread]:   reuse_connections: None
[0m13:17:16.218060 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:17:17.458943 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:17:17.475703 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:17:17.475703 [debug] [MainThread]: On debug: select 1 as id
[0m13:17:17.475703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:19.775158 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.297 seconds
[0m13:17:19.775158 [debug] [MainThread]: On debug: Close
[0m13:17:20.108401 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:17:20.112171 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:17:20.116736 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m13:17:20.121263 [debug] [MainThread]: Command `dbt debug` failed at 13:17:20.121263 after 5.37 seconds
[0m13:17:20.121263 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:17:20.121263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46F1BB990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4757AC910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A477AEE690>]}
[0m13:17:20.121263 [debug] [MainThread]: Flushing usage events
[0m13:17:21.846555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:58.589940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026585054310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658509E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658509EF90>]}


============================== 15:22:58.605730 | efbe9765-539c-43f3-9b97-9241fa95cb97 ==============================
[0m15:22:58.605730 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:22:58.620685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:58.860913 [info ] [MainThread]: dbt version: 1.9.1
[0m15:22:58.870183 [info ] [MainThread]: python version: 3.11.3
[0m15:22:58.873401 [info ] [MainThread]: python path: C:\Users\Bharath\Desktop\Trainings\dbt-env\Scripts\python.exe
[0m15:22:58.877141 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:23:03.243963 [info ] [MainThread]: Using profiles dir at C:\Users\Bharath\.dbt
[0m15:23:03.257524 [info ] [MainThread]: Using profiles.yml file at C:\Users\Bharath\.dbt\profiles.yml
[0m15:23:03.259519 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Bharath\Desktop\Trainings\capston\dbt_project.yml
[0m15:23:03.262784 [info ] [MainThread]: adapter type: snowflake
[0m15:23:03.263856 [info ] [MainThread]: adapter version: 1.9.0
[0m15:23:03.415598 [info ] [MainThread]: Configuration:
[0m15:23:03.425578 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:23:03.427573 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:23:03.431224 [info ] [MainThread]: Required dependencies:
[0m15:23:03.434196 [debug] [MainThread]: Executing "git --help"
[0m15:23:03.482184 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:23:03.492241 [info ] [MainThread]: Connection:
[0m15:23:03.494989 [info ] [MainThread]:   account: cjepwka-vg49205
[0m15:23:03.499922 [info ] [MainThread]:   user: DBHARATH
[0m15:23:03.503715 [info ] [MainThread]:   database: BHARATH_SRC
[0m15:23:03.506372 [info ] [MainThread]:   warehouse: 'COMPUTE_WH'
[0m15:23:03.509041 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m15:23:03.511734 [info ] [MainThread]:   schema: DEV_SOUTCE_DB
[0m15:23:03.516346 [info ] [MainThread]:   authenticator: None
[0m15:23:03.518478 [info ] [MainThread]:   oauth_client_id: None
[0m15:23:03.521354 [info ] [MainThread]:   query_tag: None
[0m15:23:03.524048 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:23:03.526780 [info ] [MainThread]:   host: None
[0m15:23:03.531203 [info ] [MainThread]:   port: None
[0m15:23:03.534795 [info ] [MainThread]:   proxy_host: None
[0m15:23:03.537595 [info ] [MainThread]:   proxy_port: None
[0m15:23:03.540182 [info ] [MainThread]:   protocol: None
[0m15:23:03.542825 [info ] [MainThread]:   connect_retries: 1
[0m15:23:03.547560 [info ] [MainThread]:   connect_timeout: None
[0m15:23:03.550708 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:23:03.553469 [info ] [MainThread]:   retry_all: False
[0m15:23:03.556179 [info ] [MainThread]:   insecure_mode: False
[0m15:23:03.558916 [info ] [MainThread]:   reuse_connections: True
[0m15:23:03.567729 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:23:04.977899 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:23:05.327174 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:23:05.327174 [debug] [MainThread]: On debug: select 1 as id
[0m15:23:05.327174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:08.957485 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.626 seconds
[0m15:23:08.957485 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:23:08.965789 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:23:08.968183 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:23:08.974588 [debug] [MainThread]: Command `dbt debug` failed at 15:23:08.971080 after 10.74 seconds
[0m15:23:08.975585 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:23:08.975585 [debug] [MainThread]: On debug: Close
[0m15:23:09.343214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026585056090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265FED9CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026584E7EAD0>]}
[0m15:23:09.343214 [debug] [MainThread]: Flushing usage events
[0m15:23:11.499970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:15.255552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839F5F2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839F638CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839F63B350>]}


============================== 15:32:15.273144 | c90af3f5-25ff-40c4-b3aa-42e085d6929d ==============================
[0m15:32:15.273144 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:32:15.279301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:32:15.321722 [info ] [MainThread]: dbt version: 1.9.1
[0m15:32:15.332202 [info ] [MainThread]: python version: 3.11.3
[0m15:32:15.336128 [info ] [MainThread]: python path: C:\Users\Bharath\Desktop\Trainings\dbt-env\Scripts\python.exe
[0m15:32:15.339841 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:32:16.601953 [info ] [MainThread]: Using profiles dir at C:\Users\Bharath\.dbt
[0m15:32:16.616874 [info ] [MainThread]: Using profiles.yml file at C:\Users\Bharath\.dbt\profiles.yml
[0m15:32:16.620139 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Bharath\Desktop\Trainings\capston\dbt_project.yml
[0m15:32:16.625377 [info ] [MainThread]: adapter type: snowflake
[0m15:32:16.628052 [info ] [MainThread]: adapter version: 1.9.0
[0m15:32:16.862345 [info ] [MainThread]: Configuration:
[0m15:32:16.872846 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:32:16.873673 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:32:16.876044 [info ] [MainThread]: Required dependencies:
[0m15:32:16.876812 [debug] [MainThread]: Executing "git --help"
[0m15:32:16.902764 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:32:16.905182 [info ] [MainThread]: Connection:
[0m15:32:16.906181 [info ] [MainThread]:   account: cjepwka-vg49205
[0m15:32:16.907788 [info ] [MainThread]:   user: DBHARATH
[0m15:32:16.909402 [info ] [MainThread]:   database: BHARATH_SRC
[0m15:32:16.911868 [info ] [MainThread]:   warehouse: 'COMPUTE_WH'
[0m15:32:16.913864 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m15:32:16.914563 [info ] [MainThread]:   schema: DEV_SOUTCE_DB
[0m15:32:16.915976 [info ] [MainThread]:   authenticator: None
[0m15:32:16.917977 [info ] [MainThread]:   oauth_client_id: None
[0m15:32:16.922179 [info ] [MainThread]:   query_tag: None
[0m15:32:16.925274 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:32:16.927729 [info ] [MainThread]:   host: None
[0m15:32:16.929654 [info ] [MainThread]:   port: None
[0m15:32:16.931799 [info ] [MainThread]:   proxy_host: None
[0m15:32:16.933885 [info ] [MainThread]:   proxy_port: None
[0m15:32:16.936671 [info ] [MainThread]:   protocol: None
[0m15:32:16.938822 [info ] [MainThread]:   connect_retries: 1
[0m15:32:16.941073 [info ] [MainThread]:   connect_timeout: None
[0m15:32:16.943096 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:32:16.945570 [info ] [MainThread]:   retry_all: False
[0m15:32:16.951792 [info ] [MainThread]:   insecure_mode: False
[0m15:32:16.953907 [info ] [MainThread]:   reuse_connections: True
[0m15:32:16.959642 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:32:18.565445 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:32:18.936097 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:32:18.936097 [debug] [MainThread]: On debug: select 1 as id
[0m15:32:18.943425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:21.697435 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.755 seconds
[0m15:32:21.703139 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:32:21.710358 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:32:21.714977 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:32:21.727525 [debug] [MainThread]: Command `dbt debug` failed at 15:32:21.726159 after 6.76 seconds
[0m15:32:21.728029 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:32:21.740685 [debug] [MainThread]: On debug: Close
[0m15:32:22.319564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839920A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A195A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A18322D0>]}
[0m15:32:22.331968 [debug] [MainThread]: Flushing usage events
[0m15:32:24.047635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:45.759713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75B333790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75B376A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75B3305D0>]}


============================== 15:42:45.760711 | 49df1654-4eff-4b9e-8bfa-9b1fa956ce99 ==============================
[0m15:42:45.760711 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:42:45.777765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:47.119199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49df1654-4eff-4b9e-8bfa-9b1fa956ce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75C0B1ED0>]}
[0m15:42:47.285231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49df1654-4eff-4b9e-8bfa-9b1fa956ce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75A719250>]}
[0m15:42:47.295852 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:42:48.564904 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:42:48.567422 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:42:48.571523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49df1654-4eff-4b9e-8bfa-9b1fa956ce99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75D126FD0>]}
[0m15:42:51.555645 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capston.dim_medical_events' (models\example\dim_medical_events.sql) depends on a node named 'MEDICAL_EVENTS' which was not found
[0m15:42:51.562597 [debug] [MainThread]: Command `dbt run` failed at 15:42:51.562597 after 6.11 seconds
[0m15:42:51.564844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D75B38B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D754E7A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D754EBEE90>]}
[0m15:42:51.566785 [debug] [MainThread]: Flushing usage events
[0m15:42:54.109005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:18.341942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AD02590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AD03F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AD02610>]}


============================== 15:43:18.342940 | af88548b-5a3c-4eb2-8165-753057a818e9 ==============================
[0m15:43:18.342940 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:43:18.359241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_medical_events', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:19.469553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af88548b-5a3c-4eb2-8165-753057a818e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7CB27910>]}
[0m15:43:19.585974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af88548b-5a3c-4eb2-8165-753057a818e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7BA09A50>]}
[0m15:43:19.597713 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:43:20.899407 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:43:20.906600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:43:20.910142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af88548b-5a3c-4eb2-8165-753057a818e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AD4B410>]}
[0m15:43:23.242339 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_medical_events (models\example\dim_medical_events.sql)
  source() takes exactly two arguments (1 given)
[0m15:43:23.253205 [debug] [MainThread]: Command `dbt run` failed at 15:43:23.253205 after 5.15 seconds
[0m15:43:23.254670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AD59490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7485A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF7AB2ABD0>]}
[0m15:43:23.255671 [debug] [MainThread]: Flushing usage events
[0m15:43:25.447618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:43.331984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2E17590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2E49310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2E4B8D0>]}


============================== 15:51:43.347601 | 4cc2797f-9ea7-4a7d-96a3-1b4cf15ae9d6 ==============================
[0m15:51:43.347601 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:51:43.347601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:43.988692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cc2797f-9ea7-4a7d-96a3-1b4cf15ae9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2C3EB10>]}
[0m15:51:44.066812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cc2797f-9ea7-4a7d-96a3-1b4cf15ae9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA3B197D0>]}
[0m15:51:44.066812 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:51:44.851129 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:51:44.851129 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:51:44.851129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cc2797f-9ea7-4a7d-96a3-1b4cf15ae9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2E6AE50>]}
[0m15:51:46.135416 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_medical_events (models\example\dim_medical_events.sql)
  source() takes exactly two arguments (1 given)
[0m15:51:46.151031 [debug] [MainThread]: Command `dbt run` failed at 15:51:46.151031 after 2.94 seconds
[0m15:51:46.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2E69A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC9C87A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA2AEB250>]}
[0m15:51:46.151031 [debug] [MainThread]: Flushing usage events
[0m15:51:48.156286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:26.382792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B619B3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B619B8B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B619BA690>]}


============================== 15:52:26.398444 | daff14eb-d8ca-4542-97cb-6a8ee321d52b ==============================
[0m15:52:26.398444 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:52:26.398444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_medical_events', 'send_anonymous_usage_stats': 'True'}
[0m15:52:27.057801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daff14eb-d8ca-4542-97cb-6a8ee321d52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B626FF550>]}
[0m15:52:27.120249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daff14eb-d8ca-4542-97cb-6a8ee321d52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B637103D0>]}
[0m15:52:27.120249 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:52:27.886272 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:52:27.886272 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:52:27.886272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'daff14eb-d8ca-4542-97cb-6a8ee321d52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B6394D010>]}
[0m15:52:29.515793 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var("source_database") }}: Required var 'source_database' not found in config:
  Vars supplied to <Configuration> = {}
[0m15:52:29.515793 [debug] [MainThread]: Command `dbt run` failed at 15:52:29.515793 after 3.25 seconds
[0m15:52:29.515793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B5B4CA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B61960290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B61962E90>]}
[0m15:52:29.515793 [debug] [MainThread]: Flushing usage events
[0m15:52:30.895843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:38.775536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023520011D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023520069B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023520069690>]}


============================== 15:59:38.791152 | 3a78e8fc-9f68-4c8b-8aab-b1d41cba438e ==============================
[0m15:59:38.791152 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:59:38.791152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:39.449566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a78e8fc-9f68-4c8b-8aab-b1d41cba438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002352008A290>]}
[0m15:59:39.512052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a78e8fc-9f68-4c8b-8aab-b1d41cba438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351F3F9250>]}
[0m15:59:39.512052 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:59:40.263514 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m15:59:40.279096 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:59:40.279096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a78e8fc-9f68-4c8b-8aab-b1d41cba438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023520E4A690>]}
[0m15:59:41.955535 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capston.dim_medical_events' (models\example\dim_medical_events.sql) depends on a source named 'source_trans.MEDICAL_EVENTS' which was not found
[0m15:59:41.955535 [debug] [MainThread]: Command `dbt run` failed at 15:59:41.955535 after 3.33 seconds
[0m15:59:41.955535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002352005FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023519B5A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351FE3A550>]}
[0m15:59:41.955535 [debug] [MainThread]: Flushing usage events
[0m15:59:43.978199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:24.681786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D780BF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D77F27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D77F3E50>]}


============================== 16:01:24.681786 | 61746087-4b17-4798-a02a-f3174d414725 ==============================
[0m16:01:24.681786 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:01:24.681786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:25.326616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61746087-4b17-4798-a02a-f3174d414725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D8585BD0>]}
[0m16:01:25.403655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61746087-4b17-4798-a02a-f3174d414725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D6BA92D0>]}
[0m16:01:25.403655 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:01:26.154070 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:01:26.154070 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:01:26.169691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61746087-4b17-4798-a02a-f3174d414725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D9625C50>]}
[0m16:01:27.846074 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capston.dim_medical_events' (models\example\dim_medical_events.sql) depends on a source named 'source_trans.MEDICAL_EVENTS' which was not found
[0m16:01:27.846074 [debug] [MainThread]: Command `dbt run` failed at 16:01:27.846074 after 3.30 seconds
[0m16:01:27.846074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D77F31D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D13DA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5D7800490>]}
[0m16:01:27.846074 [debug] [MainThread]: Flushing usage events
[0m16:01:29.585739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:58.854742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F281505D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F28152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F28153010>]}


============================== 16:01:58.854742 | 245321fb-b923-4c1d-8c1f-af422b212b8e ==============================
[0m16:01:58.854742 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:01:58.870366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m16:01:59.496957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '245321fb-b923-4c1d-8c1f-af422b212b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F27526A90>]}
[0m16:01:59.575069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '245321fb-b923-4c1d-8c1f-af422b212b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F28E4C950>]}
[0m16:01:59.575069 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:02:00.357816 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:02:00.357816 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:02:00.357816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '245321fb-b923-4c1d-8c1f-af422b212b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F2A13AE50>]}
[0m16:02:02.050466 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.capston.dim_medical_events' (models\example\dim_medical_events.sql) depends on a source named 'source_trans.MEDICAL_EVENTS' which was not found
[0m16:02:02.050466 [debug] [MainThread]: Command `dbt run` failed at 16:02:02.050466 after 3.32 seconds
[0m16:02:02.050466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F21D0A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F27F7A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F27F7A550>]}
[0m16:02:02.050466 [debug] [MainThread]: Flushing usage events
[0m16:02:03.538152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:36.565335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075A61D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075AB8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075AB8E90>]}


============================== 16:02:36.580988 | 72b3204b-a916-40ec-b99a-f6b3682fa374 ==============================
[0m16:02:36.580988 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:02:36.580988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:37.206415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075A63010>]}
[0m16:02:37.284519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D074E49390>]}
[0m16:02:37.284519 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:02:38.070791 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:02:38.070791 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:02:38.070791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D076803210>]}
[0m16:02:39.839055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D077C23E90>]}
[0m16:02:39.964025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:02:39.964025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:02:40.136607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D077E493D0>]}
[0m16:02:40.136607 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:02:40.136607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075A73490>]}
[0m16:02:40.136607 [info ] [MainThread]: 
[0m16:02:40.136607 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:02:40.153080 [info ] [MainThread]: 
[0m16:02:40.155257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:40.158732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:02:40.339948 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:02:40.339948 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:02:40.339948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:42.627036 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.276 seconds
[0m16:02:42.627036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_PUBLIC'
[0m16:02:42.643352 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_PUBLIC"
[0m16:02:42.643352 [debug] [ThreadPool]: On list_BHARATHDEV_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_PUBLIC"} */
show objects in BHARATHDEV.PUBLIC limit 10000;
[0m16:02:42.643352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:44.021424 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.375 seconds
[0m16:02:44.021424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D077AF8550>]}
[0m16:02:44.146355 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:02:44.146355 [info ] [Thread-1 (]: 1 of 1 START sql incremental model PUBLIC.dim_medical_events ................... [RUN]
[0m16:02:44.146355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:02:44.146355 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:02:44.161813 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:02:44.161813 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:02:44.240306 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:02:44.255933 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:02:44.255933 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace transient table BHARATHDEV.PUBLIC.dim_medical_events
         as
        (

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
INSERT_DATE,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY 
FROM source
        );
[0m16:02:44.255933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:46.105546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a38-3201-5e06-000b-0bfe0026aa0e
[0m16:02:46.105546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m16:02:46.121301 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\example\dim_medical_events.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target\run\capston\models\example\dim_medical_events.sql
[0m16:02:46.121301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b3204b-a916-40ec-b99a-f6b3682fa374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0784B8150>]}
[0m16:02:46.121301 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model PUBLIC.dim_medical_events .......... [[31mERROR[0m in 1.97s]
[0m16:02:46.121301 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:02:46.121301 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\example\dim_medical_events.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target\run\capston\models\example\dim_medical_events.sql.
[0m16:02:46.136747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:46.136747 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:02:46.136747 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:02:46.496649 [debug] [MainThread]: Connection 'list_BHARATHDEV_PUBLIC' was left open.
[0m16:02:46.496649 [debug] [MainThread]: On list_BHARATHDEV_PUBLIC: Close
[0m16:02:46.762417 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:02:46.762417 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:02:47.060611 [info ] [MainThread]: 
[0m16:02:47.076037 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m16:02:47.076037 [debug] [MainThread]: Command end result
[0m16:02:47.105925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:02:47.121625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:02:47.129525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:02:47.139037 [info ] [MainThread]: 
[0m16:02:47.139037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:02:47.139037 [info ] [MainThread]: 
[0m16:02:47.139037 [error] [MainThread]:   Database Error in model dim_medical_events (models\example\dim_medical_events.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target\run\capston\models\example\dim_medical_events.sql
[0m16:02:47.139037 [info ] [MainThread]: 
[0m16:02:47.139037 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:47.139037 [debug] [MainThread]: Command `dbt run` failed at 16:02:47.139037 after 10.69 seconds
[0m16:02:47.139037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06F53A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D074AC8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D075A53ED0>]}
[0m16:02:47.139037 [debug] [MainThread]: Flushing usage events
[0m16:02:48.737247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:14.783274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFECF3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFED02150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFED02590>]}


============================== 16:13:14.783274 | 0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c ==============================
[0m16:13:14.783274 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:13:14.783274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:13:15.442630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFED5B3D0>]}
[0m16:13:15.520739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFA2CB50>]}
[0m16:13:15.520739 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:13:16.286788 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:13:16.411761 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:13:16.411761 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:13:16.411761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFE832D90>]}
[0m16:13:18.153397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:13:18.180273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F80FD0150>]}
[0m16:13:18.288142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:13:18.288142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:13:18.334967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F81263E90>]}
[0m16:13:18.334967 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:13:18.334967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F811C43D0>]}
[0m16:13:18.334967 [info ] [MainThread]: 
[0m16:13:18.334967 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:13:18.347803 [info ] [MainThread]: 
[0m16:13:18.349798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:18.353800 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:13:18.567007 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:13:18.567007 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:13:18.567007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:20.728619 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.160 seconds
[0m16:13:20.736673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_TGT_DM'
[0m16:13:20.737030 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_TGT_DM"
[0m16:13:20.737030 [debug] [ThreadPool]: On list_BHARATHDEV_TGT_DM: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_TGT_DM"} */
show objects in BHARATHDEV.TGT_DM limit 10000;
[0m16:13:20.737030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:22.145671 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.404 seconds
[0m16:13:22.145671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F815FF950>]}
[0m16:13:22.161092 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:13:22.161092 [info ] [Thread-1 (]: 1 of 1 START sql incremental model TGT_DM.dim_medical_events ................... [RUN]
[0m16:13:22.161092 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:13:22.161092 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:13:22.181089 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:13:22.187035 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:13:22.253679 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:13:22.253679 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.TGT_DM.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where insert_date >= (select coalesce(max(base_insert_date),'1900-01-01') from BHARATHDEV.TGT_DM.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
INSERT_DATE,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY 
FROM source
  );
[0m16:13:22.253679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:13:23.932910 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a43-3201-5e05-000b-0bfe0026b182
[0m16:13:23.932910 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 44
invalid identifier 'BASE_INSERT_DATE'
[0m16:13:23.948366 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:13:23.948366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba2da4f-5bc2-4a5e-a53e-83e79a40cc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F812C46D0>]}
[0m16:13:23.948366 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model TGT_DM.dim_medical_events .......... [[31mERROR[0m in 1.79s]
[0m16:13:23.948366 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:13:23.948366 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'.
[0m16:13:23.948366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:23.948366 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:13:23.948366 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:13:24.433352 [debug] [MainThread]: Connection 'list_BHARATHDEV_TGT_DM' was left open.
[0m16:13:24.448973 [debug] [MainThread]: On list_BHARATHDEV_TGT_DM: Close
[0m16:13:24.745980 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:13:24.745980 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:13:25.029828 [info ] [MainThread]: 
[0m16:13:25.029828 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m16:13:25.029828 [debug] [MainThread]: Command end result
[0m16:13:25.083183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:13:25.083183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:13:25.099658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:13:25.099658 [info ] [MainThread]: 
[0m16:13:25.099658 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:13:25.099658 [info ] [MainThread]: 
[0m16:13:25.099658 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:13:25.099658 [info ] [MainThread]: 
[0m16:13:25.099658 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:13:25.099658 [debug] [MainThread]: Command `dbt run` failed at 16:13:25.099658 after 10.45 seconds
[0m16:13:25.099658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFED03CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FF87EA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFEB2A990>]}
[0m16:13:25.099658 [debug] [MainThread]: Flushing usage events
[0m16:13:26.908312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:23.140306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EE4B2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204ED9CB250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EE4B3190>]}


============================== 16:14:23.155894 | 03f0eced-8bab-43f1-8063-69a5ee8ae42e ==============================
[0m16:14:23.155894 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:14:23.155894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:23.782431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F02CCAD0>]}
[0m16:14:23.844917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EF1AE390>]}
[0m16:14:23.844917 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:14:24.613677 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:14:24.879209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:14:24.894863 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:14:25.240082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:14:25.260891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F079AD90>]}
[0m16:14:25.367463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:14:25.367463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:14:25.461222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EB50FCD0>]}
[0m16:14:25.461222 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:14:25.461222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F07ED7D0>]}
[0m16:14:25.461222 [info ] [MainThread]: 
[0m16:14:25.461222 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:14:25.474023 [info ] [MainThread]: 
[0m16:14:25.476018 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:25.476796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:14:25.663560 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:14:25.679176 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:14:25.679176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:27.386058 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.711 seconds
[0m16:14:27.386058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_TGT_DM'
[0m16:14:27.401474 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_TGT_DM"
[0m16:14:27.401474 [debug] [ThreadPool]: On list_BHARATHDEV_TGT_DM: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_TGT_DM"} */
show objects in BHARATHDEV.TGT_DM limit 10000;
[0m16:14:27.401474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:28.890608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.478 seconds
[0m16:14:28.890608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EE0F4F10>]}
[0m16:14:28.890608 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:14:28.890608 [info ] [Thread-1 (]: 1 of 1 START sql incremental model TGT_DM.dim_medical_events ................... [RUN]
[0m16:14:28.890608 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:14:28.890608 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:14:28.906062 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:14:28.906062 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:14:28.983488 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:14:28.983488 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.TGT_DM.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where insert_date >= (select coalesce(max(base_insert_date),'1900-01-01') from BHARATHDEV.TGT_DM.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
INSERT_DATE AS BASE_INSERT_DATE,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY 
FROM source
  );
[0m16:14:28.983488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:30.534667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a44-3201-5e05-000b-0bfe0026b196
[0m16:14:30.534667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 44
invalid identifier 'BASE_INSERT_DATE'
[0m16:14:30.534667 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:14:30.550286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03f0eced-8bab-43f1-8063-69a5ee8ae42e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F06F6310>]}
[0m16:14:30.550286 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model TGT_DM.dim_medical_events .......... [[31mERROR[0m in 1.64s]
[0m16:14:30.550286 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:14:30.550286 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'.
[0m16:14:30.550286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:30.550286 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:14:30.550286 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:14:30.865532 [debug] [MainThread]: Connection 'list_BHARATHDEV_TGT_DM' was left open.
[0m16:14:30.866498 [debug] [MainThread]: On list_BHARATHDEV_TGT_DM: Close
[0m16:14:31.130193 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:14:31.130193 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:14:31.428413 [info ] [MainThread]: 
[0m16:14:31.428413 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m16:14:31.428413 [debug] [MainThread]: Command end result
[0m16:14:31.463078 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:14:31.463078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:14:31.479745 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:14:31.479745 [info ] [MainThread]: 
[0m16:14:31.479745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:14:31.479745 [info ] [MainThread]: 
[0m16:14:31.479745 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:14:31.496697 [info ] [MainThread]: 
[0m16:14:31.496697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:14:31.496697 [debug] [MainThread]: Command `dbt run` failed at 16:14:31.496697 after 8.47 seconds
[0m16:14:31.496697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EE4E7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E805A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EE2DA990>]}
[0m16:14:31.496697 [debug] [MainThread]: Flushing usage events
[0m16:14:33.543035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:51.151369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C725B3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C71ACB090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C722B6C50>]}


============================== 16:16:51.151369 | b9d2729e-d836-48eb-8c79-282ea606e610 ==============================
[0m16:16:51.151369 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:16:51.151369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:51.798839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C743ABD50>]}
[0m16:16:51.882527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C71999190>]}
[0m16:16:51.882527 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:16:52.697625 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:16:52.830931 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:16:52.830931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C720E6C10>]}
[0m16:16:54.660019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:16:54.680424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C74961910>]}
[0m16:16:54.799044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:16:54.817781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:16:54.844938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C74AF15D0>]}
[0m16:16:54.844938 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:16:54.844938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C74A66CD0>]}
[0m16:16:54.860593 [info ] [MainThread]: 
[0m16:16:54.860593 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:16:54.865352 [info ] [MainThread]: 
[0m16:16:54.867380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:54.871004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:16:55.055793 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:16:55.055793 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:16:55.055793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:56.939398 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.887 seconds
[0m16:16:56.954929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:16:56.970553 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:16:56.970553 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:16:56.970553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:58.530255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.557 seconds
[0m16:16:58.530255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7498B450>]}
[0m16:16:58.530255 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:16:58.530255 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:16:58.530255 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:16:58.530255 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:16:58.545891 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:16:58.563050 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:16:58.642227 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:16:58.642227 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where insert_date >= (select coalesce(max(base_insert_date),'1900-01-01') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
INSERT_DATE AS BASE_INSERT_DATE,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY 
FROM source
  );
[0m16:16:58.642227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:17:00.222647 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a46-3201-5e29-000b-0bfe00269a52
[0m16:17:00.222647 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 44
invalid identifier 'BASE_INSERT_DATE'
[0m16:17:00.222647 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:17:00.222647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9d2729e-d836-48eb-8c79-282ea606e610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C74D9F590>]}
[0m16:17:00.222647 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 1.69s]
[0m16:17:00.238302 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:17:00.238302 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'.
[0m16:17:00.238302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:00.238302 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:17:00.238302 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:17:00.543857 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:17:00.543857 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:17:00.855924 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:17:00.855924 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:17:01.271534 [info ] [MainThread]: 
[0m16:17:01.271534 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m16:17:01.274017 [debug] [MainThread]: Command end result
[0m16:17:01.313395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:17:01.324075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:17:01.339096 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:17:01.340235 [info ] [MainThread]: 
[0m16:17:01.340235 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:17:01.340235 [info ] [MainThread]: 
[0m16:17:01.340235 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:17:01.340235 [info ] [MainThread]: 
[0m16:17:01.340235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:17:01.340235 [debug] [MainThread]: Command `dbt run` failed at 16:17:01.340235 after 10.32 seconds
[0m16:17:01.340235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C723DA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C6C18A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C725E7310>]}
[0m16:17:01.340235 [debug] [MainThread]: Flushing usage events
[0m16:17:02.869312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:38.538751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E63D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05337B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E63690>]}


============================== 16:20:38.538751 | 30d0a7b8-c2f8-44f7-b4d0-b136f85bd102 ==============================
[0m16:20:38.538751 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:20:38.538751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:39.179850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E615D0>]}
[0m16:20:39.257955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F054B5E310>]}
[0m16:20:39.257955 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:20:39.993765 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:20:40.276653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:40.276653 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:20:40.590717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:20:40.616186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0560994D0>]}
[0m16:20:40.738072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:20:40.753653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:20:40.831795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0560F8A50>]}
[0m16:20:40.831795 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:20:40.831795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E53A90>]}
[0m16:20:40.831795 [info ] [MainThread]: 
[0m16:20:40.847417 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:20:40.853301 [info ] [MainThread]: 
[0m16:20:40.856423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:40.860823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:20:41.052346 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:20:41.052346 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:20:41.052346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:43.228201 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.168 seconds
[0m16:20:43.236214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:20:43.237877 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:20:43.237877 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:20:43.237877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:44.709768 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.460 seconds
[0m16:20:44.709768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0561F5050>]}
[0m16:20:44.709768 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:20:44.709768 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:20:44.709768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:20:44.709768 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:20:44.738739 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:20:44.738739 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:20:44.831565 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:20:44.832561 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where insert_date >= (select coalesce(max(base_insert_date),'1900-01-01') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:20:44.834557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:46.410490 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a4a-3201-5e05-000b-0bfe0026b252
[0m16:20:46.411453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 44
invalid identifier 'BASE_INSERT_DATE'
[0m16:20:46.416473 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:20:46.417875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d0a7b8-c2f8-44f7-b4d0-b136f85bd102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F055EC00D0>]}
[0m16:20:46.417875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 1.71s]
[0m16:20:46.417875 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:20:46.417875 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'.
[0m16:20:46.417875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:46.417875 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:20:46.417875 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:20:46.721510 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:20:46.721510 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:20:46.999119 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:20:46.999119 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:20:47.280244 [info ] [MainThread]: 
[0m16:20:47.280244 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m16:20:47.280244 [debug] [MainThread]: Command end result
[0m16:20:47.317324 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:20:47.339246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:20:47.352305 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:20:47.352305 [info ] [MainThread]: 
[0m16:20:47.352305 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:20:47.352305 [info ] [MainThread]: 
[0m16:20:47.352305 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 11 at position 44
  invalid identifier 'BASE_INSERT_DATE'
[0m16:20:47.352305 [info ] [MainThread]: 
[0m16:20:47.352305 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:20:47.366830 [debug] [MainThread]: Command `dbt run` failed at 16:20:47.366830 after 8.95 seconds
[0m16:20:47.368824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F04DA0A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E53E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F053E53DD0>]}
[0m16:20:47.370851 [debug] [MainThread]: Flushing usage events
[0m16:20:48.892014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:31.650453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE37883850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE378C0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE369DB050>]}


============================== 16:21:31.650453 | 11d62e55-f7ce-4427-895a-29a73eecddf9 ==============================
[0m16:21:31.650453 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:21:31.650453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m16:21:32.308169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE34E04A90>]}
[0m16:21:32.370653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE36C69110>]}
[0m16:21:32.386273 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:21:33.153286 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:21:33.419686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:33.419686 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:21:33.733735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:21:33.765887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE39BC21D0>]}
[0m16:21:33.898623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:21:33.914248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:21:33.992356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE39B37310>]}
[0m16:21:33.992356 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:21:33.992356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE39B80950>]}
[0m16:21:34.008005 [info ] [MainThread]: 
[0m16:21:34.008005 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:21:34.011800 [info ] [MainThread]: 
[0m16:21:34.012798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:34.016823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:21:34.197430 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:21:34.197430 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:21:34.197430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:35.942297 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.747 seconds
[0m16:21:35.957714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:21:35.973335 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:21:35.973335 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:21:35.973335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:37.446843 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.471 seconds
[0m16:21:37.446843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE39C189D0>]}
[0m16:21:37.446843 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:21:37.446843 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:21:37.462262 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:21:37.462262 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:21:37.462262 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:21:37.479005 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:21:37.548884 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:37.548884 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where insert_date >= (select coalesce(max(base_add_date),'1900-01-01') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:21:37.548884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:39.169137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.620 seconds
[0m16:21:39.184565 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:39.184565 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:21:39.356597 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.168 seconds
[0m16:21:39.356597 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:39.356597 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:21:39.530974 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.164 seconds
[0m16:21:39.539949 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:39.540947 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:21:39.702924 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.165 seconds
[0m16:21:39.733938 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:21:39.733938 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:39.733938 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:21:39.937208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m16:21:39.937208 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:21:39.937208 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:21:40.125352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a4b-3201-5e06-000b-0bfe0026ac1a
[0m16:21:40.125352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:21:40.125352 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:21:40.140770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d62e55-f7ce-4427-895a-29a73eecddf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE36D0D450>]}
[0m16:21:40.140770 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.68s]
[0m16:21:40.140770 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:21:40.140770 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:21:40.140770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:40.140770 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:21:40.140770 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:21:40.526100 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:21:40.526100 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:21:40.828885 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:21:40.828885 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:21:41.094432 [info ] [MainThread]: 
[0m16:21:41.094432 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m16:21:41.110327 [debug] [MainThread]: Command end result
[0m16:21:41.141574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:21:41.160883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:21:41.160883 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:21:41.160883 [info ] [MainThread]: 
[0m16:21:41.160883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:21:41.160883 [info ] [MainThread]: 
[0m16:21:41.176839 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:21:41.177487 [info ] [MainThread]: 
[0m16:21:41.177487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:21:41.177487 [debug] [MainThread]: Command `dbt run` failed at 16:21:41.177487 after 9.65 seconds
[0m16:21:41.177487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE314BA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE376AA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE37873D10>]}
[0m16:21:41.177487 [debug] [MainThread]: Flushing usage events
[0m16:21:42.975618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:25.474538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028681243790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028681242150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028681242C90>]}


============================== 16:23:25.481852 | 048cd612-eb7d-4f3b-83cb-c1acee84b9c5 ==============================
[0m16:23:25.481852 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:23:25.483811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:23:26.187712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002868129B410>]}
[0m16:23:26.267565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028681F2E190>]}
[0m16:23:26.270678 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:23:27.127096 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:23:27.427546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:23:27.428544 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:23:27.771212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:23:27.793008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028681F84C90>]}
[0m16:23:27.917425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:23:27.927308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:23:28.016556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FFE34F50>]}
[0m16:23:28.017707 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:23:28.018796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286835E03D0>]}
[0m16:23:28.021927 [info ] [MainThread]: 
[0m16:23:28.022443 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:23:28.024839 [info ] [MainThread]: 
[0m16:23:28.026834 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:28.029830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:23:28.234076 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:23:28.235074 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:23:28.236071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:30.129722 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.893 seconds
[0m16:23:30.138961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:23:30.154392 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:23:30.155635 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:23:30.156634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:31.763028 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.607 seconds
[0m16:23:31.767946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FFE35110>]}
[0m16:23:31.771854 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:23:31.772855 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:23:31.774953 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:23:31.775956 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:23:31.791159 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:23:31.797297 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:23:31.871868 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:31.872866 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS


  -- this filter will only be applied on an incremental run
  where INSERT_DATE >= (select coalesce(max(base_add_date),'1900-01-01') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:23:31.873864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:33.695004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m16:23:33.705330 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:33.706360 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:23:33.868853 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.161 seconds
[0m16:23:33.873979 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:33.874945 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:23:34.043084 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.167 seconds
[0m16:23:34.052300 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:34.053397 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:23:34.227765 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.173 seconds
[0m16:23:34.266525 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:23:34.272509 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:34.273506 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:23:34.453390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m16:23:34.454393 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:23:34.455388 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:23:34.669826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a4d-3201-5e05-000b-0bfe0026b296
[0m16:23:34.670917 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:23:34.677061 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:23:34.680173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '048cd612-eb7d-4f3b-83cb-c1acee84b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028683440A10>]}
[0m16:23:34.681135 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.90s]
[0m16:23:34.683051 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:23:34.684191 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:23:34.687186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:34.688184 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:23:34.689180 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:23:35.005400 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:23:35.006399 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:23:35.303256 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:23:35.304271 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:23:35.609716 [info ] [MainThread]: 
[0m16:23:35.610711 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m16:23:35.612932 [debug] [MainThread]: Command end result
[0m16:23:35.654871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:23:35.662850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:23:35.674935 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:23:35.676931 [info ] [MainThread]: 
[0m16:23:35.677929 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:23:35.680481 [info ] [MainThread]: 
[0m16:23:35.681001 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:23:35.684144 [info ] [MainThread]: 
[0m16:23:35.685995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:23:35.688021 [debug] [MainThread]: Command `dbt run` failed at 16:23:35.688021 after 10.36 seconds
[0m16:23:35.689128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FAC7A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002868106A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002868106A990>]}
[0m16:23:35.692122 [debug] [MainThread]: Flushing usage events
[0m16:23:37.605138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:43.037540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D7F37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D83BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D7F3990>]}


============================== 16:24:43.044523 | 158f2675-4166-4610-b9ed-f887b38d2a18 ==============================
[0m16:24:43.044523 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:24:43.046927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:43.661960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D6EBE10>]}
[0m16:24:43.740058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5CBD9390>]}
[0m16:24:43.740058 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:24:44.475940 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:24:44.743178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:44.743178 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:24:45.071226 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:24:45.094428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5FABF190>]}
[0m16:24:45.197775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:24:45.213392 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:24:45.291501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5FB24B50>]}
[0m16:24:45.291501 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:24:45.291501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5FB97E50>]}
[0m16:24:45.307122 [info ] [MainThread]: 
[0m16:24:45.307122 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:24:45.312123 [info ] [MainThread]: 
[0m16:24:45.314119 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:45.317462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:24:45.496068 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:24:45.496068 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:24:45.496068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:47.185825 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.682 seconds
[0m16:24:47.201254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:24:47.201254 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:24:47.201254 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:24:47.201254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:48.612535 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.410 seconds
[0m16:24:48.627929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5FB35F50>]}
[0m16:24:48.627929 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:24:48.627929 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:24:48.627929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:24:48.627929 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:24:48.651102 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:24:48.651102 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:24:48.714459 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:48.714459 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS

  where INSERT_DATE >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:24:48.714459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:50.492660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m16:24:50.492660 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:50.508078 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:24:50.664289 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.160 seconds
[0m16:24:50.664289 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:50.664289 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:24:50.836127 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.164 seconds
[0m16:24:50.836127 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:50.836127 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:24:50.993805 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.149 seconds
[0m16:24:51.025052 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:24:51.040669 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:51.040669 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:24:51.197085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m16:24:51.197085 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:24:51.197085 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:24:51.384546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a4e-3201-5e29-000b-0bfe00269b36
[0m16:24:51.384546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:24:51.399993 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:24:51.399993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158f2675-4166-4610-b9ed-f887b38d2a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6011F9D0>]}
[0m16:24:51.399993 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.77s]
[0m16:24:51.399993 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:24:51.399993 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:24:51.399993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:51.399993 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:24:51.399993 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:24:51.729808 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:24:51.745220 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:24:52.010984 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:24:52.010984 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:24:52.294030 [info ] [MainThread]: 
[0m16:24:52.294030 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m16:24:52.309486 [debug] [MainThread]: Command end result
[0m16:24:52.348264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:24:52.348956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:24:52.360879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:24:52.360879 [info ] [MainThread]: 
[0m16:24:52.360879 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:24:52.360879 [info ] [MainThread]: 
[0m16:24:52.360879 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:24:52.360879 [info ] [MainThread]: 
[0m16:24:52.360879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:52.378605 [debug] [MainThread]: Command `dbt run` failed at 16:24:52.378605 after 9.47 seconds
[0m16:24:52.380603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D86ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C573AA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C5D61A990>]}
[0m16:24:52.381600 [debug] [MainThread]: Flushing usage events
[0m16:24:54.031887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:29.441117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E481441D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E481499F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E481498E90>]}


============================== 16:25:29.441117 | 2a9af468-2ff3-4749-87df-e4849407bed1 ==============================
[0m16:25:29.441117 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:25:29.441117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:30.084861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E481442410>]}
[0m16:25:30.147349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FF7A91D0>]}
[0m16:25:30.147349 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:25:30.913506 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:25:31.196288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:25:31.196288 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:25:31.524340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:25:31.552138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4837398D0>]}
[0m16:25:31.666613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:25:31.666613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:25:31.760338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4837C4590>]}
[0m16:25:31.760338 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:25:31.760338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4837C5A90>]}
[0m16:25:31.760338 [info ] [MainThread]: 
[0m16:25:31.760338 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:25:31.760338 [info ] [MainThread]: 
[0m16:25:31.773033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:31.776298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:25:31.962738 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:25:31.962738 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:25:31.962738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:33.702582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.730 seconds
[0m16:25:33.702582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:25:33.718034 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:25:33.718034 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:25:33.718034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:35.174982 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.453 seconds
[0m16:25:35.174982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4837C4310>]}
[0m16:25:35.174982 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:25:35.190414 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:25:35.190414 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:25:35.190414 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:25:35.208674 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:25:35.212516 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:25:35.281018 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:35.282056 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS

  where INSERT_DATE >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)


)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:25:35.282056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:25:37.211457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.932 seconds
[0m16:25:37.226882 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:37.226882 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:25:37.383274 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.169 seconds
[0m16:25:37.398716 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:37.398716 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:25:37.572044 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.169 seconds
[0m16:25:37.572044 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:37.572044 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:25:37.743918 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.161 seconds
[0m16:25:37.775016 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:25:37.775016 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:37.775016 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:25:37.962690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m16:25:37.962690 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:25:37.962690 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:25:38.136221 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a4f-3201-5e29-000b-0bfe00269b52
[0m16:25:38.136221 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:25:38.151636 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:25:38.151636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9af468-2ff3-4749-87df-e4849407bed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E483CE0210>]}
[0m16:25:38.151636 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.96s]
[0m16:25:38.151636 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:25:38.151636 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:25:38.151636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:38.168153 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:25:38.169152 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:25:38.462736 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:25:38.462736 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:25:38.732566 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:25:38.732566 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:25:39.045625 [info ] [MainThread]: 
[0m16:25:39.045625 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m16:25:39.045625 [debug] [MainThread]: Command end result
[0m16:25:39.094904 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:25:39.094904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:25:39.113946 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:25:39.114944 [info ] [MainThread]: 
[0m16:25:39.116142 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:25:39.118627 [info ] [MainThread]: 
[0m16:25:39.119653 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:25:39.121924 [info ] [MainThread]: 
[0m16:25:39.123919 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:25:39.126910 [debug] [MainThread]: Command `dbt run` failed at 16:25:39.126910 after 9.80 seconds
[0m16:25:39.127907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4814BA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FAF7A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E481177FD0>]}
[0m16:25:39.130267 [debug] [MainThread]: Flushing usage events
[0m16:25:40.767925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:01.003576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8AC5A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8AC40090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8AC03950>]}


============================== 16:26:01.003576 | 37945d68-0f01-4114-a572-2a182ebda329 ==============================
[0m16:26:01.003576 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:26:01.003576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:26:01.736603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8C9FB150>]}
[0m16:26:01.803358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE89FE9190>]}
[0m16:26:01.819825 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:26:02.635383 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:26:02.935739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:26:02.952025 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:26:03.295855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:26:03.318303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8CF28DD0>]}
[0m16:26:03.458809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:26:03.466790 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:26:03.546601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE87020E90>]}
[0m16:26:03.546601 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:26:03.546601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8CFF7010>]}
[0m16:26:03.562220 [info ] [MainThread]: 
[0m16:26:03.566458 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:26:03.568454 [info ] [MainThread]: 
[0m16:26:03.570481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:26:03.574439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:26:03.796058 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:26:03.796058 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:26:03.796058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:06.193038 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.391 seconds
[0m16:26:06.208627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:26:06.208627 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:26:06.208627 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:26:06.224250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:07.664573 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.455 seconds
[0m16:26:07.685267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE87C5FBD0>]}
[0m16:26:07.689168 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:26:07.690169 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:26:07.692016 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:26:07.693046 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:26:07.696339 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:26:07.711969 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:26:07.781035 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:07.781035 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS

  where INSERT_DATE >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:26:07.781035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:09.434611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.646 seconds
[0m16:26:09.434611 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:09.434611 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:26:09.606282 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.160 seconds
[0m16:26:09.606282 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:09.606282 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:26:09.795542 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.178 seconds
[0m16:26:09.805511 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:09.806508 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:26:09.967153 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.174 seconds
[0m16:26:10.013839 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:26:10.013839 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:10.013839 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:26:10.201479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m16:26:10.201479 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:26:10.216917 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:26:10.390743 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a50-3201-5e29-000b-0bfe00269b66
[0m16:26:10.390743 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:26:10.406179 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:26:10.406179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37945d68-0f01-4114-a572-2a182ebda329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8D329710>]}
[0m16:26:10.406179 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.71s]
[0m16:26:10.406179 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:26:10.406179 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:26:10.406179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:10.406179 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:26:10.406179 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:26:10.735188 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:26:10.735188 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:26:11.126416 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:26:11.126416 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:26:11.426249 [info ] [MainThread]: 
[0m16:26:11.426249 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m16:26:11.426249 [debug] [MainThread]: Command end result
[0m16:26:11.466102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:26:11.480660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:26:11.495432 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:26:11.495432 [info ] [MainThread]: 
[0m16:26:11.495432 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:11.495432 [info ] [MainThread]: 
[0m16:26:11.495432 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:26:11.495432 [info ] [MainThread]: 
[0m16:26:11.495432 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:26:11.495432 [debug] [MainThread]: Command `dbt run` failed at 16:26:11.495432 after 10.65 seconds
[0m16:26:11.510069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE847DA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8AC333D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8AC33450>]}
[0m16:26:11.512057 [debug] [MainThread]: Flushing usage events
[0m16:26:13.131778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:44.794516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829A22A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829A23E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829A23990>]}


============================== 16:28:44.794516 | e102b576-b13d-4060-b749-77a194aca263 ==============================
[0m16:28:44.794516 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:28:44.794516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:28:45.420040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82A7F48D0>]}
[0m16:28:45.498190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828E09190>]}
[0m16:28:45.498190 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:28:46.249630 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:28:46.518945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:28:46.518945 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:28:46.849607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:28:46.862146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82BC8C850>]}
[0m16:28:46.978312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:28:46.978312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:28:47.072042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82BD66A50>]}
[0m16:28:47.072042 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:28:47.072042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829A13ED0>]}
[0m16:28:47.072042 [info ] [MainThread]: 
[0m16:28:47.072042 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:28:47.086334 [info ] [MainThread]: 
[0m16:28:47.088874 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:47.093531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:28:47.288368 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:28:47.288368 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:28:47.288368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:49.150734 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.867 seconds
[0m16:28:49.166154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:28:49.181773 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:28:49.181773 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:28:49.181773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:50.700252 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.520 seconds
[0m16:28:50.700252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82BDC8F10>]}
[0m16:28:50.731337 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:28:50.731337 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:28:50.731337 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:28:50.731337 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:28:50.749104 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:28:50.752051 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:28:50.835121 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:50.835121 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS ME

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date
FROM source
  );
[0m16:28:50.835121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:52.661433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.827 seconds
[0m16:28:52.679758 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:52.680756 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:28:52.830310 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.158 seconds
[0m16:28:52.830310 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:52.845775 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:28:53.033446 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.193 seconds
[0m16:28:53.048853 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:53.048853 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:28:53.190194 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.144 seconds
[0m16:28:53.222774 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:28:53.238399 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:53.238399 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:28:53.410414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m16:28:53.410414 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:28:53.410414 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:28:53.628930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95a52-3201-5e05-000b-0bfe0026b33a
[0m16:28:53.628930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 186
invalid identifier 'INSERT_DATE'
[0m16:28:53.628930 [debug] [Thread-1 (]: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:28:53.628930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e102b576-b13d-4060-b749-77a194aca263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C826C98590>]}
[0m16:28:53.628930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_medical_events .......... [[31mERROR[0m in 2.90s]
[0m16:28:53.628930 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:28:53.628930 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_medical_events' to be skipped because of status 'error'.  Reason: Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql.
[0m16:28:53.644551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:53.644551 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:28:53.644551 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:28:53.927961 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:28:53.927961 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:28:54.208979 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:28:54.208979 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:28:54.475527 [info ] [MainThread]: 
[0m16:28:54.475527 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m16:28:54.475527 [debug] [MainThread]: Command end result
[0m16:28:54.522570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:28:54.522570 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:28:54.540572 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:28:54.541570 [info ] [MainThread]: 
[0m16:28:54.542430 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:28:54.544947 [info ] [MainThread]: 
[0m16:28:54.545460 [error] [MainThread]:   Database Error in model dim_medical_events (models\dim\dim_medical_events.sql)
  000904 (42000): SQL compilation error: error line 15 at position 186
  invalid identifier 'INSERT_DATE'
  compiled code at target\run\capston\models\dim\dim_medical_events.sql
[0m16:28:54.547975 [info ] [MainThread]: 
[0m16:28:54.549968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:28:54.552962 [debug] [MainThread]: Command `dbt run` failed at 16:28:54.552962 after 9.88 seconds
[0m16:28:54.554956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8234CA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82984A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82984A550>]}
[0m16:28:54.557590 [debug] [MainThread]: Flushing usage events
[0m16:28:56.166567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:08.648476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD2A03490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD2A02ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD2A02C90>]}


============================== 16:31:08.668953 | bf11cefb-9964-4015-92f1-26fea7d44fb7 ==============================
[0m16:31:08.668953 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:31:08.670951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:09.290438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD37D4FD0>]}
[0m16:31:09.368550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD3715E90>]}
[0m16:31:09.368550 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:31:10.119996 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:31:10.387195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:10.387195 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:31:10.715205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:31:10.735232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD2A58B90>]}
[0m16:31:10.856404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:31:10.856404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:31:10.934511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCFA5FF50>]}
[0m16:31:10.950129 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:31:10.950129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCEC7CB10>]}
[0m16:31:10.950129 [info ] [MainThread]: 
[0m16:31:10.950129 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:31:10.957097 [info ] [MainThread]: 
[0m16:31:10.959095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:10.961526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:31:11.140323 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:31:11.140323 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:31:11.140323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:13.331604 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.189 seconds
[0m16:31:13.347035 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:31:13.362694 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:31:13.362694 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:31:13.362694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:14.851375 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.491 seconds
[0m16:31:14.851375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4CC9710>]}
[0m16:31:14.851375 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:31:14.851375 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:31:14.866996 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:31:14.866996 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:31:14.866996 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:31:14.886184 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:31:14.957785 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:14.957785 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS ME

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m16:31:14.957785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:16.560311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.602 seconds
[0m16:31:16.560311 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:16.560311 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:31:16.731919 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.167 seconds
[0m16:31:16.747396 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:16.747396 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:31:16.888159 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.146 seconds
[0m16:31:16.903609 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:16.903609 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:31:17.404977 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.496 seconds
[0m16:31:17.436218 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:31:17.436218 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:17.436218 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:31:17.733949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m16:31:17.733949 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:17.733949 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:31:20.208699 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 2.474 seconds
[0m16:31:20.208699 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:20.208699 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m16:31:20.491215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m16:31:20.522459 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:31:20.538079 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:31:20.538079 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m16:31:20.788222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m16:31:20.803646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf11cefb-9964-4015-92f1-26fea7d44fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD3753150>]}
[0m16:31:20.819300 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 100000[0m in 5.94s]
[0m16:31:20.819300 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:31:20.819300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:20.819300 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:31:20.819300 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:31:21.120111 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:31:21.120111 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:31:21.415281 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:31:21.415281 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:31:21.681089 [info ] [MainThread]: 
[0m16:31:21.696466 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m16:31:21.696466 [debug] [MainThread]: Command end result
[0m16:31:21.736175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:31:21.736175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:31:21.750498 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:31:21.750498 [info ] [MainThread]: 
[0m16:31:21.750498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:21.750498 [info ] [MainThread]: 
[0m16:31:21.750498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:31:21.750498 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:21.750498 after 13.23 seconds
[0m16:31:21.750498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD2A78F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCC48A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD282A990>]}
[0m16:31:21.750498 [debug] [MainThread]: Flushing usage events
[0m16:31:23.091733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:07.642579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DDE13890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DDE50090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DDD0BC10>]}


============================== 16:35:07.658199 | ec283512-cb19-41a0-901c-fb97940361a1 ==============================
[0m16:35:07.658199 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:35:07.658199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:08.439821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DEBE2590>]}
[0m16:35:08.517930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DD1F9210>]}
[0m16:35:08.517930 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:35:09.286785 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:35:09.552344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:09.552344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:09.552344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m16:35:09.631206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFF70810>]}
[0m16:35:09.741402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:35:09.741402 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:35:09.788263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFE78750>]}
[0m16:35:09.788263 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:35:09.788263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFFA9A50>]}
[0m16:35:09.788263 [info ] [MainThread]: 
[0m16:35:09.798857 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:35:09.799854 [info ] [MainThread]: 
[0m16:35:09.802827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:09.805422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:35:09.987679 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:35:09.987679 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:35:10.003264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:12.685715 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.691 seconds
[0m16:35:12.701168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:35:12.701168 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:35:12.701168 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:35:12.701168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:14.174542 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.470 seconds
[0m16:35:14.190025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DD29F5D0>]}
[0m16:35:14.190025 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:35:14.190025 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:35:14.190025 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:35:14.190025 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:35:14.222813 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:35:14.222970 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:35:14.272632 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:14.288257 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS ME

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m16:35:14.288257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:16.022068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.741 seconds
[0m16:35:16.037518 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:16.037518 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:35:16.211052 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.170 seconds
[0m16:35:16.211052 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:16.211052 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:35:16.367350 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.149 seconds
[0m16:35:16.367350 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:16.367350 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:35:16.523405 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.151 seconds
[0m16:35:16.554648 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:35:16.570267 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:16.570267 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:35:16.759390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m16:35:16.774812 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:16.774812 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:35:17.949663 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.181 seconds
[0m16:35:17.949663 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:17.949663 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m16:35:18.247217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m16:35:18.247217 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:35:18.262837 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:35:18.262837 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m16:35:18.497360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m16:35:18.528437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec283512-cb19-41a0-901c-fb97940361a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFE12A10>]}
[0m16:35:18.528437 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 100000[0m in 4.34s]
[0m16:35:18.528437 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:35:18.528437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:18.528437 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:35:18.528437 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:35:18.842529 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:35:18.842529 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:35:19.108298 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:35:19.108298 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:35:19.391095 [info ] [MainThread]: 
[0m16:35:19.391095 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m16:35:19.391095 [debug] [MainThread]: Command end result
[0m16:35:19.432855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:35:19.432855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:35:19.449517 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:35:19.449517 [info ] [MainThread]: 
[0m16:35:19.449517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:19.449517 [info ] [MainThread]: 
[0m16:35:19.449517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:19.466378 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:19.466378 after 11.95 seconds
[0m16:35:19.466378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DDE8AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D786A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D78AF050>]}
[0m16:35:19.466378 [debug] [MainThread]: Flushing usage events
[0m16:35:21.254757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:04.364596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C5991D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C54D8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C588B1D0>]}


============================== 16:39:04.380256 | c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5 ==============================
[0m16:39:04.380256 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:39:04.380256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:05.040005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C7748910>]}
[0m16:39:05.118111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C668E1D0>]}
[0m16:39:05.118111 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:39:05.927543 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:39:06.210766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:06.210766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:06.227295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:39:06.293384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C7A00410>]}
[0m16:39:06.408896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:39:06.424519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:39:06.455758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C59EB090>]}
[0m16:39:06.455758 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:39:06.471379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C777A450>]}
[0m16:39:06.471379 [info ] [MainThread]: 
[0m16:39:06.471379 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:39:06.477387 [info ] [MainThread]: 
[0m16:39:06.479390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:39:06.482964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:39:06.684812 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:39:06.684812 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:39:06.684812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:09.205912 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.507 seconds
[0m16:39:09.207021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:39:09.222683 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:39:09.222683 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:39:09.222683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:10.646670 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.424 seconds
[0m16:39:10.662120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C6746C10>]}
[0m16:39:10.662120 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:39:10.662120 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:39:10.662120 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:39:10.662120 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:39:10.693957 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:39:10.693957 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:39:10.773440 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:10.789701 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM SRC_DATA.MEDICAL_EVENTS ME

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m16:39:10.789701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:12.542624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.759 seconds
[0m16:39:12.558083 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:12.558083 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:39:12.714462 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.164 seconds
[0m16:39:12.729916 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:12.729916 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:39:12.887104 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.157 seconds
[0m16:39:12.887104 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:12.902728 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:39:13.029518 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.136 seconds
[0m16:39:13.076222 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:39:13.091802 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:13.091802 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:39:13.295076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m16:39:13.295076 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:13.295076 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:39:16.036055 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 2.742 seconds
[0m16:39:16.051470 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:16.051470 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m16:39:16.303199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m16:39:16.303199 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:39:16.318682 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:39:16.318682 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m16:39:16.553170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m16:39:16.605356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7bda8ee-b94f-4fd7-84f7-3695eaa2aeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C59E8D50>]}
[0m16:39:16.606352 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 100000[0m in 5.94s]
[0m16:39:16.608369 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:39:16.610363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:16.611364 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:39:16.612360 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:39:16.893127 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:39:16.893127 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:39:17.180355 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:39:17.180355 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:39:17.508377 [info ] [MainThread]: 
[0m16:39:17.508377 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.03 seconds (11.03s).
[0m16:39:17.508377 [debug] [MainThread]: Command end result
[0m16:39:17.556745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:39:17.569157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:39:17.569286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:39:17.569286 [info ] [MainThread]: 
[0m16:39:17.581999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:17.584993 [info ] [MainThread]: 
[0m16:39:17.586558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:39:17.586558 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:17.586558 after 13.34 seconds
[0m16:39:17.586558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C5A0A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4BF57A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C57BA990>]}
[0m16:39:17.586558 [debug] [MainThread]: Flushing usage events
[0m16:39:19.288979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:31.483366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA58EB27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA58EB2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA58EB0650>]}


============================== 16:44:31.483366 | 4afa99f8-7b97-46c4-8d11-39212b5ce046 ==============================
[0m16:44:31.483366 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:44:31.483366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:44:32.125538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA59B8E990>]}
[0m16:44:32.188028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA59C48910>]}
[0m16:44:32.188028 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:44:33.002021 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:44:33.312901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:33.312901 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m16:44:33.707160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:44:33.733104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA5B1CA290>]}
[0m16:44:33.830640 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:44:33.846223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:44:33.924336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA5B1672D0>]}
[0m16:44:33.924336 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:44:33.924336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA5609D5D0>]}
[0m16:44:33.939985 [info ] [MainThread]: 
[0m16:44:33.939985 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:44:33.944818 [info ] [MainThread]: 
[0m16:44:33.946817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:33.949517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:44:34.130661 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:44:34.130661 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:44:34.130661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:36.166625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.025 seconds
[0m16:44:36.166625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:44:36.182048 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:44:36.182048 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:44:36.182048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:37.654525 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.466 seconds
[0m16:44:37.654525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA5B00FE50>]}
[0m16:44:37.654525 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:44:37.654525 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:44:37.654525 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:44:37.670146 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:44:37.670146 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:44:37.688805 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:44:37.761757 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:37.761757 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM --SRC_DATA.MEDICAL_EVENTS ME 
BHARATHDEV.src_data.medical_events me

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m16:44:37.761757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:39.394136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.629 seconds
[0m16:44:39.394136 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:39.394136 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:44:39.660931 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.268 seconds
[0m16:44:39.676335 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:39.676335 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:44:39.817093 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.141 seconds
[0m16:44:39.817093 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:39.832517 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:44:40.052844 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.227 seconds
[0m16:44:40.099549 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:44:40.115168 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:40.115168 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:44:40.287147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m16:44:40.287147 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:40.287147 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:44:42.653191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.355 seconds
[0m16:44:42.653191 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:42.653191 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m16:44:42.903328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m16:44:42.918720 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:44:42.934341 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:44:42.934341 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m16:44:43.153844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m16:44:43.184880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa99f8-7b97-46c4-8d11-39212b5ce046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA5B909B90>]}
[0m16:44:43.184880 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 1[0m in 5.53s]
[0m16:44:43.184880 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:44:43.184880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:43.184880 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:44:43.184880 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:44:43.476216 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:44:43.476216 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:44:43.796455 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:44:43.796455 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:44:44.093093 [info ] [MainThread]: 
[0m16:44:44.093093 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m16:44:44.093093 [debug] [MainThread]: Command end result
[0m16:44:44.123027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:44:44.137734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:44:44.141216 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:44:44.141216 [info ] [MainThread]: 
[0m16:44:44.141216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:44.141216 [info ] [MainThread]: 
[0m16:44:44.156386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:44.156386 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:44.156386 after 12.80 seconds
[0m16:44:44.156386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA58BB6B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA52A2C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA52AFF050>]}
[0m16:44:44.156386 [debug] [MainThread]: Flushing usage events
[0m16:44:45.864555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:55.478608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B7263150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B7262150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B7263C10>]}


============================== 16:45:55.478608 | 7ac9c77e-4dda-4e4d-999e-ebf234df4373 ==============================
[0m16:45:55.478608 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:45:55.478608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:45:56.105059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B7FDBB90>]}
[0m16:45:56.183167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B7F62090>]}
[0m16:45:56.183167 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:45:56.951890 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m16:45:57.217457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:57.217457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:57.233110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m16:45:57.301403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B93B1090>]}
[0m16:45:57.406592 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:45:57.422214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:45:57.453495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B927BD50>]}
[0m16:45:57.453495 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m16:45:57.453495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B94C9050>]}
[0m16:45:57.469110 [info ] [MainThread]: 
[0m16:45:57.469110 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:45:57.472220 [info ] [MainThread]: 
[0m16:45:57.473219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:57.477295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m16:45:57.672473 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m16:45:57.672473 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m16:45:57.672473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:59.489923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.821 seconds
[0m16:45:59.505547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m16:45:59.568031 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m16:45:59.599274 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m16:45:59.599274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:01.118641 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.519 seconds
[0m16:46:01.118641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B66761D0>]}
[0m16:46:01.118641 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m16:46:01.118641 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m16:46:01.118641 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m16:46:01.118641 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m16:46:01.149740 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m16:46:01.153841 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m16:46:01.224867 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:01.224867 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM --SRC_DATA.MEDICAL_EVENTS ME 
BHARATHDEV.src_data.medical_events me

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m16:46:01.224867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:02.779438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.548 seconds
[0m16:46:02.779438 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:02.779438 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:46:02.966929 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.187 seconds
[0m16:46:02.982349 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:02.982349 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m16:46:03.139668 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.157 seconds
[0m16:46:03.155698 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:03.156694 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m16:46:03.280896 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.135 seconds
[0m16:46:03.327595 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m16:46:03.327595 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:03.327595 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m16:46:03.515219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m16:46:03.515219 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:03.515219 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m16:46:05.896860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.375 seconds
[0m16:46:05.896860 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:05.896860 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m16:46:06.162425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m16:46:06.177843 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m16:46:06.193464 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m16:46:06.193464 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m16:46:06.429774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m16:46:06.460815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac9c77e-4dda-4e4d-999e-ebf234df4373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B9BEF0D0>]}
[0m16:46:06.460815 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 1[0m in 5.34s]
[0m16:46:06.460815 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m16:46:06.460815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:06.460815 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m16:46:06.460815 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m16:46:06.769910 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m16:46:06.769910 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m16:46:07.086485 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m16:46:07.086485 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m16:46:07.393226 [info ] [MainThread]: 
[0m16:46:07.394804 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m16:46:07.396363 [debug] [MainThread]: Command end result
[0m16:46:07.434250 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m16:46:07.434250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m16:46:07.450593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m16:46:07.450593 [info ] [MainThread]: 
[0m16:46:07.450593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:07.450593 [info ] [MainThread]: 
[0m16:46:07.450593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:46:07.450593 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:07.450593 after 12.10 seconds
[0m16:46:07.450593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B72DAA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B0DCA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2B72A83D0>]}
[0m16:46:07.450593 [debug] [MainThread]: Flushing usage events
[0m16:46:09.342345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:11.082608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB143F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB143FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB143CF50>]}


============================== 17:28:11.098230 | 08aeb47d-cddb-473a-ba42-3ad7c2ffff6a ==============================
[0m17:28:11.098230 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:28:11.098230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:11.770558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB20DD450>]}
[0m17:28:11.848701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB0829210>]}
[0m17:28:11.848701 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:28:12.650672 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m17:28:12.916235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:12.931860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:12.931860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m17:28:13.018596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB34BC7D0>]}
[0m17:28:13.128762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:28:13.139211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:28:13.181475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB36C6F10>]}
[0m17:28:13.181475 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m17:28:13.181475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB36B7A50>]}
[0m17:28:13.181475 [info ] [MainThread]: 
[0m17:28:13.181475 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:28:13.190806 [info ] [MainThread]: 
[0m17:28:13.192802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:13.195506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m17:28:13.393270 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m17:28:13.393270 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m17:28:13.393270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:15.751170 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.365 seconds
[0m17:28:15.766619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m17:28:15.766619 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m17:28:15.783098 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m17:28:15.783098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:17.331761 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.551 seconds
[0m17:28:17.331761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB36B7A50>]}
[0m17:28:17.331761 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m17:28:17.331761 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m17:28:17.331761 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m17:28:17.347232 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m17:28:17.363851 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m17:28:17.363851 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m17:28:17.444244 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:17.446207 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM --SRC_DATA.MEDICAL_EVENTS ME 
BHARATHDEV.src_data.medical_events me

  where ME.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m17:28:17.447268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:19.181817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.740 seconds
[0m17:28:19.197226 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:19.197226 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m17:28:19.416098 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.219 seconds
[0m17:28:19.416098 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:19.416098 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m17:28:19.605080 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.192 seconds
[0m17:28:19.620525 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:19.620525 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m17:28:19.807982 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.182 seconds
[0m17:28:19.839267 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m17:28:19.839267 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:19.854845 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m17:28:20.058998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m17:28:20.058998 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:20.058998 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m17:28:22.738239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.673 seconds
[0m17:28:22.738239 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:22.738239 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m17:28:23.050657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m17:28:23.066144 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m17:28:23.081765 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:28:23.081765 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m17:28:23.363798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m17:28:23.394874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aeb47d-cddb-473a-ba42-3ad7c2ffff6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB3235C10>]}
[0m17:28:23.394874 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 1[0m in 6.06s]
[0m17:28:23.394874 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m17:28:23.394874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:23.394874 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m17:28:23.394874 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m17:28:23.865049 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m17:28:23.865049 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m17:28:24.240113 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m17:28:24.240113 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m17:28:24.585578 [info ] [MainThread]: 
[0m17:28:24.585578 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.39 seconds (11.39s).
[0m17:28:24.585578 [debug] [MainThread]: Command end result
[0m17:28:24.638740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:28:24.655336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:28:24.655336 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m17:28:24.655336 [info ] [MainThread]: 
[0m17:28:24.655336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:24.672170 [info ] [MainThread]: 
[0m17:28:24.674168 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:28:24.676846 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:24.676846 after 13.81 seconds
[0m17:28:24.677841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB14AFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECAAF8A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECAAFCF050>]}
[0m17:28:24.678841 [debug] [MainThread]: Flushing usage events
[0m17:28:26.293197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:06.651920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E76A33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E76A37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E76A28D0>]}


============================== 17:29:06.658904 | 4292b7f2-e00a-4978-820e-650817773918 ==============================
[0m17:29:06.658904 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:29:06.660488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_medical_events --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m17:29:07.301638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E7597E50>]}
[0m17:29:07.379746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E839E210>]}
[0m17:29:07.379746 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:29:08.146820 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m17:29:08.445196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:08.445196 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_medical_events.sql
[0m17:29:08.775550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m17:29:08.793300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E99762D0>]}
[0m17:29:08.906686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:29:08.922307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:29:09.000445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E9A87B50>]}
[0m17:29:09.016033 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 470 macros
[0m17:29:09.016033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E9A87D50>]}
[0m17:29:09.016033 [info ] [MainThread]: 
[0m17:29:09.016033 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:29:09.022868 [info ] [MainThread]: 
[0m17:29:09.024864 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:09.028509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m17:29:09.219963 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m17:29:09.219963 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m17:29:09.219963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:11.095050 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.882 seconds
[0m17:29:11.110540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m17:29:11.126192 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m17:29:11.126192 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m17:29:11.126192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:12.737702 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.613 seconds
[0m17:29:12.737702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E528A950>]}
[0m17:29:12.753325 [debug] [Thread-1 (]: Began running node model.capston.dim_medical_events
[0m17:29:12.753325 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_medical_events ................... [RUN]
[0m17:29:12.753325 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_medical_events'
[0m17:29:12.753325 [debug] [Thread-1 (]: Began compiling node model.capston.dim_medical_events
[0m17:29:12.771942 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_medical_events"
[0m17:29:12.775929 [debug] [Thread-1 (]: Began executing node model.capston.dim_medical_events
[0m17:29:12.850981 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:12.851979 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM --SRC_DATA.MEDICAL_EVENTS ME 
BHARATHDEV.src_data.medical_events me

  where ME.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_medical_events)

)

SELECT
TGT_DM.SEQ_DIM_MEDICAL_EVENTS.NEXTVAL AS ID,
EVENT_ID,
PATIENT_ID,
EVENT_DATE,
EVENT_TYPE,
DIAGNOSIS_CODE,
PROCEDURE_CODE,
MEDICATION_CODE,
PROVIDER_ID,
FACILITY_ID,
NOTES,
MD5(
COALESCE(EVENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(EVENT_TYPE::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODE::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODE::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(NOTES::varchar, '') || '-' ||
COALESCE(INSERT_DATE::varchar, '')
) AS HASH_KEY,
INSERT_DATE AS base_add_date,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE,
FROM source
  );
[0m17:29:12.852977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:14.852097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.000 seconds
[0m17:29:14.852097 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:14.852097 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m17:29:15.024111 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.170 seconds
[0m17:29:15.039588 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:15.039588 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table BHARATHDEV.tgt_dm.dim_medical_events
[0m17:29:15.214686 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.177 seconds
[0m17:29:15.214686 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:15.230121 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_MEDICAL_EVENTS"
[0m17:29:15.402106 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.184 seconds
[0m17:29:15.448819 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_medical_events"
[0m17:29:15.448819 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:15.448819 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m17:29:15.659262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m17:29:15.660253 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:15.661221 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
merge into BHARATHDEV.tgt_dm.dim_medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EVENT_ID = DBT_INTERNAL_DEST.EVENT_ID
                )

    
    when matched then update set
        "EVENT_ID" = DBT_INTERNAL_SOURCE."EVENT_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m17:29:16.142939 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.487 seconds
[0m17:29:16.142939 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:16.142939 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
COMMIT
[0m17:29:16.371678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m17:29:16.387155 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp
[0m17:29:16.402815 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_medical_events"
[0m17:29:16.402815 [debug] [Thread-1 (]: On model.capston.dim_medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_medical_events"} */
drop view if exists BHARATHDEV.tgt_dm.dim_medical_events__dbt_tmp cascade
[0m17:29:16.652924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m17:29:16.683962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4292b7f2-e00a-4978-820e-650817773918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E83F4390>]}
[0m17:29:16.683962 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_medical_events .............. [[32mSUCCESS 0[0m in 3.93s]
[0m17:29:16.683962 [debug] [Thread-1 (]: Finished running node model.capston.dim_medical_events
[0m17:29:16.683962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:16.683962 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m17:29:16.683962 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m17:29:17.144676 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m17:29:17.144676 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m17:29:17.515087 [debug] [MainThread]: Connection 'model.capston.dim_medical_events' was left open.
[0m17:29:17.515087 [debug] [MainThread]: On model.capston.dim_medical_events: Close
[0m17:29:17.829158 [info ] [MainThread]: 
[0m17:29:17.829158 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m17:29:17.829158 [debug] [MainThread]: Command end result
[0m17:29:17.883308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:29:17.883308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:29:17.899719 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m17:29:17.899719 [info ] [MainThread]: 
[0m17:29:17.899719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:17.899719 [info ] [MainThread]: 
[0m17:29:17.915988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:17.915988 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:17.915988 after 11.41 seconds
[0m17:29:17.915988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E74CA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E10AC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E73D7FD0>]}
[0m17:29:17.915988 [debug] [MainThread]: Flushing usage events
[0m17:29:19.490219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:14.038617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A17013790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A17013650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A170134D0>]}


============================== 18:43:14.045774 | 4563cf6b-cdaf-4e31-8c08-97cda1718ece ==============================
[0m18:43:14.045774 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:43:14.047885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_claim_provider --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:14.798981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A17DD2C90>]}
[0m18:43:14.874488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A17D0E190>]}
[0m18:43:14.876695 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:43:15.650986 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:43:15.946011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:43:15.947009 [debug] [MainThread]: Partial parsing: added file: capston://models\dim\dim_claim_provider.sql
[0m18:43:16.282932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m18:43:16.302118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A140FFF10>]}
[0m18:43:16.415675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:43:16.423895 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:43:16.518577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1328CB10>]}
[0m18:43:16.520603 [info ] [MainThread]: Found 4 models, 4 data tests, 6 sources, 470 macros
[0m18:43:16.521569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A14114ED0>]}
[0m18:43:16.523697 [info ] [MainThread]: 
[0m18:43:16.525692 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:43:16.526687 [info ] [MainThread]: 
[0m18:43:16.528683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:43:16.531676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:43:16.908183 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:43:16.909150 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:43:16.910146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:18.907232 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.998 seconds
[0m18:43:18.915378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:43:18.927716 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:43:18.928714 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:43:18.929834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:20.404201 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.474 seconds
[0m18:43:20.409280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A132E1150>]}
[0m18:43:20.413083 [debug] [Thread-1 (]: Began running node model.capston.dim_claim_provider
[0m18:43:20.414083 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_claim_provider ................... [RUN]
[0m18:43:20.416209 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_claim_provider'
[0m18:43:20.417206 [debug] [Thread-1 (]: Began compiling node model.capston.dim_claim_provider
[0m18:43:20.438598 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_claim_provider"
[0m18:43:20.442554 [debug] [Thread-1 (]: Began executing node model.capston.dim_claim_provider
[0m18:43:20.508572 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:43:20.510568 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
  
   as (
    

WITH source AS (
SELECT * FROM --SRC_DATA.MEDICAL_EVENTS ME 
BHARATHDEV.src_data.claims c

  where ME.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)

)

WITH SOURCE AS (
SELECT CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
P.PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
C.INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.claims C 
JOIN BHARATHDEV.src_data.provider P ON C.PROVIDER_ID = P.PROVIDER_ID 
where c.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)
)
SELECT SEQ_DIM_CLAIM_PROVIDER.NEXTVAL AS ID,
CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
MD5(
COALESCE(CLAIM_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(SERVICE_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_AMOUNT::varchar, '') || '-' ||
COALESCE(CLAIM_STATUS::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODES::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODES::varchar, '') || '-' ||
COALESCE(PROVIDER_NAME::varchar, '') || '-' ||
COALESCE(SPECIALTY::varchar, '') || '-' ||
COALESCE(NPI_NUMBER::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY,
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:43:20.511566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:22.142413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95ad9-3201-5e05-000b-0bfe0026e382
[0m18:43:22.143416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
syntax error line 29 at position 20 unexpected 'AS'.
[0m18:43:22.167404 [debug] [Thread-1 (]: Database Error in model dim_claim_provider (models\dim\dim_claim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 29 at position 20 unexpected 'AS'.
[0m18:43:22.171555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4563cf6b-cdaf-4e31-8c08-97cda1718ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A198999D0>]}
[0m18:43:22.172551 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_claim_provider .......... [[31mERROR[0m in 1.75s]
[0m18:43:22.174543 [debug] [Thread-1 (]: Finished running node model.capston.dim_claim_provider
[0m18:43:22.176142 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_claim_provider' to be skipped because of status 'error'.  Reason: Database Error in model dim_claim_provider (models\dim\dim_claim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 29 at position 20 unexpected 'AS'..
[0m18:43:22.179246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:22.179246 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:43:22.180301 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:43:22.519108 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:43:22.520109 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:43:22.798277 [debug] [MainThread]: Connection 'model.capston.dim_claim_provider' was left open.
[0m18:43:22.799275 [debug] [MainThread]: On model.capston.dim_claim_provider: Close
[0m18:43:23.188770 [info ] [MainThread]: 
[0m18:43:23.189488 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m18:43:23.191611 [debug] [MainThread]: Command end result
[0m18:43:23.233364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:43:23.240552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:43:23.251784 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:43:23.252781 [info ] [MainThread]: 
[0m18:43:23.253888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:43:23.255899 [info ] [MainThread]: 
[0m18:43:23.256374 [error] [MainThread]:   Database Error in model dim_claim_provider (models\dim\dim_claim_provider.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 29 at position 20 unexpected 'AS'.
[0m18:43:23.259515 [info ] [MainThread]: 
[0m18:43:23.260166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:43:23.263503 [debug] [MainThread]: Command `dbt run` failed at 18:43:23.263503 after 9.38 seconds
[0m18:43:23.265498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A10B2A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A16D47FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A17003D10>]}
[0m18:43:23.267490 [debug] [MainThread]: Flushing usage events
[0m18:43:25.074689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:02.663250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A335ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A33037D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A3303AD0>]}


============================== 18:44:02.670515 | c49cef8c-e51e-4397-a733-9f7714b09f9c ==============================
[0m18:44:02.670515 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:44:02.671513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_claim_provider --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:03.310293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A312AED0>]}
[0m18:44:03.380324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A26E9410>]}
[0m18:44:03.382357 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:44:04.149518 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:44:04.434579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:04.435612 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_claim_provider.sql
[0m18:44:04.762256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:44:04.778706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A52EA450>]}
[0m18:44:04.910350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:44:04.918605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:44:04.958751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A574E890>]}
[0m18:44:04.959749 [info ] [MainThread]: Found 4 models, 4 data tests, 6 sources, 470 macros
[0m18:44:04.961848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A561B190>]}
[0m18:44:04.963878 [info ] [MainThread]: 
[0m18:44:04.964840 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:44:04.966975 [info ] [MainThread]: 
[0m18:44:04.968971 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:04.972961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:44:05.219054 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:44:05.220054 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:44:05.221052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:06.979160 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.758 seconds
[0m18:44:06.987307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:44:06.999654 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:44:07.001618 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:44:07.001618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:08.517328 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.515 seconds
[0m18:44:08.522434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A5677B90>]}
[0m18:44:08.526160 [debug] [Thread-1 (]: Began running node model.capston.dim_claim_provider
[0m18:44:08.527160 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_claim_provider ................... [RUN]
[0m18:44:08.529004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_claim_provider'
[0m18:44:08.530129 [debug] [Thread-1 (]: Began compiling node model.capston.dim_claim_provider
[0m18:44:08.552218 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_claim_provider"
[0m18:44:08.555210 [debug] [Thread-1 (]: Began executing node model.capston.dim_claim_provider
[0m18:44:08.625081 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:08.626184 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
P.PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
C.INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.claims C 
JOIN BHARATHDEV.src_data.provider P ON C.PROVIDER_ID = P.PROVIDER_ID 
where c.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)
)
SELECT SEQ_DIM_CLAIM_PROVIDER.NEXTVAL AS ID,
CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
MD5(
COALESCE(CLAIM_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(SERVICE_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_AMOUNT::varchar, '') || '-' ||
COALESCE(CLAIM_STATUS::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODES::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODES::varchar, '') || '-' ||
COALESCE(PROVIDER_NAME::varchar, '') || '-' ||
COALESCE(SPECIALTY::varchar, '') || '-' ||
COALESCE(NPI_NUMBER::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY,
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:44:08.627182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:10.296897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.670 seconds
[0m18:44:10.309274 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:10.310271 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m18:44:10.497378 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.186 seconds
[0m18:44:10.502537 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:10.503533 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider
[0m18:44:10.661973 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.157 seconds
[0m18:44:10.672320 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:10.673284 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CLAIM_PROVIDER"
[0m18:44:10.900850 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.227 seconds
[0m18:44:10.936874 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_claim_provider"
[0m18:44:10.942123 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:10.943122 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
-- back compat for old kwarg name
  
  begin;
[0m18:44:11.121831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m18:44:11.122834 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:11.123828 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
merge into BHARATHDEV.tgt_dm.dim_claim_provider as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.CLAIM_ID = DBT_INTERNAL_DEST.CLAIM_ID
                ) and (
                    DBT_INTERNAL_SOURCE.PROVIDER_ID = DBT_INTERNAL_DEST.PROVIDER_ID
                )

    
    when matched then update set
        "CLAIM_ID" = DBT_INTERNAL_SOURCE."CLAIM_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","SERVICE_DATE" = DBT_INTERNAL_SOURCE."SERVICE_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","CLAIM_AMOUNT" = DBT_INTERNAL_SOURCE."CLAIM_AMOUNT","CLAIM_STATUS" = DBT_INTERNAL_SOURCE."CLAIM_STATUS","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","DIAGNOSIS_CODES" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODES","PROCEDURE_CODES" = DBT_INTERNAL_SOURCE."PROCEDURE_CODES","PROVIDER_NAME" = DBT_INTERNAL_SOURCE."PROVIDER_NAME","SPECIALTY" = DBT_INTERNAL_SOURCE."SPECIALTY","NPI_NUMBER" = DBT_INTERNAL_SOURCE."NPI_NUMBER","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:44:15.535738 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 4.411 seconds
[0m18:44:15.537732 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:15.537732 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
COMMIT
[0m18:44:15.831729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m18:44:15.841697 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m18:44:15.854040 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:15.855040 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
drop view if exists BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp cascade
[0m18:44:16.069523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m18:44:16.097693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c49cef8c-e51e-4397-a733-9f7714b09f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222A5B67650>]}
[0m18:44:16.098797 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_claim_provider .............. [[32mSUCCESS 100000[0m in 7.57s]
[0m18:44:16.100796 [debug] [Thread-1 (]: Finished running node model.capston.dim_claim_provider
[0m18:44:16.102787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:16.103917 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:44:16.104918 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:44:16.426733 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:44:16.427733 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:44:16.708044 [debug] [MainThread]: Connection 'model.capston.dim_claim_provider' was left open.
[0m18:44:16.708183 [debug] [MainThread]: On model.capston.dim_claim_provider: Close
[0m18:44:16.998283 [info ] [MainThread]: 
[0m18:44:16.999281 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m18:44:17.001423 [debug] [MainThread]: Command end result
[0m18:44:17.051516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:44:17.059803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:44:17.076302 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:44:17.077303 [info ] [MainThread]: 
[0m18:44:17.078298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:17.080295 [info ] [MainThread]: 
[0m18:44:17.081429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:17.084422 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:17.084422 after 14.55 seconds
[0m18:44:17.085421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229CE9A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229CEDF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002229CEE81D0>]}
[0m18:44:17.087578 [debug] [MainThread]: Flushing usage events
[0m18:44:18.622562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:27.142911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD71823910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD71823490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD71822C90>]}


============================== 18:44:27.150196 | 4f4b23b8-3aed-4910-8edc-86d437a447af ==============================
[0m18:44:27.150196 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:44:27.152179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_claim_provider --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:44:27.791259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD6ED93910>]}
[0m18:44:27.861290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7251E6D0>]}
[0m18:44:27.863444 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:44:28.642211 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:44:28.928580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:28.929748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:28.938879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:44:29.006538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD738906D0>]}
[0m18:44:29.123358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:44:29.131591 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:44:29.170760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7387E310>]}
[0m18:44:29.171864 [info ] [MainThread]: Found 4 models, 4 data tests, 6 sources, 470 macros
[0m18:44:29.173863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7381D590>]}
[0m18:44:29.175855 [info ] [MainThread]: 
[0m18:44:29.176970 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:44:29.178965 [info ] [MainThread]: 
[0m18:44:29.181959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:29.184951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:44:29.388777 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:44:29.389772 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:44:29.390773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:31.179756 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.790 seconds
[0m18:44:31.187936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:44:31.206309 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:44:31.207339 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:44:31.208306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:32.567184 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.358 seconds
[0m18:44:32.571273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD713B3D90>]}
[0m18:44:32.575629 [debug] [Thread-1 (]: Began running node model.capston.dim_claim_provider
[0m18:44:32.576630 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_claim_provider ................... [RUN]
[0m18:44:32.578328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_claim_provider'
[0m18:44:32.579490 [debug] [Thread-1 (]: Began compiling node model.capston.dim_claim_provider
[0m18:44:32.591595 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_claim_provider"
[0m18:44:32.595585 [debug] [Thread-1 (]: Began executing node model.capston.dim_claim_provider
[0m18:44:32.665381 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:32.666378 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
P.PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
C.INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.claims C 
JOIN BHARATHDEV.src_data.provider P ON C.PROVIDER_ID = P.PROVIDER_ID 
where c.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)
)
SELECT SEQ_DIM_CLAIM_PROVIDER.NEXTVAL AS ID,
CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
MD5(
COALESCE(CLAIM_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(SERVICE_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_AMOUNT::varchar, '') || '-' ||
COALESCE(CLAIM_STATUS::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODES::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODES::varchar, '') || '-' ||
COALESCE(PROVIDER_NAME::varchar, '') || '-' ||
COALESCE(SPECIALTY::varchar, '') || '-' ||
COALESCE(NPI_NUMBER::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY,
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:44:32.667492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:34.336059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.668 seconds
[0m18:44:34.346392 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:34.347388 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m18:44:34.548602 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.200 seconds
[0m18:44:34.554795 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:34.555826 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider
[0m18:44:34.711817 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.155 seconds
[0m18:44:34.723061 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:34.724027 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CLAIM_PROVIDER"
[0m18:44:34.883121 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.159 seconds
[0m18:44:34.922600 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_claim_provider"
[0m18:44:34.926681 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:34.927712 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
-- back compat for old kwarg name
  
  begin;
[0m18:44:35.110985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m18:44:35.112890 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:35.114885 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
merge into BHARATHDEV.tgt_dm.dim_claim_provider as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.CLAIM_ID = DBT_INTERNAL_DEST.CLAIM_ID
                ) and (
                    DBT_INTERNAL_SOURCE.PROVIDER_ID = DBT_INTERNAL_DEST.PROVIDER_ID
                )

    
    when matched then update set
        "CLAIM_ID" = DBT_INTERNAL_SOURCE."CLAIM_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","SERVICE_DATE" = DBT_INTERNAL_SOURCE."SERVICE_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","CLAIM_AMOUNT" = DBT_INTERNAL_SOURCE."CLAIM_AMOUNT","CLAIM_STATUS" = DBT_INTERNAL_SOURCE."CLAIM_STATUS","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","DIAGNOSIS_CODES" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODES","PROCEDURE_CODES" = DBT_INTERNAL_SOURCE."PROCEDURE_CODES","PROVIDER_NAME" = DBT_INTERNAL_SOURCE."PROVIDER_NAME","SPECIALTY" = DBT_INTERNAL_SOURCE."SPECIALTY","NPI_NUMBER" = DBT_INTERNAL_SOURCE."NPI_NUMBER","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:44:35.620632 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.505 seconds
[0m18:44:35.621660 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:35.622769 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
COMMIT
[0m18:44:35.827239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m18:44:35.838645 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m18:44:35.847883 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m18:44:35.848847 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
drop view if exists BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp cascade
[0m18:44:36.115843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m18:44:36.142469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4b23b8-3aed-4910-8edc-86d437a447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD741994D0>]}
[0m18:44:36.143458 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_claim_provider .............. [[32mSUCCESS 0[0m in 3.56s]
[0m18:44:36.145782 [debug] [Thread-1 (]: Finished running node model.capston.dim_claim_provider
[0m18:44:36.148263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:36.149312 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:44:36.150419 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:44:36.461358 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:44:36.461358 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:44:36.739498 [debug] [MainThread]: Connection 'model.capston.dim_claim_provider' was left open.
[0m18:44:36.740497 [debug] [MainThread]: On model.capston.dim_claim_provider: Close
[0m18:44:37.017082 [info ] [MainThread]: 
[0m18:44:37.019046 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m18:44:37.021134 [debug] [MainThread]: Command end result
[0m18:44:37.057808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:44:37.063952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:44:37.075324 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:44:37.076321 [info ] [MainThread]: 
[0m18:44:37.078422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:37.078984 [info ] [MainThread]: 
[0m18:44:37.080982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:44:37.083149 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:37.083149 after 10.06 seconds
[0m18:44:37.084179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD6B28A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7189ACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD7189ADD0>]}
[0m18:44:37.086140 [debug] [MainThread]: Flushing usage events
[0m18:44:38.708383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:44.481333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C35423B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C354234D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C35423790>]}


============================== 18:47:44.496986 | 67e77b5b-a9d8-4d9b-9ad1-f9d93f111153 ==============================
[0m18:47:44.496986 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:47:44.496986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_patient --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:47:45.140131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C361F12D0>]}
[0m18:47:45.203262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C37280D10>]}
[0m18:47:45.203262 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:47:45.969290 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:47:46.238355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:47:46.238355 [debug] [MainThread]: Partial parsing: added file: capston://models\dim\dim_patient.sql
[0m18:47:46.566629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:47:46.601403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C3721A0D0>]}
[0m18:47:46.717741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:47:46.733393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:47:46.816074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C37765610>]}
[0m18:47:46.816074 [info ] [MainThread]: Found 5 models, 4 data tests, 6 sources, 470 macros
[0m18:47:46.816074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C377CD1D0>]}
[0m18:47:46.816074 [info ] [MainThread]: 
[0m18:47:46.816074 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:47:46.830929 [info ] [MainThread]: 
[0m18:47:46.832924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:46.836904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:47:47.030558 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:47:47.030558 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:47:47.030558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:50.216266 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.183 seconds
[0m18:47:50.216266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:47:50.231633 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:47:50.231633 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:47:50.231633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:51.781284 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.550 seconds
[0m18:47:51.796709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2EE79F10>]}
[0m18:47:51.796709 [debug] [Thread-1 (]: Began running node model.capston.dim_patient
[0m18:47:51.796709 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_patient .......................... [RUN]
[0m18:47:51.796709 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_patient'
[0m18:47:51.796709 [debug] [Thread-1 (]: Began compiling node model.capston.dim_patient
[0m18:47:51.823456 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_patient"
[0m18:47:51.826873 [debug] [Thread-1 (]: Began executing node model.capston.dim_patient
[0m18:47:51.898776 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:47:51.898776 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
  
   as (
    

WITH SOURCE AS (
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.patient_t p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_patient)

)
SELECT 
SEQ_DIM_PATIENT.NEXTVAL AS ID,
PATIENT_ID,
PATIENT_NAME,
DATE_OF_BIRTH,
AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
MD5(
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_NAME::varchar, '') || '-' ||
COALESCE(DATE_OF_BIRTH::varchar, '') || '-' ||
COALESCE(AGE::varchar, '') || '-' ||
COALESCE(GENDER::varchar, '') || '-' ||
COALESCE(RACE::varchar, '') || '-' ||
COALESCE(ETHNICITY::varchar, '') || '-' ||
COALESCE(ADDRESS::varchar, '') || '-' ||
COALESCE(CITY::varchar, '') || '-' ||
COALESCE(STATE::varchar, '') || '-' ||
COALESCE(ZIP_CODE::varchar, '') || '-' ||
COALESCE(INSURANCE_TYPE::varchar, '') || '-' ||
COALESCE(PRIMARY_CARE_PROVIDER_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:47:51.898776 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:47:53.595783 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b95add-3201-5e29-000b-0bfe0026dc9a
[0m18:47:53.595783 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 9 unexpected ','.
syntax error line 8 at position 7 unexpected ','.
syntax error line 9 at position 4 unexpected ','.
syntax error line 10 at position 5 unexpected ','.
syntax error line 11 at position 8 unexpected ','.
syntax error line 12 at position 14 unexpected ','.
syntax error line 13 at position 24 unexpected ','.
syntax error line 14 at position 15 unexpected 'BASE_ADD_DATE'.
syntax error line 15 at position 18 unexpected ')'.
syntax error line 15 at position 23 unexpected 'INSERT_DATE'.
syntax error line 16 at position 18 unexpected ')'.
syntax error line 16 at position 23 unexpected 'UPDATE_DATE'.
syntax error line 17 at position 0 unexpected 'FROM'.
syntax error line 19 at position 59 unexpected ','.
[0m18:47:53.611405 [debug] [Thread-1 (]: Database Error in model dim_patient (models\dim\dim_patient.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 9 unexpected ','.
  syntax error line 8 at position 7 unexpected ','.
  syntax error line 9 at position 4 unexpected ','.
  syntax error line 10 at position 5 unexpected ','.
  syntax error line 11 at position 8 unexpected ','.
  syntax error line 12 at position 14 unexpected ','.
  syntax error line 13 at position 24 unexpected ','.
  syntax error line 14 at position 15 unexpected 'BASE_ADD_DATE'.
  syntax error line 15 at position 18 unexpected ')'.
  syntax error line 15 at position 23 unexpected 'INSERT_DATE'.
  syntax error line 16 at position 18 unexpected ')'.
  syntax error line 16 at position 23 unexpected 'UPDATE_DATE'.
  syntax error line 17 at position 0 unexpected 'FROM'.
  syntax error line 19 at position 59 unexpected ','.
[0m18:47:53.614634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e77b5b-a9d8-4d9b-9ad1-f9d93f111153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C37AE9610>]}
[0m18:47:53.614634 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model tgt_dm.dim_patient ................. [[31mERROR[0m in 1.82s]
[0m18:47:53.614634 [debug] [Thread-1 (]: Finished running node model.capston.dim_patient
[0m18:47:53.614634 [debug] [Thread-5 (]: Marking all children of 'model.capston.dim_patient' to be skipped because of status 'error'.  Reason: Database Error in model dim_patient (models\dim\dim_patient.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 9 unexpected ','.
  syntax error line 8 at position 7 unexpected ','.
  syntax error line 9 at position 4 unexpected ','.
  syntax error line 10 at position 5 unexpected ','.
  syntax error line 11 at position 8 unexpected ','.
  syntax error line 12 at position 14 unexpected ','.
  syntax error line 13 at position 24 unexpected ','.
  syntax error line 14 at position 15 unexpected 'BASE_ADD_DATE'.
  syntax error line 15 at position 18 unexpected ')'.
  syntax error line 15 at position 23 unexpected 'INSERT_DATE'.
  syntax error line 16 at position 18 unexpected ')'.
  syntax error line 16 at position 23 unexpected 'UPDATE_DATE'.
  syntax error line 17 at position 0 unexpected 'FROM'.
  syntax error line 19 at position 59 unexpected ','..
[0m18:47:53.614634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:53.614634 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:47:53.614634 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:47:53.923669 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:47:53.923669 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:47:54.209765 [debug] [MainThread]: Connection 'model.capston.dim_patient' was left open.
[0m18:47:54.225184 [debug] [MainThread]: On model.capston.dim_patient: Close
[0m18:47:54.490927 [info ] [MainThread]: 
[0m18:47:54.490927 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m18:47:54.490927 [debug] [MainThread]: Command end result
[0m18:47:54.528303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:47:54.545245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:47:54.545245 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:47:54.545245 [info ] [MainThread]: 
[0m18:47:54.561629 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:47:54.561629 [info ] [MainThread]: 
[0m18:47:54.561629 [error] [MainThread]:   Database Error in model dim_patient (models\dim\dim_patient.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 9 unexpected ','.
  syntax error line 8 at position 7 unexpected ','.
  syntax error line 9 at position 4 unexpected ','.
  syntax error line 10 at position 5 unexpected ','.
  syntax error line 11 at position 8 unexpected ','.
  syntax error line 12 at position 14 unexpected ','.
  syntax error line 13 at position 24 unexpected ','.
  syntax error line 14 at position 15 unexpected 'BASE_ADD_DATE'.
  syntax error line 15 at position 18 unexpected ')'.
  syntax error line 15 at position 23 unexpected 'INSERT_DATE'.
  syntax error line 16 at position 18 unexpected ')'.
  syntax error line 16 at position 23 unexpected 'UPDATE_DATE'.
  syntax error line 17 at position 0 unexpected 'FROM'.
  syntax error line 19 at position 59 unexpected ','.
[0m18:47:54.561629 [info ] [MainThread]: 
[0m18:47:54.561629 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:47:54.561629 [debug] [MainThread]: Command `dbt run` failed at 18:47:54.561629 after 10.20 seconds
[0m18:47:54.577251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C3524EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C35157E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C35413E50>]}
[0m18:47:54.579455 [debug] [MainThread]: Flushing usage events
[0m18:47:55.902816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:57.274371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6308A2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6308A3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6308A3850>]}


============================== 18:48:57.274371 | 51ef8063-2563-47fb-821f-75732fed2ed8 ==============================
[0m18:48:57.274371 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:48:57.289961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_patient --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m18:48:57.994398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6308A0E10>]}
[0m18:48:58.057858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63159E950>]}
[0m18:48:58.073472 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:48:58.822862 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:48:59.092098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:59.092098 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_patient.sql
[0m18:48:59.404521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:48:59.437865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6328FC9D0>]}
[0m18:48:59.542180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:48:59.557799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:48:59.639461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B632C54590>]}
[0m18:48:59.639461 [info ] [MainThread]: Found 5 models, 4 data tests, 6 sources, 470 macros
[0m18:48:59.639461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B632C0AED0>]}
[0m18:48:59.655081 [info ] [MainThread]: 
[0m18:48:59.655081 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:48:59.658243 [info ] [MainThread]: 
[0m18:48:59.660238 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:48:59.664227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:48:59.856611 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:48:59.856611 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:48:59.872195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:02.097813 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.228 seconds
[0m18:49:02.097813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:49:02.113432 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:49:02.113432 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:49:02.113432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:03.593994 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.472 seconds
[0m18:49:03.593994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B632C0AED0>]}
[0m18:49:03.593994 [debug] [Thread-1 (]: Began running node model.capston.dim_patient
[0m18:49:03.593994 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_patient .......................... [RUN]
[0m18:49:03.593994 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_patient'
[0m18:49:03.593994 [debug] [Thread-1 (]: Began compiling node model.capston.dim_patient
[0m18:49:03.609623 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_patient"
[0m18:49:03.625240 [debug] [Thread-1 (]: Began executing node model.capston.dim_patient
[0m18:49:03.689900 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:03.689900 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PATIENT_ID,
NVL(FIRST_NAME,'')||' '||NVL(LAST_NAME,'') AS PATIENT_NAME,
DATE_OF_BIRTH,
DATEDIFF('YEAR',DATE_OF_BIRTH,CURRENT_DATE()) AS AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.patient_t p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_patient)

)
SELECT 
SEQ_DIM_PATIENT.NEXTVAL AS ID,
PATIENT_ID,
PATIENT_NAME,
DATE_OF_BIRTH,
AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
MD5(
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_NAME::varchar, '') || '-' ||
COALESCE(DATE_OF_BIRTH::varchar, '') || '-' ||
COALESCE(AGE::varchar, '') || '-' ||
COALESCE(GENDER::varchar, '') || '-' ||
COALESCE(RACE::varchar, '') || '-' ||
COALESCE(ETHNICITY::varchar, '') || '-' ||
COALESCE(ADDRESS::varchar, '') || '-' ||
COALESCE(CITY::varchar, '') || '-' ||
COALESCE(STATE::varchar, '') || '-' ||
COALESCE(ZIP_CODE::varchar, '') || '-' ||
COALESCE(INSURANCE_TYPE::varchar, '') || '-' ||
COALESCE(PRIMARY_CARE_PROVIDER_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:49:03.689900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:49:05.434750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m18:49:05.450173 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:05.450173 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:49:05.622044 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.162 seconds
[0m18:49:05.622044 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:05.622044 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient
[0m18:49:05.840902 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.217 seconds
[0m18:49:05.856361 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:05.856361 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PATIENT"
[0m18:49:06.014275 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.156 seconds
[0m18:49:06.045527 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_patient"
[0m18:49:06.045527 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:06.045527 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
-- back compat for old kwarg name
  
  begin;
[0m18:49:06.233114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m18:49:06.233114 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:06.233114 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
merge into BHARATHDEV.tgt_dm.dim_patient as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_patient__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","PATIENT_NAME" = DBT_INTERNAL_SOURCE."PATIENT_NAME","DATE_OF_BIRTH" = DBT_INTERNAL_SOURCE."DATE_OF_BIRTH","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","RACE" = DBT_INTERNAL_SOURCE."RACE","ETHNICITY" = DBT_INTERNAL_SOURCE."ETHNICITY","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CODE" = DBT_INTERNAL_SOURCE."ZIP_CODE","INSURANCE_TYPE" = DBT_INTERNAL_SOURCE."INSURANCE_TYPE","PRIMARY_CARE_PROVIDER_ID" = DBT_INTERNAL_SOURCE."PRIMARY_CARE_PROVIDER_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:49:07.551738 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.316 seconds
[0m18:49:07.551738 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:07.551738 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
COMMIT
[0m18:49:07.984142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m18:49:08.000937 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:49:08.017622 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:08.017622 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
drop view if exists BHARATHDEV.tgt_dm.dim_patient__dbt_tmp cascade
[0m18:49:08.276561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m18:49:08.307580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51ef8063-2563-47fb-821f-75732fed2ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6331EE410>]}
[0m18:49:08.307580 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_patient ..................... [[32mSUCCESS 100000[0m in 4.71s]
[0m18:49:08.307580 [debug] [Thread-1 (]: Finished running node model.capston.dim_patient
[0m18:49:08.307580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:08.307580 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:49:08.307580 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:49:08.614874 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:49:08.614874 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:49:08.896041 [debug] [MainThread]: Connection 'model.capston.dim_patient' was left open.
[0m18:49:08.896041 [debug] [MainThread]: On model.capston.dim_patient: Close
[0m18:49:09.212311 [info ] [MainThread]: 
[0m18:49:09.212311 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.55 seconds (9.55s).
[0m18:49:09.212311 [debug] [MainThread]: Command end result
[0m18:49:09.255277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:49:09.268940 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:49:09.268940 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:49:09.268940 [info ] [MainThread]: 
[0m18:49:09.268940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:09.268940 [info ] [MainThread]: 
[0m18:49:09.283858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:49:09.286921 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:09.286921 after 12.16 seconds
[0m18:49:09.287888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62A38A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6309123D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B62A3CF090>]}
[0m18:49:09.288892 [debug] [MainThread]: Flushing usage events
[0m18:49:11.198848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:27.350023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B664093A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B664093450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B664093590>]}


============================== 18:49:27.350023 | b53327aa-8de9-4005-81bb-c4c8d4c76c5f ==============================
[0m18:49:27.350023 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:49:27.350023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_patient --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m18:49:27.991135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B664092CD0>]}
[0m18:49:28.069247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B664D8E390>]}
[0m18:49:28.069247 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:49:28.822349 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:49:29.087912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:49:29.087912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:49:29.087912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m18:49:29.165769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66411B790>]}
[0m18:49:29.277067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:49:29.292655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:49:29.339519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B666354810>]}
[0m18:49:29.339519 [info ] [MainThread]: Found 5 models, 4 data tests, 6 sources, 470 macros
[0m18:49:29.339519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6660EC2D0>]}
[0m18:49:29.339519 [info ] [MainThread]: 
[0m18:49:29.339519 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:49:29.349560 [info ] [MainThread]: 
[0m18:49:29.351557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:29.354986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:49:29.538877 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:49:29.538877 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:49:29.538877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:31.375993 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.839 seconds
[0m18:49:31.391613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:49:31.407241 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:49:31.407241 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:49:31.407241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:32.926116 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.529 seconds
[0m18:49:32.942418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B666185450>]}
[0m18:49:32.942418 [debug] [Thread-1 (]: Began running node model.capston.dim_patient
[0m18:49:32.942418 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_patient .......................... [RUN]
[0m18:49:32.942418 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_patient'
[0m18:49:32.942418 [debug] [Thread-1 (]: Began compiling node model.capston.dim_patient
[0m18:49:32.976123 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_patient"
[0m18:49:32.976123 [debug] [Thread-1 (]: Began executing node model.capston.dim_patient
[0m18:49:33.041387 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:33.041387 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PATIENT_ID,
NVL(FIRST_NAME,'')||' '||NVL(LAST_NAME,'') AS PATIENT_NAME,
DATE_OF_BIRTH,
DATEDIFF('YEAR',DATE_OF_BIRTH,CURRENT_DATE()) AS AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.patient_t p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_patient)

)
SELECT 
SEQ_DIM_PATIENT.NEXTVAL AS ID,
PATIENT_ID,
PATIENT_NAME,
DATE_OF_BIRTH,
AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
MD5(
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_NAME::varchar, '') || '-' ||
COALESCE(DATE_OF_BIRTH::varchar, '') || '-' ||
COALESCE(AGE::varchar, '') || '-' ||
COALESCE(GENDER::varchar, '') || '-' ||
COALESCE(RACE::varchar, '') || '-' ||
COALESCE(ETHNICITY::varchar, '') || '-' ||
COALESCE(ADDRESS::varchar, '') || '-' ||
COALESCE(CITY::varchar, '') || '-' ||
COALESCE(STATE::varchar, '') || '-' ||
COALESCE(ZIP_CODE::varchar, '') || '-' ||
COALESCE(INSURANCE_TYPE::varchar, '') || '-' ||
COALESCE(PRIMARY_CARE_PROVIDER_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:49:33.041387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:49:34.853034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.807 seconds
[0m18:49:34.853034 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:34.853034 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:49:35.040493 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.176 seconds
[0m18:49:35.040493 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:35.040493 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient
[0m18:49:35.213958 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.168 seconds
[0m18:49:35.229373 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:35.229373 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PATIENT"
[0m18:49:35.370135 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.141 seconds
[0m18:49:35.416831 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_patient"
[0m18:49:35.416831 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:35.416831 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
-- back compat for old kwarg name
  
  begin;
[0m18:49:35.615981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m18:49:35.616978 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:35.617977 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
merge into BHARATHDEV.tgt_dm.dim_patient as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_patient__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","PATIENT_NAME" = DBT_INTERNAL_SOURCE."PATIENT_NAME","DATE_OF_BIRTH" = DBT_INTERNAL_SOURCE."DATE_OF_BIRTH","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","RACE" = DBT_INTERNAL_SOURCE."RACE","ETHNICITY" = DBT_INTERNAL_SOURCE."ETHNICITY","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CODE" = DBT_INTERNAL_SOURCE."ZIP_CODE","INSURANCE_TYPE" = DBT_INTERNAL_SOURCE."INSURANCE_TYPE","PRIMARY_CARE_PROVIDER_ID" = DBT_INTERNAL_SOURCE."PRIMARY_CARE_PROVIDER_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:49:36.145079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.526 seconds
[0m18:49:36.146071 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:36.147074 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
COMMIT
[0m18:49:36.373019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m18:49:36.388473 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:49:36.388473 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:49:36.388473 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
drop view if exists BHARATHDEV.tgt_dm.dim_patient__dbt_tmp cascade
[0m18:49:36.718293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m18:49:36.749378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53327aa-8de9-4005-81bb-c4c8d4c76c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6669DB210>]}
[0m18:49:36.749378 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_patient ..................... [[32mSUCCESS 0[0m in 3.81s]
[0m18:49:36.749378 [debug] [Thread-1 (]: Finished running node model.capston.dim_patient
[0m18:49:36.749378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:36.749378 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:49:36.749378 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:49:37.547081 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:49:37.547081 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:49:37.860961 [debug] [MainThread]: Connection 'model.capston.dim_patient' was left open.
[0m18:49:37.860961 [debug] [MainThread]: On model.capston.dim_patient: Close
[0m18:49:38.300210 [info ] [MainThread]: 
[0m18:49:38.300210 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m18:49:38.300210 [debug] [MainThread]: Command end result
[0m18:49:38.352360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:49:38.352360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:49:38.368018 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:49:38.371333 [info ] [MainThread]: 
[0m18:49:38.371333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:38.371333 [info ] [MainThread]: 
[0m18:49:38.371333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:49:38.371333 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:38.371333 after 11.15 seconds
[0m18:49:38.371333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6640EB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B65DBFA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B663DC7F50>]}
[0m18:49:38.371333 [debug] [MainThread]: Flushing usage events
[0m18:49:40.007843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:15.785437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177444D2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177444D3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177444D3D90>]}


============================== 18:50:15.801061 | 50e996ca-21d6-4841-ac85-1a937967aa49 ==============================
[0m18:50:15.801061 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:50:15.801061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_patient --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:16.443185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177452A6FD0>]}
[0m18:50:16.505670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177451DE510>]}
[0m18:50:16.505670 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:50:17.273382 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:50:17.554571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:17.554571 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_patient.sql
[0m18:50:17.884307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:50:17.912614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177467E1010>]}
[0m18:50:18.024338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:50:18.039956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:50:18.118031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177440E2E90>]}
[0m18:50:18.118031 [info ] [MainThread]: Found 5 models, 4 data tests, 6 sources, 470 macros
[0m18:50:18.118031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774688DC50>]}
[0m18:50:18.118031 [info ] [MainThread]: 
[0m18:50:18.118031 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:50:18.134282 [info ] [MainThread]: 
[0m18:50:18.136276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:18.139799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:50:18.324387 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:50:18.324387 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:50:18.324387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:20.171549 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.844 seconds
[0m18:50:20.187171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:50:20.202827 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:50:20.202827 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:50:20.202827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:21.659725 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.453 seconds
[0m18:50:21.659725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774688DC50>]}
[0m18:50:21.659725 [debug] [Thread-1 (]: Began running node model.capston.dim_patient
[0m18:50:21.659725 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_patient .......................... [RUN]
[0m18:50:21.659725 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_patient'
[0m18:50:21.659725 [debug] [Thread-1 (]: Began compiling node model.capston.dim_patient
[0m18:50:21.675349 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_patient"
[0m18:50:21.675349 [debug] [Thread-1 (]: Began executing node model.capston.dim_patient
[0m18:50:21.757689 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:21.757689 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PATIENT_ID,
NVL(FIRST_NAME,'')||' '||NVL(LAST_NAME,'') AS PATIENT_NAME,
DATE_OF_BIRTH,
DATEDIFF('YEAR',DATE_OF_BIRTH,CURRENT_DATE()) AS AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.patient_t p

  where p.insert_date >= (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_patient)

)
SELECT 
SEQ_DIM_PATIENT.NEXTVAL AS ID,
PATIENT_ID,
PATIENT_NAME,
DATE_OF_BIRTH,
AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
MD5(
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_NAME::varchar, '') || '-' ||
COALESCE(DATE_OF_BIRTH::varchar, '') || '-' ||
COALESCE(AGE::varchar, '') || '-' ||
COALESCE(GENDER::varchar, '') || '-' ||
COALESCE(RACE::varchar, '') || '-' ||
COALESCE(ETHNICITY::varchar, '') || '-' ||
COALESCE(ADDRESS::varchar, '') || '-' ||
COALESCE(CITY::varchar, '') || '-' ||
COALESCE(STATE::varchar, '') || '-' ||
COALESCE(ZIP_CODE::varchar, '') || '-' ||
COALESCE(INSURANCE_TYPE::varchar, '') || '-' ||
COALESCE(PRIMARY_CARE_PROVIDER_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:50:21.757689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:23.836907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m18:50:23.852279 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:23.852279 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:50:24.055355 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.195 seconds
[0m18:50:24.055355 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:24.055355 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient
[0m18:50:24.230622 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.180 seconds
[0m18:50:24.246073 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:24.246073 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PATIENT"
[0m18:50:24.433693 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.184 seconds
[0m18:50:24.480401 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_patient"
[0m18:50:24.480401 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:24.480401 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
-- back compat for old kwarg name
  
  begin;
[0m18:50:24.699195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m18:50:24.699195 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:24.699195 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
merge into BHARATHDEV.tgt_dm.dim_patient as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_patient__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","PATIENT_NAME" = DBT_INTERNAL_SOURCE."PATIENT_NAME","DATE_OF_BIRTH" = DBT_INTERNAL_SOURCE."DATE_OF_BIRTH","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","RACE" = DBT_INTERNAL_SOURCE."RACE","ETHNICITY" = DBT_INTERNAL_SOURCE."ETHNICITY","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CODE" = DBT_INTERNAL_SOURCE."ZIP_CODE","INSURANCE_TYPE" = DBT_INTERNAL_SOURCE."INSURANCE_TYPE","PRIMARY_CARE_PROVIDER_ID" = DBT_INTERNAL_SOURCE."PRIMARY_CARE_PROVIDER_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:50:26.108357 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.409 seconds
[0m18:50:26.108357 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:26.108357 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
COMMIT
[0m18:50:26.720461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m18:50:26.741279 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:50:26.750855 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:26.750855 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
drop view if exists BHARATHDEV.tgt_dm.dim_patient__dbt_tmp cascade
[0m18:50:27.016627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m18:50:27.047703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50e996ca-21d6-4841-ac85-1a937967aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017745234590>]}
[0m18:50:27.047703 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_patient ..................... [[32mSUCCESS 100000[0m in 5.39s]
[0m18:50:27.047703 [debug] [Thread-1 (]: Finished running node model.capston.dim_patient
[0m18:50:27.047703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:27.047703 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:50:27.047703 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:50:27.377547 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:50:27.377547 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:50:27.674388 [debug] [MainThread]: Connection 'model.capston.dim_patient' was left open.
[0m18:50:27.674388 [debug] [MainThread]: On model.capston.dim_patient: Close
[0m18:50:28.019630 [info ] [MainThread]: 
[0m18:50:28.019630 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m18:50:28.019630 [debug] [MainThread]: Command end result
[0m18:50:28.082741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:50:28.086470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:50:28.102987 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:50:28.104982 [info ] [MainThread]: 
[0m18:50:28.105979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:28.107974 [info ] [MainThread]: 
[0m18:50:28.109968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:50:28.111963 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:28.111963 after 12.47 seconds
[0m18:50:28.112961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001773DFDA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177441DAE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001773E01F090>]}
[0m18:50:28.113958 [debug] [MainThread]: Flushing usage events
[0m18:50:30.079316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:48.089958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249325C1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249325C2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249325C2A10>]}


============================== 18:50:48.105583 | ed2190cc-7b60-48b6-8a3b-516350fe4434 ==============================
[0m18:50:48.105583 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:50:48.105583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_patient --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:48.747689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024933317910>]}
[0m18:50:48.825837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249319A9350>]}
[0m18:50:48.825837 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:50:49.592524 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:50:49.861106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:49.861106 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_patient.sql
[0m18:50:50.189805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m18:50:50.214779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249345B6ED0>]}
[0m18:50:50.324544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:50:50.340130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:50:50.418241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024934970590>]}
[0m18:50:50.418241 [info ] [MainThread]: Found 5 models, 4 data tests, 6 sources, 470 macros
[0m18:50:50.418241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249325B3A90>]}
[0m18:50:50.418241 [info ] [MainThread]: 
[0m18:50:50.433858 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:50:50.436200 [info ] [MainThread]: 
[0m18:50:50.438091 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:50.441553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:50:50.653400 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:50:50.655363 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:50:50.656360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:52.476369 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.823 seconds
[0m18:50:52.476369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:50:52.491791 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:50:52.491791 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:50:52.491791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:54.106011 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.610 seconds
[0m18:50:54.106011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002493002A510>]}
[0m18:50:54.121427 [debug] [Thread-1 (]: Began running node model.capston.dim_patient
[0m18:50:54.121427 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_patient .......................... [RUN]
[0m18:50:54.121427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_patient'
[0m18:50:54.121427 [debug] [Thread-1 (]: Began compiling node model.capston.dim_patient
[0m18:50:54.143626 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_patient"
[0m18:50:54.149203 [debug] [Thread-1 (]: Began executing node model.capston.dim_patient
[0m18:50:54.222599 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:54.222599 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PATIENT_ID,
NVL(FIRST_NAME,'')||' '||NVL(LAST_NAME,'') AS PATIENT_NAME,
DATE_OF_BIRTH,
DATEDIFF('YEAR',DATE_OF_BIRTH,CURRENT_DATE()) AS AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.patient_t p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_patient)

)
SELECT 
SEQ_DIM_PATIENT.NEXTVAL AS ID,
PATIENT_ID,
PATIENT_NAME,
DATE_OF_BIRTH,
AGE,
GENDER,
RACE,
ETHNICITY,
ADDRESS,
CITY,
STATE,
ZIP_CODE,
INSURANCE_TYPE,
PRIMARY_CARE_PROVIDER_ID,
MD5(
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(PATIENT_NAME::varchar, '') || '-' ||
COALESCE(DATE_OF_BIRTH::varchar, '') || '-' ||
COALESCE(AGE::varchar, '') || '-' ||
COALESCE(GENDER::varchar, '') || '-' ||
COALESCE(RACE::varchar, '') || '-' ||
COALESCE(ETHNICITY::varchar, '') || '-' ||
COALESCE(ADDRESS::varchar, '') || '-' ||
COALESCE(CITY::varchar, '') || '-' ||
COALESCE(STATE::varchar, '') || '-' ||
COALESCE(ZIP_CODE::varchar, '') || '-' ||
COALESCE(INSURANCE_TYPE::varchar, '') || '-' ||
COALESCE(PRIMARY_CARE_PROVIDER_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:50:54.222599 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:56.157779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.939 seconds
[0m18:50:56.173236 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:56.173236 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:50:56.357658 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.176 seconds
[0m18:50:56.357658 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:56.357658 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table BHARATHDEV.tgt_dm.dim_patient
[0m18:50:56.548951 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.183 seconds
[0m18:50:56.548951 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:56.548951 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PATIENT"
[0m18:50:56.736575 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.177 seconds
[0m18:50:56.767617 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_patient"
[0m18:50:56.767617 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:56.767617 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
-- back compat for old kwarg name
  
  begin;
[0m18:50:56.970887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m18:50:56.986313 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:56.986313 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
merge into BHARATHDEV.tgt_dm.dim_patient as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_patient__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","PATIENT_NAME" = DBT_INTERNAL_SOURCE."PATIENT_NAME","DATE_OF_BIRTH" = DBT_INTERNAL_SOURCE."DATE_OF_BIRTH","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","RACE" = DBT_INTERNAL_SOURCE."RACE","ETHNICITY" = DBT_INTERNAL_SOURCE."ETHNICITY","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CODE" = DBT_INTERNAL_SOURCE."ZIP_CODE","INSURANCE_TYPE" = DBT_INTERNAL_SOURCE."INSURANCE_TYPE","PRIMARY_CARE_PROVIDER_ID" = DBT_INTERNAL_SOURCE."PRIMARY_CARE_PROVIDER_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PATIENT_ID", "PATIENT_NAME", "DATE_OF_BIRTH", "AGE", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:50:57.755193 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.781 seconds
[0m18:50:57.770615 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:57.770615 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
COMMIT
[0m18:50:57.973910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m18:50:57.989313 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_patient__dbt_tmp
[0m18:50:58.004968 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_patient"
[0m18:50:58.004968 [debug] [Thread-1 (]: On model.capston.dim_patient: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_patient"} */
drop view if exists BHARATHDEV.tgt_dm.dim_patient__dbt_tmp cascade
[0m18:50:58.319347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m18:50:58.350391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed2190cc-7b60-48b6-8a3b-516350fe4434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024934EECB90>]}
[0m18:50:58.350391 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_patient ..................... [[32mSUCCESS 0[0m in 4.23s]
[0m18:50:58.350391 [debug] [Thread-1 (]: Finished running node model.capston.dim_patient
[0m18:50:58.350391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:58.366006 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:50:58.366006 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:50:58.680207 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:50:58.680207 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:50:58.961218 [debug] [MainThread]: Connection 'model.capston.dim_patient' was left open.
[0m18:50:58.961218 [debug] [MainThread]: On model.capston.dim_patient: Close
[0m18:50:59.244251 [info ] [MainThread]: 
[0m18:50:59.244251 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m18:50:59.244251 [debug] [MainThread]: Command end result
[0m18:50:59.283966 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:50:59.300707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:50:59.300707 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:50:59.300707 [info ] [MainThread]: 
[0m18:50:59.300707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:59.300707 [info ] [MainThread]: 
[0m18:50:59.300707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:50:59.317181 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:59.317181 after 11.34 seconds
[0m18:50:59.317181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249323EEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002492C03A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024932618E10>]}
[0m18:50:59.317181 [debug] [MainThread]: Flushing usage events
[0m18:51:01.922237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:15.329772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD93FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD93C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD93F190>]}


============================== 18:53:15.345396 | d2d52f10-72a4-447e-b9e9-e5a7c3bda531 ==============================
[0m18:53:15.345396 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:53:15.345396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_pharmacy --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:53:15.971917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD474F90>]}
[0m18:53:16.050024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACE64E510>]}
[0m18:53:16.050024 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:53:16.817687 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:53:17.083254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:53:17.083254 [debug] [MainThread]: Partial parsing: added file: capston://models\dim\dim_pharmacy.sql
[0m18:53:17.413014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:53:17.439618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACFB95E10>]}
[0m18:53:17.553410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:53:17.569030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:53:17.647104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACFCA6CD0>]}
[0m18:53:17.647104 [info ] [MainThread]: Found 6 models, 4 data tests, 6 sources, 470 macros
[0m18:53:17.647104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACFD483D0>]}
[0m18:53:17.662757 [info ] [MainThread]: 
[0m18:53:17.662757 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:53:17.662757 [info ] [MainThread]: 
[0m18:53:17.668196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:17.671963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:53:17.867589 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:53:17.867589 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:53:17.867589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:19.730873 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.853 seconds
[0m18:53:19.730873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:53:19.746330 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:53:19.746330 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:53:19.746330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:21.358564 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.614 seconds
[0m18:53:21.374215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACFBF8710>]}
[0m18:53:21.374215 [debug] [Thread-1 (]: Began running node model.capston.dim_pharmacy
[0m18:53:21.374215 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_pharmacy ......................... [RUN]
[0m18:53:21.374215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_pharmacy'
[0m18:53:21.374215 [debug] [Thread-1 (]: Began compiling node model.capston.dim_pharmacy
[0m18:53:21.400323 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_pharmacy"
[0m18:53:21.404739 [debug] [Thread-1 (]: Began executing node model.capston.dim_pharmacy
[0m18:53:21.488475 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:21.489437 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PRESCRIPTION_ID,
PATIENT_ID,
MEDICATION_CODE,
FILL_DATE,
DAYS_SUPPLY,
QUANTITY,
PHARMACY_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.pharmacy p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_pharmacy)
 
)
SELECT 
SEQ_DIM_PHARMACY.NEXTVAL AS ID,
PRESCRIPTION_ID,
PATIENT_ID,
MEDICATION_CODE,
FILL_DATE,
DAYS_SUPPLY,
QUANTITY,
PHARMACY_ID,
MD5(
COALESCE(PRESCRIPTION_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(DAYS_SUPPLY::varchar, '') || '-' ||
COALESCE(QUANTITY::varchar, '') || '-' ||
COALESCE(PHARMACY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:53:21.490437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:23.283713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.797 seconds
[0m18:53:23.300154 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:23.300154 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
[0m18:53:23.495216 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.181 seconds
[0m18:53:23.504491 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:23.506487 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table BHARATHDEV.tgt_dm.dim_pharmacy
[0m18:53:23.701177 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.194 seconds
[0m18:53:23.719631 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:23.721591 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PHARMACY"
[0m18:53:23.913537 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.190 seconds
[0m18:53:23.965215 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_pharmacy"
[0m18:53:23.970206 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:23.971202 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m18:53:24.214554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m18:53:24.216034 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:24.218032 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
merge into BHARATHDEV.tgt_dm.dim_pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","PHARMACY_ID" = DBT_INTERNAL_SOURCE."PHARMACY_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:53:24.845953 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.626 seconds
[0m18:53:24.847625 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:24.848627 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
COMMIT
[0m18:53:25.137439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m18:53:25.164113 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
[0m18:53:25.183698 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:25.185692 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp cascade
[0m18:53:25.447413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m18:53:25.463396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d52f10-72a4-447e-b9e9-e5a7c3bda531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAD02B9B90>]}
[0m18:53:25.463396 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_pharmacy .................... [[32mSUCCESS 10[0m in 4.09s]
[0m18:53:25.479790 [debug] [Thread-1 (]: Finished running node model.capston.dim_pharmacy
[0m18:53:25.479790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:25.479790 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:53:25.479790 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:53:25.762999 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:53:25.762999 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:53:26.087557 [debug] [MainThread]: Connection 'model.capston.dim_pharmacy' was left open.
[0m18:53:26.088555 [debug] [MainThread]: On model.capston.dim_pharmacy: Close
[0m18:53:26.450343 [info ] [MainThread]: 
[0m18:53:26.450343 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m18:53:26.450343 [debug] [MainThread]: Command end result
[0m18:53:26.496981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:53:26.497539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:53:26.511581 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:53:26.512619 [info ] [MainThread]: 
[0m18:53:26.514961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:26.515502 [info ] [MainThread]: 
[0m18:53:26.516877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:26.519367 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:26.519367 after 11.30 seconds
[0m18:53:26.520364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC742A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD9ADE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BACD9AE3D0>]}
[0m18:53:26.521362 [debug] [MainThread]: Flushing usage events
[0m18:53:28.065708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:48.835249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E0A7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E0D5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E0A7290>]}


============================== 18:53:48.835249 | b8f6e6de-e856-411a-afad-64f0897f8210 ==============================
[0m18:53:48.835249 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:53:48.835249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_pharmacy --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:53:49.476334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E0B2F50>]}
[0m18:53:49.554442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004EDAE150>]}
[0m18:53:49.554442 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:53:50.323226 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:53:50.604405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:50.604405 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_pharmacy.sql
[0m18:53:50.918494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:53:50.949739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004FE54850>]}
[0m18:53:51.067587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:53:51.083210 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:53:51.174017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020050421350>]}
[0m18:53:51.175014 [info ] [MainThread]: Found 6 models, 4 data tests, 6 sources, 470 macros
[0m18:53:51.176174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200503B4410>]}
[0m18:53:51.179203 [info ] [MainThread]: 
[0m18:53:51.180168 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:53:51.182162 [info ] [MainThread]: 
[0m18:53:51.183894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:51.186773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:53:51.365712 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:53:51.365712 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:53:51.365712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:53.065552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.696 seconds
[0m18:53:53.080999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:53:53.080999 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:53:53.096593 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:53:53.096593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:54.584793 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.494 seconds
[0m18:53:54.584793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004ED39650>]}
[0m18:53:54.600216 [debug] [Thread-1 (]: Began running node model.capston.dim_pharmacy
[0m18:53:54.600216 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_pharmacy ......................... [RUN]
[0m18:53:54.600216 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_pharmacy'
[0m18:53:54.600216 [debug] [Thread-1 (]: Began compiling node model.capston.dim_pharmacy
[0m18:53:54.615881 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_pharmacy"
[0m18:53:54.620312 [debug] [Thread-1 (]: Began executing node model.capston.dim_pharmacy
[0m18:53:54.683627 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:54.683627 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT PRESCRIPTION_ID,
PATIENT_ID,
MEDICATION_CODE,
FILL_DATE,
DAYS_SUPPLY,
QUANTITY,
PHARMACY_ID,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.pharmacy p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_pharmacy)
 
)
SELECT 
SEQ_DIM_PHARMACY.NEXTVAL AS ID,
PRESCRIPTION_ID,
PATIENT_ID,
MEDICATION_CODE,
FILL_DATE,
DAYS_SUPPLY,
QUANTITY,
PHARMACY_ID,
MD5(
COALESCE(PRESCRIPTION_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(MEDICATION_CODE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(DAYS_SUPPLY::varchar, '') || '-' ||
COALESCE(QUANTITY::varchar, '') || '-' ||
COALESCE(PHARMACY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:53:54.683627 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:56.370266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.678 seconds
[0m18:53:56.370266 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:56.370266 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
[0m18:53:56.558238 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.179 seconds
[0m18:53:56.558238 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:56.558238 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table BHARATHDEV.tgt_dm.dim_pharmacy
[0m18:53:56.714458 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.152 seconds
[0m18:53:56.730074 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:56.730074 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_PHARMACY"
[0m18:53:56.901914 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.174 seconds
[0m18:53:56.948772 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_pharmacy"
[0m18:53:56.964396 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:56.964396 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m18:53:57.153536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m18:53:57.153536 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:57.153536 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
merge into BHARATHDEV.tgt_dm.dim_pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","PHARMACY_ID" = DBT_INTERNAL_SOURCE."PHARMACY_ID","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:53:57.936417 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.779 seconds
[0m18:53:57.936417 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:57.936417 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
COMMIT
[0m18:53:58.580534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m18:53:58.603510 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp
[0m18:53:58.611119 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_pharmacy"
[0m18:53:58.611119 [debug] [Thread-1 (]: On model.capston.dim_pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm.dim_pharmacy__dbt_tmp cascade
[0m18:53:59.222204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m18:53:59.237828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f6e6de-e856-411a-afad-64f0897f8210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020050AB5610>]}
[0m18:53:59.237828 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_pharmacy .................... [[32mSUCCESS 0[0m in 4.64s]
[0m18:53:59.237828 [debug] [Thread-1 (]: Finished running node model.capston.dim_pharmacy
[0m18:53:59.253446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:59.253446 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:53:59.253446 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:53:59.547696 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:53:59.547696 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:53:59.879189 [debug] [MainThread]: Connection 'model.capston.dim_pharmacy' was left open.
[0m18:53:59.879189 [debug] [MainThread]: On model.capston.dim_pharmacy: Close
[0m18:54:00.144707 [info ] [MainThread]: 
[0m18:54:00.144707 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m18:54:00.144707 [debug] [MainThread]: Command end result
[0m18:54:00.194800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:54:00.199573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:54:00.211660 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:54:00.211660 [info ] [MainThread]: 
[0m18:54:00.211660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:00.211660 [info ] [MainThread]: 
[0m18:54:00.211660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:54:00.211660 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:00.211660 after 11.50 seconds
[0m18:54:00.211660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020047BBA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004DECA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020047BFF090>]}
[0m18:54:00.211660 [debug] [MainThread]: Flushing usage events
[0m18:54:01.822778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:02.989511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EE44D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EE44C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EE44E590>]}


============================== 18:57:02.996788 | 3256bfd5-5ad9-4fcb-981f-32af762e0ae5 ==============================
[0m18:57:02.996788 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:02.998749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_care_gaps', 'send_anonymous_usage_stats': 'True'}
[0m18:57:03.650014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3256bfd5-5ad9-4fcb-981f-32af762e0ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F314ABD0>]}
[0m18:57:03.731677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3256bfd5-5ad9-4fcb-981f-32af762e0ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F0749350>]}
[0m18:57:03.733676 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:57:04.504302 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:57:04.640158 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:57:04.642275 [debug] [MainThread]: previous checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, current checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105
[0m18:57:04.643273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3256bfd5-5ad9-4fcb-981f-32af762e0ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F0777510>]}
[0m18:57:06.299488 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var("source_database") }}: Required var 'source_database' not found in config:
  Vars supplied to <Configuration> = {}
[0m18:57:06.302848 [debug] [MainThread]: Command `dbt run` failed at 18:57:06.302848 after 3.56 seconds
[0m18:57:06.303970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F1363CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EAEEC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F1372090>]}
[0m18:57:06.304968 [debug] [MainThread]: Flushing usage events
[0m18:57:08.164491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:24.910482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CD922ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CD922390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CD923D90>]}


============================== 18:57:24.917616 | 5a69a8f6-b031-4cad-9445-621b27351f00 ==============================
[0m18:57:24.917616 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:24.919578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_care_gaps --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:25.584514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CD4AA790>]}
[0m18:57:25.657402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CCD09510>]}
[0m18:57:25.660544 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:57:26.431042 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:57:26.714987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:57:26.715985 [debug] [MainThread]: Partial parsing: added file: capston://models\dim\dim_care_gaps.sql
[0m18:57:27.049200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:57:27.085031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CFC712D0>]}
[0m18:57:27.234840 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:57:27.241981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:57:27.330396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CB50BDD0>]}
[0m18:57:27.332519 [info ] [MainThread]: Found 7 models, 4 data tests, 6 sources, 470 macros
[0m18:57:27.333517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CFCC4050>]}
[0m18:57:27.336510 [info ] [MainThread]: 
[0m18:57:27.338649 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:57:27.340643 [info ] [MainThread]: 
[0m18:57:27.342637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:27.346626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:57:27.602272 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:57:27.603269 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:57:27.604267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:29.614747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.010 seconds
[0m18:57:29.623852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:57:29.636252 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:57:29.637251 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:57:29.638350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:30.987421 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.349 seconds
[0m18:57:30.992526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CFCDC3D0>]}
[0m18:57:30.995506 [debug] [Thread-1 (]: Began running node model.capston.dim_care_gaps
[0m18:57:30.996639 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_care_gaps ........................ [RUN]
[0m18:57:30.999105 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_care_gaps'
[0m18:57:31.000101 [debug] [Thread-1 (]: Began compiling node model.capston.dim_care_gaps
[0m18:57:31.012449 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_care_gaps"
[0m18:57:31.016627 [debug] [Thread-1 (]: Began executing node model.capston.dim_care_gaps
[0m18:57:31.092362 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:31.093362 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.care_gaps p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_care_gaps)
 
)
SELECT SEQ_DIM_CARE_GAPS.NEXTVAL AS ID,
GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
MD5(
COALESCE(GAP_ID::varchar, '') ||  '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(GAP_TYPE::varchar, '') || '-' ||
COALESCE(IDENTIFIED_DATE::varchar, '') || '-' ||
COALESCE(STATUS::varchar, '') || '-' || 
COALESCE(RECOMMENDED_ACTION::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE, 
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:57:31.094359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:32.775557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.681 seconds
[0m18:57:32.786761 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:32.787886 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m18:57:32.967877 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.180 seconds
[0m18:57:32.975140 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:32.976139 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps
[0m18:57:33.127885 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.152 seconds
[0m18:57:33.138132 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:33.139097 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CARE_GAPS"
[0m18:57:33.325683 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.186 seconds
[0m18:57:33.361708 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_care_gaps"
[0m18:57:33.365789 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:33.366788 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
-- back compat for old kwarg name
  
  begin;
[0m18:57:33.567708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m18:57:33.568705 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:33.569702 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
merge into BHARATHDEV.tgt_dm.dim_care_gaps as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.gap_id = DBT_INTERNAL_DEST.gap_id
                )

    
    when matched then update set
        "GAP_ID" = DBT_INTERNAL_SOURCE."GAP_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","GAP_TYPE" = DBT_INTERNAL_SOURCE."GAP_TYPE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RECOMMENDED_ACTION" = DBT_INTERNAL_SOURCE."RECOMMENDED_ACTION","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:57:35.110697 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.540 seconds
[0m18:57:35.111694 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:35.112690 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
COMMIT
[0m18:57:35.430172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m18:57:35.440481 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m18:57:35.450727 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:35.451693 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
drop view if exists BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp cascade
[0m18:57:35.703483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m18:57:35.736459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a69a8f6-b031-4cad-9445-621b27351f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CFB7DED0>]}
[0m18:57:35.737459 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_care_gaps ................... [[32mSUCCESS 100000[0m in 4.74s]
[0m18:57:35.740582 [debug] [Thread-1 (]: Finished running node model.capston.dim_care_gaps
[0m18:57:35.743576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:35.744574 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:57:35.745715 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:57:36.037018 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:57:36.038017 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:57:36.355754 [debug] [MainThread]: Connection 'model.capston.dim_care_gaps' was left open.
[0m18:57:36.356751 [debug] [MainThread]: On model.capston.dim_care_gaps: Close
[0m18:57:36.623575 [info ] [MainThread]: 
[0m18:57:36.624291 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m18:57:36.626289 [debug] [MainThread]: Command end result
[0m18:57:36.740018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:57:36.746999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:57:36.791026 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:57:36.792024 [info ] [MainThread]: 
[0m18:57:36.794154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:36.796151 [info ] [MainThread]: 
[0m18:57:36.798145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:36.801276 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:36.801276 after 12.02 seconds
[0m18:57:36.803269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C738A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C73CF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C73D8210>]}
[0m18:57:36.805265 [debug] [MainThread]: Flushing usage events
[0m18:57:38.872272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:45.269232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0DA0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0DA2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0DA3910>]}


============================== 18:57:45.276394 | 5fd3b024-9c6f-47c7-ab34-28245f82e096 ==============================
[0m18:57:45.276394 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:45.278482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_care_gaps --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:45.950209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F1BFF090>]}
[0m18:57:46.024254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F1AAE550>]}
[0m18:57:46.027213 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:57:46.791957 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:57:47.070567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:47.071664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:47.078813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m18:57:47.147175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F2EA65D0>]}
[0m18:57:47.271623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:57:47.278757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:57:47.319080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F3078110>]}
[0m18:57:47.320197 [info ] [MainThread]: Found 7 models, 4 data tests, 6 sources, 470 macros
[0m18:57:47.321196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0DFAA10>]}
[0m18:57:47.324187 [info ] [MainThread]: 
[0m18:57:47.325293 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:57:47.327271 [info ] [MainThread]: 
[0m18:57:47.329269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:47.332262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:57:47.534315 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:57:47.535309 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:57:47.536308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:49.329165 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.793 seconds
[0m18:57:49.338361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:57:49.350677 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:57:49.351678 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:57:49.352676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:50.847094 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.495 seconds
[0m18:57:50.852220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F1BDA910>]}
[0m18:57:50.856278 [debug] [Thread-1 (]: Began running node model.capston.dim_care_gaps
[0m18:57:50.857277 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_care_gaps ........................ [RUN]
[0m18:57:50.858953 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_care_gaps'
[0m18:57:50.859949 [debug] [Thread-1 (]: Began compiling node model.capston.dim_care_gaps
[0m18:57:50.877622 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_care_gaps"
[0m18:57:50.880614 [debug] [Thread-1 (]: Began executing node model.capston.dim_care_gaps
[0m18:57:50.948623 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:50.949621 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.care_gaps p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_care_gaps)
 
)
SELECT SEQ_DIM_CARE_GAPS.NEXTVAL AS ID,
GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
MD5(
COALESCE(GAP_ID::varchar, '') ||  '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(GAP_TYPE::varchar, '') || '-' ||
COALESCE(IDENTIFIED_DATE::varchar, '') || '-' ||
COALESCE(STATUS::varchar, '') || '-' || 
COALESCE(RECOMMENDED_ACTION::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE, 
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m18:57:50.950620 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:52.626740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.676 seconds
[0m18:57:52.637095 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:52.638094 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m18:57:52.808278 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.169 seconds
[0m18:57:52.813384 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:52.814350 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps
[0m18:57:52.969420 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.154 seconds
[0m18:57:52.979653 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:52.980624 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CARE_GAPS"
[0m18:57:53.159553 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.178 seconds
[0m18:57:53.199760 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_care_gaps"
[0m18:57:53.203883 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:53.204880 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
-- back compat for old kwarg name
  
  begin;
[0m18:57:53.385363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m18:57:53.386364 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:53.387359 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
merge into BHARATHDEV.tgt_dm.dim_care_gaps as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.gap_id = DBT_INTERNAL_DEST.gap_id
                )

    
    when matched then update set
        "GAP_ID" = DBT_INTERNAL_SOURCE."GAP_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","GAP_TYPE" = DBT_INTERNAL_SOURCE."GAP_TYPE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RECOMMENDED_ACTION" = DBT_INTERNAL_SOURCE."RECOMMENDED_ACTION","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:57:53.907300 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.519 seconds
[0m18:57:53.908378 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:53.909414 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
COMMIT
[0m18:57:54.156704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m18:57:54.168775 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m18:57:54.178472 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m18:57:54.179472 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
drop view if exists BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp cascade
[0m18:57:54.470622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m18:57:54.497862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd3b024-9c6f-47c7-ab34-28245f82e096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F3643790>]}
[0m18:57:54.498966 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_care_gaps ................... [[32mSUCCESS 0[0m in 3.64s]
[0m18:57:54.500847 [debug] [Thread-1 (]: Finished running node model.capston.dim_care_gaps
[0m18:57:54.502843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:54.504000 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:57:54.504999 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:57:54.819911 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:57:54.820868 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:57:55.142235 [debug] [MainThread]: Connection 'model.capston.dim_care_gaps' was left open.
[0m18:57:55.142235 [debug] [MainThread]: On model.capston.dim_care_gaps: Close
[0m18:57:55.428687 [info ] [MainThread]: 
[0m18:57:55.429806 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m18:57:55.431837 [debug] [MainThread]: Command end result
[0m18:57:55.480179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:57:55.486306 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:57:55.494587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:57:55.496551 [info ] [MainThread]: 
[0m18:57:55.498546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:55.499543 [info ] [MainThread]: 
[0m18:57:55.501540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:55.504529 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:55.503533 after 10.36 seconds
[0m18:57:55.505527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0E1A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176EA8EA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176F0BCA950>]}
[0m18:57:55.507521 [debug] [MainThread]: Flushing usage events
[0m18:57:58.078406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:58.237871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D05C53750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D05C53710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D05C53290>]}


============================== 17:53:58.382933 | 8270599f-e309-444f-973c-cea59fc07622 ==============================
[0m17:53:58.382933 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:53:58.391385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_care_gaps --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:08.698451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D06A9F310>]}
[0m17:54:08.841981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0694A210>]}
[0m17:54:08.841981 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:54:10.514631 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m17:54:12.343065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:54:12.362199 [debug] [MainThread]: Partial parsing: added file: capston://models\Fact\patient_events_care_gaps_fact.sql
[0m17:54:13.076684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m17:54:13.097431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D07DC5990>]}
[0m17:54:13.260595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:54:13.416716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:54:13.933524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D08064110>]}
[0m17:54:13.945531 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m17:54:13.949129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D07F37150>]}
[0m17:54:13.949129 [info ] [MainThread]: 
[0m17:54:13.963498 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:54:13.970618 [info ] [MainThread]: 
[0m17:54:13.977762 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:13.994543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m17:54:15.972659 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m17:54:15.981435 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m17:54:15.984587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:21.700272 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 5.724 seconds
[0m17:54:21.737453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m17:54:21.783779 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m17:54:21.783779 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m17:54:21.788129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:24.350581 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.564 seconds
[0m17:54:24.362609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D07C71650>]}
[0m17:54:24.454665 [debug] [Thread-1 (]: Began running node model.capston.dim_care_gaps
[0m17:54:24.457104 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_care_gaps ........................ [RUN]
[0m17:54:24.463277 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_care_gaps'
[0m17:54:24.463277 [debug] [Thread-1 (]: Began compiling node model.capston.dim_care_gaps
[0m17:54:24.547095 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_care_gaps"
[0m17:54:24.567076 [debug] [Thread-1 (]: Began executing node model.capston.dim_care_gaps
[0m17:54:24.764804 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:24.764804 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.care_gaps p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_care_gaps)
 
)
SELECT SEQ_DIM_CARE_GAPS.NEXTVAL AS ID,
GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
MD5(
COALESCE(GAP_ID::varchar, '') ||  '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(GAP_TYPE::varchar, '') || '-' ||
COALESCE(IDENTIFIED_DATE::varchar, '') || '-' ||
COALESCE(STATUS::varchar, '') || '-' || 
COALESCE(RECOMMENDED_ACTION::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE, 
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m17:54:24.769815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:27.426398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.659 seconds
[0m17:54:27.493762 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:27.496219 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m17:54:27.835479 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.338 seconds
[0m17:54:27.843882 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:27.850388 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps
[0m17:54:28.038742 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.189 seconds
[0m17:54:28.062359 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:28.062359 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CARE_GAPS"
[0m17:54:28.244497 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.176 seconds
[0m17:54:28.326210 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_care_gaps"
[0m17:54:28.334831 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:28.334831 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:28.549763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m17:54:28.557672 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:28.560867 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
merge into BHARATHDEV.tgt_dm.dim_care_gaps as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.gap_id = DBT_INTERNAL_DEST.gap_id
                )

    
    when matched then update set
        "GAP_ID" = DBT_INTERNAL_SOURCE."GAP_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","GAP_TYPE" = DBT_INTERNAL_SOURCE."GAP_TYPE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RECOMMENDED_ACTION" = DBT_INTERNAL_SOURCE."RECOMMENDED_ACTION","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m17:54:30.599703 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 2.036 seconds
[0m17:54:30.603201 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:30.608121 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
COMMIT
[0m17:54:30.851674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m17:54:30.889642 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m17:54:30.906862 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m17:54:30.906862 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
drop view if exists BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp cascade
[0m17:54:31.215341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m17:54:31.283197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8270599f-e309-444f-973c-cea59fc07622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D069A4290>]}
[0m17:54:31.283197 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_care_gaps ................... [[32mSUCCESS 0[0m in 6.81s]
[0m17:54:31.291979 [debug] [Thread-1 (]: Finished running node model.capston.dim_care_gaps
[0m17:54:31.296739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:31.298642 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m17:54:31.300477 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m17:54:32.043881 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m17:54:32.047208 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m17:54:32.444244 [debug] [MainThread]: Connection 'model.capston.dim_care_gaps' was left open.
[0m17:54:32.444244 [debug] [MainThread]: On model.capston.dim_care_gaps: Close
[0m17:54:32.854871 [info ] [MainThread]: 
[0m17:54:32.860157 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 18.88 seconds (18.88s).
[0m17:54:32.866643 [debug] [MainThread]: Command end result
[0m17:54:33.030453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:54:33.047914 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:54:33.078877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m17:54:33.082781 [info ] [MainThread]: 
[0m17:54:33.087903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:33.091121 [info ] [MainThread]: 
[0m17:54:33.094389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:54:33.104274 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:33.103282 after 35.53 seconds
[0m17:54:33.108323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D05CCA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D7F74A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D05987E10>]}
[0m17:54:33.111843 [debug] [MainThread]: Flushing usage events
[0m17:54:35.412705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:03.746262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E473C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E470310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E473890>]}


============================== 17:55:04.801839 | 255f9481-67c8-4feb-bb31-1b5b7c612d6c ==============================
[0m17:55:04.801839 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:55:04.808309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_claim_provider --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m17:55:06.055170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E4FDAD0>]}
[0m17:55:06.196369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1F171E10>]}
[0m17:55:06.196369 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:55:07.919704 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m17:55:08.350343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:08.362182 [debug] [MainThread]: Partial parsing: updated file: capston://models\dim\dim_claim_provider.sql
[0m17:55:08.868314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m17:55:08.890253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB205D7CD0>]}
[0m17:55:09.033997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:55:09.043375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:55:09.152860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2050BBD0>]}
[0m17:55:09.155406 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m17:55:09.157828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2060BA90>]}
[0m17:55:09.161079 [info ] [MainThread]: 
[0m17:55:09.165639 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:55:09.168396 [info ] [MainThread]: 
[0m17:55:09.170685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:09.178106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m17:55:09.484230 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m17:55:09.484230 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m17:55:09.496183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:12.789583 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.299 seconds
[0m17:55:12.826245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m17:55:12.864434 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m17:55:12.864434 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m17:55:12.876731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:15.247356 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.373 seconds
[0m17:55:15.254004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1B6FAD10>]}
[0m17:55:15.278336 [debug] [Thread-1 (]: Began running node model.capston.dim_claim_provider
[0m17:55:15.281571 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_claim_provider ................... [RUN]
[0m17:55:15.289128 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_claim_provider'
[0m17:55:15.289128 [debug] [Thread-1 (]: Began compiling node model.capston.dim_claim_provider
[0m17:55:15.334989 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_claim_provider"
[0m17:55:15.361463 [debug] [Thread-1 (]: Began executing node model.capston.dim_claim_provider
[0m17:55:15.547262 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:15.547262 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
P.PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
LEAST(C.INSERT_DATE,P.INSERT_DATE) AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.claims C 
JOIN BHARATHDEV.src_data.provider P ON C.PROVIDER_ID = P.PROVIDER_ID 
where LEAST(C.INSERT_DATE,P.INSERT_DATE) > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)
)
SELECT SEQ_DIM_CLAIM_PROVIDER.NEXTVAL AS ID,
CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
MD5(
COALESCE(CLAIM_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(SERVICE_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_AMOUNT::varchar, '') || '-' ||
COALESCE(CLAIM_STATUS::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODES::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODES::varchar, '') || '-' ||
COALESCE(PROVIDER_NAME::varchar, '') || '-' ||
COALESCE(SPECIALTY::varchar, '') || '-' ||
COALESCE(NPI_NUMBER::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY,
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m17:55:15.560795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:17.992781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.433 seconds
[0m17:55:18.043087 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:18.043087 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m17:55:18.324175 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.274 seconds
[0m17:55:18.356395 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:18.364464 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider
[0m17:55:18.605107 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.239 seconds
[0m17:55:18.631153 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:18.631153 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CLAIM_PROVIDER"
[0m17:55:18.801679 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.168 seconds
[0m17:55:18.855811 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_claim_provider"
[0m17:55:18.862918 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:18.864959 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
-- back compat for old kwarg name
  
  begin;
[0m17:55:19.141514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m17:55:19.141514 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:19.155663 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
merge into BHARATHDEV.tgt_dm.dim_claim_provider as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.CLAIM_ID = DBT_INTERNAL_DEST.CLAIM_ID
                ) and (
                    DBT_INTERNAL_SOURCE.PROVIDER_ID = DBT_INTERNAL_DEST.PROVIDER_ID
                )

    
    when matched then update set
        "CLAIM_ID" = DBT_INTERNAL_SOURCE."CLAIM_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","SERVICE_DATE" = DBT_INTERNAL_SOURCE."SERVICE_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","CLAIM_AMOUNT" = DBT_INTERNAL_SOURCE."CLAIM_AMOUNT","CLAIM_STATUS" = DBT_INTERNAL_SOURCE."CLAIM_STATUS","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","DIAGNOSIS_CODES" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODES","PROCEDURE_CODES" = DBT_INTERNAL_SOURCE."PROCEDURE_CODES","PROVIDER_NAME" = DBT_INTERNAL_SOURCE."PROVIDER_NAME","SPECIALTY" = DBT_INTERNAL_SOURCE."SPECIALTY","NPI_NUMBER" = DBT_INTERNAL_SOURCE."NPI_NUMBER","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m17:55:20.373623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.210 seconds
[0m17:55:20.380351 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:20.383776 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
COMMIT
[0m17:55:20.622727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m17:55:20.680137 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m17:55:20.714573 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m17:55:20.722904 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
drop view if exists BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp cascade
[0m17:55:20.979119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m17:55:21.087998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '255f9481-67c8-4feb-bb31-1b5b7c612d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB20D8E490>]}
[0m17:55:21.096011 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_claim_provider .............. [[32mSUCCESS 0[0m in 5.80s]
[0m17:55:21.102647 [debug] [Thread-1 (]: Finished running node model.capston.dim_claim_provider
[0m17:55:21.106941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:21.108872 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m17:55:21.110290 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m17:55:21.495579 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m17:55:21.498853 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m17:55:22.020613 [debug] [MainThread]: Connection 'model.capston.dim_claim_provider' was left open.
[0m17:55:22.025086 [debug] [MainThread]: On model.capston.dim_claim_provider: Close
[0m17:55:22.421515 [info ] [MainThread]: 
[0m17:55:22.430199 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.25 seconds (13.25s).
[0m17:55:22.435426 [debug] [MainThread]: Command end result
[0m17:55:22.758266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:55:22.772216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:55:22.795183 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m17:55:22.801377 [info ] [MainThread]: 
[0m17:55:22.804751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:22.807010 [info ] [MainThread]: 
[0m17:55:22.809897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:22.812209 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:22.812209 after 19.33 seconds
[0m17:55:22.813934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E1A7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB17F3A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB1E4EA0D0>]}
[0m17:55:22.816029 [debug] [MainThread]: Flushing usage events
[0m17:55:24.807007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:16.697016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A1503950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A1548090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A1503890>]}


============================== 17:58:16.697016 | ab3e1d19-9df4-43f9-8d46-544807ff62ea ==============================
[0m17:58:16.697016 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:58:16.707289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s patient_events_care_gaps --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m17:58:17.642435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab3e1d19-9df4-43f9-8d46-544807ff62ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A098FBD0>]}
[0m17:58:17.802163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab3e1d19-9df4-43f9-8d46-544807ff62ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A08E9290>]}
[0m17:58:17.802163 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:58:19.166803 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m17:58:19.605486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:19.606515 [debug] [MainThread]: Partial parsing: updated file: capston://models\Fact\patient_events_care_gaps_fact.sql
[0m17:58:20.249428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m17:58:20.296314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab3e1d19-9df4-43f9-8d46-544807ff62ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A3720490>]}
[0m17:58:20.527300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:58:20.547496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:58:20.656869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab3e1d19-9df4-43f9-8d46-544807ff62ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A3561410>]}
[0m17:58:20.659196 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m17:58:20.662513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab3e1d19-9df4-43f9-8d46-544807ff62ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A38440D0>]}
[0m17:58:20.664461 [warn ] [MainThread]: The selection criterion 'patient_events_care_gaps' does not match any enabled nodes
[0m17:58:20.671495 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:58:20.674134 [debug] [MainThread]: Command end result
[0m17:58:20.764482 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m17:58:20.773164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m17:58:20.775791 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m17:58:20.780132 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:20.780132 after 4.22 seconds
[0m17:58:20.782830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B0DA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B11F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B1281D0>]}
[0m17:58:20.783831 [debug] [MainThread]: Flushing usage events
[0m17:58:23.662926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:53.297027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76A0030D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76A000350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76A003E50>]}


============================== 18:03:53.299790 | efd97189-df54-44d7-982c-e9893a92bc8d ==============================
[0m18:03:53.299790 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:03:53.313139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s patient_events_care_gaps_fact --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:03:54.895348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7675841D0>]}
[0m18:03:55.044825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76AD0E350>]}
[0m18:03:55.051601 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:03:56.344417 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:03:56.812063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:56.825325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:56.827363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:03:56.895590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C1AC650>]}
[0m18:03:57.083710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:03:57.098413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:03:57.186175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C05B610>]}
[0m18:03:57.188330 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m18:03:57.191575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76BFFB4D0>]}
[0m18:03:57.194232 [info ] [MainThread]: 
[0m18:03:57.198240 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:03:57.202315 [info ] [MainThread]: 
[0m18:03:57.204516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:57.213099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:03:57.445757 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:03:57.445757 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:03:57.460551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:59.760789 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.303 seconds
[0m18:03:59.785329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:03:59.807911 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:03:59.807911 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:03:59.822580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:01.691025 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.871 seconds
[0m18:04:01.696563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C0E16D0>]}
[0m18:04:01.714701 [debug] [Thread-1 (]: Began running node model.capston.patient_events_care_gaps_fact
[0m18:04:01.717053 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.patient_events_care_gaps_fact ........ [RUN]
[0m18:04:01.722036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.patient_events_care_gaps_fact'
[0m18:04:01.724503 [debug] [Thread-1 (]: Began compiling node model.capston.patient_events_care_gaps_fact
[0m18:04:01.775504 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.patient_events_care_gaps_fact"
[0m18:04:01.796109 [debug] [Thread-1 (]: Began executing node model.capston.patient_events_care_gaps_fact
[0m18:04:01.955691 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.patient_events_care_gaps_fact"
[0m18:04:01.968553 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:04:01.974597 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
create or replace transient table BHARATHDEV.tgt_dm.patient_events_care_gaps_fact
         as
        (

WITH BASE AS ( 
SELECT  PT.PATIENT_ID,
PH.PHARMACY_ID,
PROV.PROVIDER_ID,
CG.GAP_ID ,
CD.CLAIM_ID,
ME.EVENT_ID,
ME.EVENT_DATE,
CD.CLAIM_DATE,
PH.FILL_DATE,
CG.IDENTIFIED_DATE,
LEAST(PT.INSERT_DATE,ME.INSERT_DATE,CD.INSERT_DATE,PROV.INSERT_DATE,CG.INSERT_DATE) AS BASE_ADD_DATE
 FROM BHARATHDEV.src_data.patient_t PT 
 JOIN BHARATHDEV.src_data.medical_events ME ON PT.PATIENT_ID = ME.PATIENT_ID
 JOIN BHARATHDEV.src_data.claims CD ON PT.PATIENT_ID = CD.PATIENT_ID 
 JOIN BHARATHDEV.src_data.provider PROV ON PROV.PROVIDER_ID = CD.PROVIDER_ID
 JOIN BHARATHDEV.src_data.care_gaps CG ON CG.PATIENT_ID = PT.PATIENT_ID 
 left JOIN BHARATHDEV.src_data.pharmacy PH ON PT.PATIENT_ID = PH.PATIENT_ID 
 
)

, SOURCE AS (
SELECT P.ID AS DIM_PATIENT_KEY,
CPR.ID AS DIM_CLAIM_PROVIDER_KEY,
ME.ID AS DIM_MEDICAL_EVENTS_KEY,
CG.ID AS DIM_CARE_GAPS_KEY,
PH.ID AS DIM_PHARMACY_KEY,
S.EVENT_DATE,
S.CLAIM_DATE,
S.FILL_DATE,
S.IDENTIFIED_DATE,
S.BASE_ADD_DATE
FROM BASE S 
JOIN BHARATHDEV.tgt_dm.dim_patient P ON S.PATIENT_ID = P.PATIENT_ID
JOIN BHARATHDEV.tgt_dm.dim_claim_provider CPR ON S.PROVIDER_ID = CPR.PROVIDER_ID AND S.CLAIM_ID = CPR.CLAIM_ID 
JOIN BHARATHDEV.tgt_dm.dim_medical_events ME ON S.EVENT_ID = ME.EVENT_ID
JOIN BHARATHDEV.tgt_dm.dim_care_gaps CG ON S.GAP_ID = CG.GAP_ID
LEFT JOIN BHARATHDEV.tgt_dm.dim_pharmacy PH ON S.PHARMACY_ID = PH.PHARMACY_ID
)
SELECT SEQ_PATIENT_EVENTS_CARE_GAPS.NEXTVAL AS ID,
DIM_PATIENT_KEY,
DIM_CLAIM_PROVIDER_KEY,
DIM_MEDICAL_EVENTS_KEY,
DIM_CARE_GAPS_KEY,
DIM_PHARMACY_KEY,
EVENT_DATE,
CLAIM_DATE,
FILL_DATE,
IDENTIFIED_DATE,
MD5(
COALESCE(DIM_PATIENT_KEY::varchar, '') || '-' ||
COALESCE(DIM_CLAIM_PROVIDER_KEY::varchar, '') || '-' ||
COALESCE(DIM_MEDICAL_EVENTS_KEY::varchar, '') || '-' ||
COALESCE(DIM_CARE_GAPS_KEY::varchar, '') || '-' ||
COALESCE(DIM_PHARMACY_KEY::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '') 
) AS HASH_KEY,
BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM SOURCE
        );
[0m18:04:01.977124 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:08.142587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.165 seconds
[0m18:04:08.184782 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
[0m18:04:08.214117 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:04:08.214117 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
drop view if exists BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp cascade
[0m18:04:08.444849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m18:04:08.557861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efd97189-df54-44d7-982c-e9893a92bc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C887190>]}
[0m18:04:08.560106 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.patient_events_care_gaps_fact ... [[32mSUCCESS 1[0m in 6.82s]
[0m18:04:08.567275 [debug] [Thread-1 (]: Finished running node model.capston.patient_events_care_gaps_fact
[0m18:04:08.573688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:08.576646 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:04:08.579352 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:04:09.165905 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:04:09.170818 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:04:09.570750 [debug] [MainThread]: Connection 'model.capston.patient_events_care_gaps_fact' was left open.
[0m18:04:09.570750 [debug] [MainThread]: On model.capston.patient_events_care_gaps_fact: Close
[0m18:04:09.983435 [info ] [MainThread]: 
[0m18:04:09.990422 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.78 seconds (12.78s).
[0m18:04:09.997915 [debug] [MainThread]: Command end result
[0m18:04:10.194434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:04:10.203963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:04:10.220751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:04:10.222047 [info ] [MainThread]: 
[0m18:04:10.224042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:10.225040 [info ] [MainThread]: 
[0m18:04:10.227678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:04:10.231696 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:10.230854 after 17.09 seconds
[0m18:04:10.233158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F763B7A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F769D37FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F763BBF050>]}
[0m18:04:10.234155 [debug] [MainThread]: Flushing usage events
[0m18:04:12.120956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:25.503473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC543510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC543250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC542CD0>]}


============================== 18:07:25.513658 | 8ee9836c-839a-4ff6-837e-22bed89aedc4 ==============================
[0m18:07:25.513658 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:07:25.519296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s patient_events_care_gaps_fact --vars {source_database : BHARATHDEV}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:26.487429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC44E610>]}
[0m18:07:26.585210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8ED24E450>]}
[0m18:07:26.588480 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:07:27.727879 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:07:28.122245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:28.137439 [debug] [MainThread]: Partial parsing: updated file: capston://models\Fact\patient_events_care_gaps_fact.sql
[0m18:07:28.591927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m18:07:28.621070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8ED2E8B90>]}
[0m18:07:28.795890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:07:28.813347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:07:29.014386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EE5B0A10>]}
[0m18:07:29.016299 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m18:07:29.018449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EE897B50>]}
[0m18:07:29.021804 [info ] [MainThread]: 
[0m18:07:29.025287 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:07:29.028205 [info ] [MainThread]: 
[0m18:07:29.029587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:07:29.035214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:07:29.396424 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:07:29.396424 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:07:29.411858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:32.221887 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.814 seconds
[0m18:07:32.251357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:07:32.284103 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:07:32.552434 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:07:32.552434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:34.887340 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.331 seconds
[0m18:07:34.893516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EE544F10>]}
[0m18:07:34.927044 [debug] [Thread-1 (]: Began running node model.capston.patient_events_care_gaps_fact
[0m18:07:34.930508 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.patient_events_care_gaps_fact ........ [RUN]
[0m18:07:34.936620 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.patient_events_care_gaps_fact'
[0m18:07:34.936620 [debug] [Thread-1 (]: Began compiling node model.capston.patient_events_care_gaps_fact
[0m18:07:35.001043 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.patient_events_care_gaps_fact"
[0m18:07:35.019080 [debug] [Thread-1 (]: Began executing node model.capston.patient_events_care_gaps_fact
[0m18:07:35.130833 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:35.130833 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
create or replace  temporary view BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
  
   as (
    

WITH BASE AS ( 
SELECT  PT.PATIENT_ID,
PH.PHARMACY_ID,
PROV.PROVIDER_ID,
CG.GAP_ID ,
CD.CLAIM_ID,
ME.EVENT_ID,
ME.EVENT_DATE::datetime as EVENT_DATE,
CD.CLAIM_DATE::datetime as CLAIM_DATE,
PH.FILL_DATE::datetime as FILL_DATE,
CG.IDENTIFIED_DATE::datetime as IDENTIFIED_DATE,
LEAST(PT.INSERT_DATE,ME.INSERT_DATE,CD.INSERT_DATE,PROV.INSERT_DATE,CG.INSERT_DATE) AS BASE_ADD_DATE
 FROM BHARATHDEV.src_data.patient_t PT 
 JOIN BHARATHDEV.src_data.medical_events ME ON PT.PATIENT_ID = ME.PATIENT_ID
 JOIN BHARATHDEV.src_data.claims CD ON PT.PATIENT_ID = CD.PATIENT_ID 
 JOIN BHARATHDEV.src_data.provider PROV ON PROV.PROVIDER_ID = CD.PROVIDER_ID
 JOIN BHARATHDEV.src_data.care_gaps CG ON CG.PATIENT_ID = PT.PATIENT_ID 
 left JOIN BHARATHDEV.src_data.pharmacy PH ON PT.PATIENT_ID = PH.PATIENT_ID 
 
  where LEAST(PT.INSERT_DATE,ME.INSERT_DATE,CD.INSERT_DATE,PROV.INSERT_DATE,CG.INSERT_DATE)  > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.patient_events_care_gaps_fact)

)

, SOURCE AS (
SELECT P.ID AS DIM_PATIENT_KEY,
CPR.ID AS DIM_CLAIM_PROVIDER_KEY,
ME.ID AS DIM_MEDICAL_EVENTS_KEY,
CG.ID AS DIM_CARE_GAPS_KEY,
PH.ID AS DIM_PHARMACY_KEY,
S.EVENT_DATE,
S.CLAIM_DATE,
S.FILL_DATE,
S.IDENTIFIED_DATE,
S.BASE_ADD_DATE
FROM BASE S 
JOIN BHARATHDEV.tgt_dm.dim_patient P ON S.PATIENT_ID = P.PATIENT_ID
JOIN BHARATHDEV.tgt_dm.dim_claim_provider CPR ON S.PROVIDER_ID = CPR.PROVIDER_ID AND S.CLAIM_ID = CPR.CLAIM_ID 
JOIN BHARATHDEV.tgt_dm.dim_medical_events ME ON S.EVENT_ID = ME.EVENT_ID
JOIN BHARATHDEV.tgt_dm.dim_care_gaps CG ON S.GAP_ID = CG.GAP_ID
LEFT JOIN BHARATHDEV.tgt_dm.dim_pharmacy PH ON S.PHARMACY_ID = PH.PHARMACY_ID
)
SELECT SEQ_PATIENT_EVENTS_CARE_GAPS.NEXTVAL AS ID,
DIM_PATIENT_KEY,
DIM_CLAIM_PROVIDER_KEY,
DIM_MEDICAL_EVENTS_KEY,
DIM_CARE_GAPS_KEY,
DIM_PHARMACY_KEY,
EVENT_DATE,
CLAIM_DATE,
FILL_DATE,
IDENTIFIED_DATE,
MD5(
COALESCE(DIM_PATIENT_KEY::varchar, '') || '-' ||
COALESCE(DIM_CLAIM_PROVIDER_KEY::varchar, '') || '-' ||
COALESCE(DIM_MEDICAL_EVENTS_KEY::varchar, '') || '-' ||
COALESCE(DIM_CARE_GAPS_KEY::varchar, '') || '-' ||
COALESCE(DIM_PHARMACY_KEY::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '') 
) AS HASH_KEY,
BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM SOURCE
  );
[0m18:07:35.134717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:38.166476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.032 seconds
[0m18:07:38.319513 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:38.319513 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
[0m18:07:38.676425 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.352 seconds
[0m18:07:38.706964 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:38.706964 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table BHARATHDEV.tgt_dm.patient_events_care_gaps_fact
[0m18:07:39.084645 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.365 seconds
[0m18:07:39.128024 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:39.145472 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table "BHARATHDEV"."TGT_DM"."PATIENT_EVENTS_CARE_GAPS_FACT"
[0m18:07:39.493829 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.349 seconds
[0m18:07:39.611793 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.patient_events_care_gaps_fact"
[0m18:07:39.632212 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:39.632212 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m18:07:39.826111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m18:07:39.826111 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:39.826111 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
merge into BHARATHDEV.tgt_dm.patient_events_care_gaps_fact as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.DIM_PATIENT_KEY = DBT_INTERNAL_DEST.DIM_PATIENT_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_CLAIM_PROVIDER_KEY = DBT_INTERNAL_DEST.DIM_CLAIM_PROVIDER_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_MEDICAL_EVENTS_KEY = DBT_INTERNAL_DEST.DIM_MEDICAL_EVENTS_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_CARE_GAPS_KEY = DBT_INTERNAL_DEST.DIM_CARE_GAPS_KEY
                )

    
    when matched then update set
        "DIM_PATIENT_KEY" = DBT_INTERNAL_SOURCE."DIM_PATIENT_KEY","DIM_CLAIM_PROVIDER_KEY" = DBT_INTERNAL_SOURCE."DIM_CLAIM_PROVIDER_KEY","DIM_MEDICAL_EVENTS_KEY" = DBT_INTERNAL_SOURCE."DIM_MEDICAL_EVENTS_KEY","DIM_CARE_GAPS_KEY" = DBT_INTERNAL_SOURCE."DIM_CARE_GAPS_KEY","DIM_PHARMACY_KEY" = DBT_INTERNAL_SOURCE."DIM_PHARMACY_KEY","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "DIM_PATIENT_KEY", "DIM_CLAIM_PROVIDER_KEY", "DIM_MEDICAL_EVENTS_KEY", "DIM_CARE_GAPS_KEY", "DIM_PHARMACY_KEY", "EVENT_DATE", "CLAIM_DATE", "FILL_DATE", "IDENTIFIED_DATE", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "DIM_PATIENT_KEY", "DIM_CLAIM_PROVIDER_KEY", "DIM_MEDICAL_EVENTS_KEY", "DIM_CARE_GAPS_KEY", "DIM_PHARMACY_KEY", "EVENT_DATE", "CLAIM_DATE", "FILL_DATE", "IDENTIFIED_DATE", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:07:42.155688 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 2.315 seconds
[0m18:07:42.164770 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:42.168803 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
COMMIT
[0m18:07:42.390299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m18:07:42.424351 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
[0m18:07:42.456918 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:07:42.456918 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
drop view if exists BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp cascade
[0m18:07:42.739652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m18:07:42.823082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee9836c-839a-4ff6-837e-22bed89aedc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8ED2A4590>]}
[0m18:07:42.823082 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.patient_events_care_gaps_fact ... [[32mSUCCESS 0[0m in 7.89s]
[0m18:07:42.841727 [debug] [Thread-1 (]: Finished running node model.capston.patient_events_care_gaps_fact
[0m18:07:42.848914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:42.850727 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:07:42.852380 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:07:43.282680 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:07:43.289246 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:07:43.691821 [debug] [MainThread]: Connection 'model.capston.patient_events_care_gaps_fact' was left open.
[0m18:07:43.691821 [debug] [MainThread]: On model.capston.patient_events_care_gaps_fact: Close
[0m18:07:44.207422 [info ] [MainThread]: 
[0m18:07:44.213803 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.18 seconds (15.18s).
[0m18:07:44.223404 [debug] [MainThread]: Command end result
[0m18:07:44.433800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:07:44.451082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:07:44.479657 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:07:44.490802 [info ] [MainThread]: 
[0m18:07:44.495683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:44.501175 [info ] [MainThread]: 
[0m18:07:44.507422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:07:44.520898 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:44.520898 after 19.18 seconds
[0m18:07:44.531981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8E60BC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC36A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8EC273E10>]}
[0m18:07:44.541545 [debug] [MainThread]: Flushing usage events
[0m18:07:47.277506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:08.391312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC3863610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC3863550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC3863390>]}


============================== 18:10:08.404479 | a604dedd-be6f-400f-a52d-3ff0a8e5fbb4 ==============================
[0m18:10:08.404479 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:10:08.411015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s patient_events_care_gaps_fact --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:11.490944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC368E310>]}
[0m18:10:11.616371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC2C49150>]}
[0m18:10:11.619111 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:10:12.707070 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:10:13.337929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:13.340895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:13.370536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:10:13.635630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC58C1850>]}
[0m18:10:13.965424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:10:13.981609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:10:14.082094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC58AA5D0>]}
[0m18:10:14.083971 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 470 macros
[0m18:10:14.086161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC59FCCD0>]}
[0m18:10:14.088953 [info ] [MainThread]: 
[0m18:10:14.092994 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:10:14.094990 [info ] [MainThread]: 
[0m18:10:14.097875 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:14.102444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:10:14.467920 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:10:14.478375 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:10:14.481156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:18.029118 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.548 seconds
[0m18:10:18.063073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:10:18.114816 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:10:18.119054 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:10:18.121959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:20.158480 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.039 seconds
[0m18:10:20.182659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC59CBF50>]}
[0m18:10:20.193640 [debug] [Thread-1 (]: Began running node model.capston.patient_events_care_gaps_fact
[0m18:10:20.199038 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.patient_events_care_gaps_fact ........ [RUN]
[0m18:10:20.206492 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.patient_events_care_gaps_fact'
[0m18:10:20.209610 [debug] [Thread-1 (]: Began compiling node model.capston.patient_events_care_gaps_fact
[0m18:10:20.290903 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.patient_events_care_gaps_fact"
[0m18:10:20.301517 [debug] [Thread-1 (]: Began executing node model.capston.patient_events_care_gaps_fact
[0m18:10:20.496390 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:20.496390 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
create or replace  temporary view BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
  
   as (
    

WITH BASE AS ( 
SELECT  PT.PATIENT_ID,
PH.PHARMACY_ID,
PROV.PROVIDER_ID,
CG.GAP_ID ,
CD.CLAIM_ID,
ME.EVENT_ID,
ME.EVENT_DATE::datetime as EVENT_DATE,
CD.CLAIM_DATE::datetime as CLAIM_DATE,
PH.FILL_DATE::datetime as FILL_DATE,
CG.IDENTIFIED_DATE::datetime as IDENTIFIED_DATE,
LEAST(PT.INSERT_DATE,ME.INSERT_DATE,CD.INSERT_DATE,PROV.INSERT_DATE,CG.INSERT_DATE) AS BASE_ADD_DATE
 FROM BHARATHDEV.src_data.patient_t PT 
 JOIN BHARATHDEV.src_data.medical_events ME ON PT.PATIENT_ID = ME.PATIENT_ID
 JOIN BHARATHDEV.src_data.claims CD ON PT.PATIENT_ID = CD.PATIENT_ID 
 JOIN BHARATHDEV.src_data.provider PROV ON PROV.PROVIDER_ID = CD.PROVIDER_ID
 JOIN BHARATHDEV.src_data.care_gaps CG ON CG.PATIENT_ID = PT.PATIENT_ID 
 left JOIN BHARATHDEV.src_data.pharmacy PH ON PT.PATIENT_ID = PH.PATIENT_ID 
 
  where LEAST(PT.INSERT_DATE,ME.INSERT_DATE,CD.INSERT_DATE,PROV.INSERT_DATE,CG.INSERT_DATE)  > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.patient_events_care_gaps_fact)

)

, SOURCE AS (
SELECT P.ID AS DIM_PATIENT_KEY,
CPR.ID AS DIM_CLAIM_PROVIDER_KEY,
ME.ID AS DIM_MEDICAL_EVENTS_KEY,
CG.ID AS DIM_CARE_GAPS_KEY,
PH.ID AS DIM_PHARMACY_KEY,
S.EVENT_DATE,
S.CLAIM_DATE,
S.FILL_DATE,
S.IDENTIFIED_DATE,
S.BASE_ADD_DATE
FROM BASE S 
JOIN BHARATHDEV.tgt_dm.dim_patient P ON S.PATIENT_ID = P.PATIENT_ID
JOIN BHARATHDEV.tgt_dm.dim_claim_provider CPR ON S.PROVIDER_ID = CPR.PROVIDER_ID AND S.CLAIM_ID = CPR.CLAIM_ID 
JOIN BHARATHDEV.tgt_dm.dim_medical_events ME ON S.EVENT_ID = ME.EVENT_ID
JOIN BHARATHDEV.tgt_dm.dim_care_gaps CG ON S.GAP_ID = CG.GAP_ID
LEFT JOIN BHARATHDEV.tgt_dm.dim_pharmacy PH ON S.PHARMACY_ID = PH.PHARMACY_ID
)
SELECT SEQ_PATIENT_EVENTS_CARE_GAPS.NEXTVAL AS ID,
DIM_PATIENT_KEY,
DIM_CLAIM_PROVIDER_KEY,
DIM_MEDICAL_EVENTS_KEY,
DIM_CARE_GAPS_KEY,
DIM_PHARMACY_KEY,
EVENT_DATE,
CLAIM_DATE,
FILL_DATE,
IDENTIFIED_DATE,
MD5(
COALESCE(DIM_PATIENT_KEY::varchar, '') || '-' ||
COALESCE(DIM_CLAIM_PROVIDER_KEY::varchar, '') || '-' ||
COALESCE(DIM_MEDICAL_EVENTS_KEY::varchar, '') || '-' ||
COALESCE(DIM_CARE_GAPS_KEY::varchar, '') || '-' ||
COALESCE(DIM_PHARMACY_KEY::varchar, '') || '-' ||
COALESCE(EVENT_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(FILL_DATE::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '') 
) AS HASH_KEY,
BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM SOURCE
  );
[0m18:10:20.503694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:22.822236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.319 seconds
[0m18:10:22.842502 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:22.860321 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
[0m18:10:23.059311 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.196 seconds
[0m18:10:23.077047 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:23.077047 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table BHARATHDEV.tgt_dm.patient_events_care_gaps_fact
[0m18:10:23.641549 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.558 seconds
[0m18:10:23.654485 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:23.654485 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
describe table "BHARATHDEV"."TGT_DM"."PATIENT_EVENTS_CARE_GAPS_FACT"
[0m18:10:23.845268 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.182 seconds
[0m18:10:23.944861 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.patient_events_care_gaps_fact"
[0m18:10:23.954122 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:23.954122 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m18:10:24.151907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m18:10:24.151907 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:24.151907 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
merge into BHARATHDEV.tgt_dm.patient_events_care_gaps_fact as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.DIM_PATIENT_KEY = DBT_INTERNAL_DEST.DIM_PATIENT_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_CLAIM_PROVIDER_KEY = DBT_INTERNAL_DEST.DIM_CLAIM_PROVIDER_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_MEDICAL_EVENTS_KEY = DBT_INTERNAL_DEST.DIM_MEDICAL_EVENTS_KEY
                ) and (
                    DBT_INTERNAL_SOURCE.DIM_CARE_GAPS_KEY = DBT_INTERNAL_DEST.DIM_CARE_GAPS_KEY
                )

    
    when matched then update set
        "DIM_PATIENT_KEY" = DBT_INTERNAL_SOURCE."DIM_PATIENT_KEY","DIM_CLAIM_PROVIDER_KEY" = DBT_INTERNAL_SOURCE."DIM_CLAIM_PROVIDER_KEY","DIM_MEDICAL_EVENTS_KEY" = DBT_INTERNAL_SOURCE."DIM_MEDICAL_EVENTS_KEY","DIM_CARE_GAPS_KEY" = DBT_INTERNAL_SOURCE."DIM_CARE_GAPS_KEY","DIM_PHARMACY_KEY" = DBT_INTERNAL_SOURCE."DIM_PHARMACY_KEY","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "DIM_PATIENT_KEY", "DIM_CLAIM_PROVIDER_KEY", "DIM_MEDICAL_EVENTS_KEY", "DIM_CARE_GAPS_KEY", "DIM_PHARMACY_KEY", "EVENT_DATE", "CLAIM_DATE", "FILL_DATE", "IDENTIFIED_DATE", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "DIM_PATIENT_KEY", "DIM_CLAIM_PROVIDER_KEY", "DIM_MEDICAL_EVENTS_KEY", "DIM_CARE_GAPS_KEY", "DIM_PHARMACY_KEY", "EVENT_DATE", "CLAIM_DATE", "FILL_DATE", "IDENTIFIED_DATE", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m18:10:26.510068 [debug] [Thread-1 (]: SQL status: SUCCESS 100057 in 2.354 seconds
[0m18:10:26.513200 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:26.516246 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
COMMIT
[0m18:10:26.787658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m18:10:26.809116 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp
[0m18:10:26.833948 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_events_care_gaps_fact"
[0m18:10:26.850880 [debug] [Thread-1 (]: On model.capston.patient_events_care_gaps_fact: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_events_care_gaps_fact"} */
drop view if exists BHARATHDEV.tgt_dm.patient_events_care_gaps_fact__dbt_tmp cascade
[0m18:10:27.102037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m18:10:27.188905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a604dedd-be6f-400f-a52d-3ff0a8e5fbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC5645D90>]}
[0m18:10:27.188905 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.patient_events_care_gaps_fact ... [[32mSUCCESS 100057[0m in 6.98s]
[0m18:10:27.198978 [debug] [Thread-1 (]: Finished running node model.capston.patient_events_care_gaps_fact
[0m18:10:27.202345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:27.204323 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:10:27.206027 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:10:27.737877 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:10:27.737877 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:10:28.557746 [debug] [MainThread]: Connection 'model.capston.patient_events_care_gaps_fact' was left open.
[0m18:10:28.561023 [debug] [MainThread]: On model.capston.patient_events_care_gaps_fact: Close
[0m18:10:28.967276 [info ] [MainThread]: 
[0m18:10:28.970338 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 14.87 seconds (14.87s).
[0m18:10:28.974660 [debug] [MainThread]: Command end result
[0m18:10:29.066081 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:10:29.072476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:10:29.083259 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:10:29.086617 [info ] [MainThread]: 
[0m18:10:29.087614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:29.089241 [info ] [MainThread]: 
[0m18:10:29.090720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:10:29.095081 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:29.094081 after 21.09 seconds
[0m18:10:29.096638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC38A03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FC3597F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBD48F050>]}
[0m18:10:29.098094 [debug] [MainThread]: Flushing usage events
[0m18:10:31.622979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:05.649740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FE93690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FE93710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FE93DD0>]}


============================== 18:37:05.650742 | d1e4ad83-da8a-455c-9a42-5c9c02d98779 ==============================
[0m18:37:05.650742 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:37:05.666269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s care_gaps --vars {source_database : BHARATHDEV}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:37:06.766051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FEC0D50>]}
[0m18:37:06.915192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024810B8E510>]}
[0m18:37:06.918817 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:37:08.080297 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m18:37:08.562605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 1 files changed.
[0m18:37:08.562605 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\provider.sql
[0m18:37:08.580030 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\pharmacy.sql
[0m18:37:08.582027 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\care_gaps.sql
[0m18:37:08.585043 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\claims.sql
[0m18:37:08.587071 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\patient_t.sql
[0m18:37:08.588624 [debug] [MainThread]: Partial parsing: added file: capston://models\stage\medical_events.sql
[0m18:37:08.590127 [debug] [MainThread]: Partial parsing: updated file: capston://models\example\sources.yml
[0m18:37:09.406258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m18:37:09.438047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024811CAE810>]}
[0m18:37:09.742616 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:37:09.752942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:37:09.826270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481222F890>]}
[0m18:37:09.828904 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m18:37:09.831900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024812271F50>]}
[0m18:37:09.834485 [info ] [MainThread]: 
[0m18:37:09.838638 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:37:09.841563 [info ] [MainThread]: 
[0m18:37:09.845390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:09.852472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m18:37:10.162343 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m18:37:10.178028 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m18:37:10.179116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:12.863376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.687 seconds
[0m18:37:12.886668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m18:37:12.923932 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m18:37:12.926289 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m18:37:12.928488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:14.781941 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.853 seconds
[0m18:37:14.797965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024812161550>]}
[0m18:37:14.808578 [debug] [Thread-1 (]: Began running node model.capston.care_gaps
[0m18:37:14.810984 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.care_gaps ............................ [RUN]
[0m18:37:14.815094 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.care_gaps'
[0m18:37:14.817756 [debug] [Thread-1 (]: Began compiling node model.capston.care_gaps
[0m18:37:14.868419 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.care_gaps"
[0m18:37:14.880833 [debug] [Thread-1 (]: Began executing node model.capston.care_gaps
[0m18:37:15.060300 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.care_gaps"
[0m18:37:15.068004 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m18:37:15.069924 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
create or replace transient table BHARATHDEV.tgt_dm.care_gaps
         as
        (
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY gap_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_care_gaps 
)
SELECT a.gap_id,
a.patient_id,
a.gap_type,
a.identified_date,
a.status,
a.recommended_action,
a.insert_date
FROM SRC A WHERE A.RNK = 1
        );
[0m18:37:15.071113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:20.647692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.577 seconds
[0m18:37:20.668676 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.care_gaps__dbt_tmp
[0m18:37:20.702111 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m18:37:20.702111 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
drop view if exists BHARATHDEV.tgt_dm.care_gaps__dbt_tmp cascade
[0m18:37:21.056020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m18:37:21.102987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e4ad83-da8a-455c-9a42-5c9c02d98779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481217D0D0>]}
[0m18:37:21.117124 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.care_gaps ....................... [[32mSUCCESS 1[0m in 6.29s]
[0m18:37:21.120196 [debug] [Thread-1 (]: Finished running node model.capston.care_gaps
[0m18:37:21.125283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:21.127548 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m18:37:21.129153 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m18:37:21.879399 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m18:37:21.883030 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m18:37:22.287897 [debug] [MainThread]: Connection 'model.capston.care_gaps' was left open.
[0m18:37:22.298908 [debug] [MainThread]: On model.capston.care_gaps: Close
[0m18:37:22.797579 [info ] [MainThread]: 
[0m18:37:22.802917 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m18:37:22.810679 [debug] [MainThread]: Command end result
[0m18:37:22.938937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m18:37:22.954251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m18:37:22.956894 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m18:37:22.972335 [info ] [MainThread]: 
[0m18:37:22.974483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:22.976843 [info ] [MainThread]: 
[0m18:37:22.979418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:37:22.982740 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:22.982740 after 17.71 seconds
[0m18:37:22.982740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480990A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FE93CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002480FE90810>]}
[0m18:37:22.989131 [debug] [MainThread]: Flushing usage events
[0m18:37:25.248018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:02.327151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD01143D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7FEFE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7FEFEED0>]}


============================== 19:22:02.330194 | c24adeab-095d-4828-9a81-8697b7d780f6 ==============================
[0m19:22:02.330194 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:22:02.344384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:03.296375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD02EE3DD0>]}
[0m19:22:03.428846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD02F71890>]}
[0m19:22:03.444002 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:22:04.421041 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m19:22:04.793292 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:22:04.798216 [debug] [MainThread]: Partial parsing: added file: capston://models\sources.yml
[0m19:22:05.579296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.tgt_dm.dim
[0m19:22:05.600203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0345AC90>]}
[0m19:22:05.738437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m19:22:05.746464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m19:22:05.789486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD034DA6D0>]}
[0m19:22:05.790484 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m19:22:05.791481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD034D1ED0>]}
[0m19:22:05.793916 [info ] [MainThread]: 
[0m19:22:05.795440 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:22:05.797980 [info ] [MainThread]: 
[0m19:22:05.799068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:05.802063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m19:22:06.091333 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m19:22:06.091333 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m19:22:06.099905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:08.889602 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.790 seconds
[0m19:22:08.923196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m19:22:08.956527 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m19:22:08.963078 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m19:22:08.964075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:11.323356 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.358 seconds
[0m19:22:11.346529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0356B310>]}
[0m19:22:11.355471 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m19:22:11.357850 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.pharmacy ............................. [RUN]
[0m19:22:11.363190 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m19:22:11.363190 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m19:22:11.418913 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m19:22:11.430446 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m19:22:11.635744 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m19:22:11.645003 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:22:11.645003 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace transient table BHARATHDEV.tgt_dm.pharmacy
         as
        (
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
        );
[0m19:22:11.649964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:14.903542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.254 seconds
[0m19:22:14.927097 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
[0m19:22:14.944659 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:22:14.962395 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm.pharmacy__dbt_tmp cascade
[0m19:22:15.184767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m19:22:15.239143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24adeab-095d-4828-9a81-8697b7d780f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03BBB4D0>]}
[0m19:22:15.248045 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.pharmacy ........................ [[32mSUCCESS 1[0m in 3.88s]
[0m19:22:15.251763 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m19:22:15.256204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:15.258319 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m19:22:15.260022 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m19:22:15.725414 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m19:22:15.725414 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m19:22:16.135920 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m19:22:16.135920 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m19:22:16.547035 [info ] [MainThread]: 
[0m19:22:16.552992 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.75 seconds (10.75s).
[0m19:22:16.558087 [debug] [MainThread]: Command end result
[0m19:22:16.693265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m19:22:16.703545 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m19:22:16.722189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m19:22:16.724202 [info ] [MainThread]: 
[0m19:22:16.726933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:16.729883 [info ] [MainThread]: 
[0m19:22:16.732746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:22:16.738757 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:16.738757 after 14.67 seconds
[0m19:22:16.740196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0119B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7ABAA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7FE081D0>]}
[0m19:22:16.743218 [debug] [MainThread]: Flushing usage events
[0m19:22:18.796820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:58.567354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8DAE3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8D90EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8DAE3C10>]}


============================== 19:25:58.570192 | 27fee5f5-106b-48b2-8ce9-7fe7cfde572b ==============================
[0m19:25:58.570192 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:25:58.585501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:59.712977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8F8A3290>]}
[0m19:25:59.777431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8E7E2190>]}
[0m19:25:59.793126 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:26:00.801873 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m19:26:01.028975 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:26:01.044831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8D612C90>]}
[0m19:26:04.088210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
- models.capston.src_data.stage
[0m19:26:04.091979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8F8F81D0>]}
[0m19:26:04.275501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m19:26:04.296551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m19:26:04.360850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C90003090>]}
[0m19:26:04.369175 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m19:26:04.372498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8FD3F0D0>]}
[0m19:26:04.375536 [info ] [MainThread]: 
[0m19:26:04.380919 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:26:04.383979 [info ] [MainThread]: 
[0m19:26:04.386790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:04.391264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m19:26:04.641148 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m19:26:04.641981 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m19:26:04.641981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:07.458595 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.816 seconds
[0m19:26:07.479488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m19:26:07.500200 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m19:26:07.500200 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m19:26:07.513521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:09.460580 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.948 seconds
[0m19:26:09.469450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C90094BD0>]}
[0m19:26:09.484336 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m19:26:09.486267 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.pharmacy ............................. [RUN]
[0m19:26:09.489965 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m19:26:09.492697 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m19:26:09.518513 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m19:26:09.525525 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m19:26:09.761058 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:09.778323 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m19:26:09.780032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:12.195231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.419 seconds
[0m19:26:12.219441 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:12.235501 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
[0m19:26:12.397751 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.160 seconds
[0m19:26:12.404565 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:12.404565 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm.pharmacy
[0m19:26:12.680724 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.260 seconds
[0m19:26:12.700622 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:12.710947 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."TGT_DM"."PHARMACY"
[0m19:26:12.884435 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.172 seconds
[0m19:26:12.971196 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m19:26:12.985228 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:12.985228 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m19:26:13.193861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m19:26:13.193861 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:13.193861 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.tgt_dm.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")
    values
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")

;
[0m19:26:14.114621 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.912 seconds
[0m19:26:14.117549 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:14.119521 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m19:26:14.400429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m19:26:14.421686 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
[0m19:26:14.446321 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m19:26:14.446321 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm.pharmacy__dbt_tmp cascade
[0m19:26:14.724353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m19:26:14.779965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27fee5f5-106b-48b2-8ce9-7fe7cfde572b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9064A0D0>]}
[0m19:26:14.779965 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.pharmacy ........................ [[32mSUCCESS 10[0m in 5.29s]
[0m19:26:14.789865 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m19:26:14.796833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:14.799136 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m19:26:14.801102 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m19:26:15.155149 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m19:26:15.157971 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m19:26:15.424947 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m19:26:15.442132 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m19:26:15.748054 [info ] [MainThread]: 
[0m19:26:15.751376 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.35 seconds (11.35s).
[0m19:26:15.756380 [debug] [MainThread]: Command end result
[0m19:26:15.869342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m19:26:15.883837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m19:26:15.906067 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m19:26:15.909342 [info ] [MainThread]: 
[0m19:26:15.912790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:15.915544 [info ] [MainThread]: 
[0m19:26:15.918541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:26:15.927298 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:15.923365 after 17.72 seconds
[0m19:26:15.928007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8766A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C876AF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C876AF090>]}
[0m19:26:15.933295 [debug] [MainThread]: Flushing usage events
[0m19:26:18.209412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:52.879760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A87D17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A882A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A87D32D0>]}


============================== 20:08:52.895379 | 35910f9e-8ae4-4fd0-80d6-91ae506fc74b ==============================
[0m20:08:52.895379 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:08:52.895379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:08:53.709389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A87D2B90>]}
[0m20:08:53.787488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A94CEAD0>]}
[0m20:08:53.787488 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:08:54.540647 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:08:54.868694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:54.868694 [debug] [MainThread]: Partial parsing: updated file: capston://models\stage\pharmacy.sql
[0m20:08:55.213917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.src_data.stage
- models.capston.tgt_dm.dim
- models.capston.tgt_dm.fact
[0m20:08:55.236693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156AA620410>]}
[0m20:08:55.344483 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:08:55.360069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:08:55.470808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156AA815A50>]}
[0m20:08:55.470808 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m20:08:55.470808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156AAB681D0>]}
[0m20:08:55.481145 [info ] [MainThread]: 
[0m20:08:55.483167 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:08:55.484854 [info ] [MainThread]: 
[0m20:08:55.486509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:55.486509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:08:55.752447 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:08:55.752447 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:08:55.752447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:57.986388 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.231 seconds
[0m20:08:57.986388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BHARATHDEV, now create_BHARATHDEV_tgt_dm_src_data)
[0m20:08:58.002183 [debug] [ThreadPool]: Creating schema "database: "BHARATHDEV"
schema: "tgt_dm_src_data"
"
[0m20:08:58.002183 [debug] [ThreadPool]: Using snowflake connection "create_BHARATHDEV_tgt_dm_src_data"
[0m20:08:58.002183 [debug] [ThreadPool]: On create_BHARATHDEV_tgt_dm_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "create_BHARATHDEV_tgt_dm_src_data"} */
create schema if not exists BHARATHDEV.tgt_dm_src_data
[0m20:08:58.222483 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.213 seconds
[0m20:08:58.300393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:08:58.316012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm_src_data'
[0m20:08:58.331636 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:08:58.331636 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm_src_data"
[0m20:08:58.347257 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:08:58.347257 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm_src_data"} */
show objects in BHARATHDEV.tgt_dm_src_data limit 10000;
[0m20:08:58.347257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:58.347257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:59.960429 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.620 seconds
[0m20:09:00.116581 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.778 seconds
[0m20:09:00.132048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156AAEF0990>]}
[0m20:09:00.132048 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:09:00.132048 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm_src_data.pharmacy .................... [RUN]
[0m20:09:00.132048 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:09:00.132048 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:09:00.159658 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:09:00.159658 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:09:00.273991 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:09:00.273991 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:09:00.273991 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace transient table BHARATHDEV.tgt_dm_src_data.pharmacy
         as
        (
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
        );
[0m20:09:00.273991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:03.579222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.308 seconds
[0m20:09:03.594766 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
[0m20:09:03.594766 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:09:03.610386 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp cascade
[0m20:09:03.797842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m20:09:03.829086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35910f9e-8ae4-4fd0-80d6-91ae506fc74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156AB1F80D0>]}
[0m20:09:03.829086 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm_src_data.pharmacy ............... [[32mSUCCESS 1[0m in 3.70s]
[0m20:09:03.844705 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:09:03.844705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:03.844705 [debug] [MainThread]: Connection 'create_BHARATHDEV_tgt_dm_src_data' was left open.
[0m20:09:03.844705 [debug] [MainThread]: On create_BHARATHDEV_tgt_dm_src_data: Close
[0m20:09:04.127904 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:09:04.127904 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:09:04.409014 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm_src_data' was left open.
[0m20:09:04.409014 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm_src_data: Close
[0m20:09:04.660400 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:09:04.660400 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:09:05.114882 [info ] [MainThread]: 
[0m20:09:05.114882 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.63 seconds (9.63s).
[0m20:09:05.114882 [debug] [MainThread]: Command end result
[0m20:09:05.152818 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:09:05.169735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:09:05.186157 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:09:05.186157 [info ] [MainThread]: 
[0m20:09:05.186157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:05.186157 [info ] [MainThread]: 
[0m20:09:05.186157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:09:05.186157 [debug] [MainThread]: Command `dbt run` succeeded at 20:09:05.186157 after 12.52 seconds
[0m20:09:05.186157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A23BA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A85FA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A23FF090>]}
[0m20:09:05.186157 [debug] [MainThread]: Flushing usage events
[0m20:09:06.623857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:03.561921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA6C2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA6C3E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA6C36D0>]}


============================== 20:13:03.561921 | 9e03b930-32fb-4d72-bef7-cc7f36aa0405 ==============================
[0m20:13:03.561921 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:13:03.561921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:13:04.314097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBC4B87D0>]}
[0m20:13:04.392199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBB3CE5D0>]}
[0m20:13:04.407819 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:13:05.174861 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:13:05.300798 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:13:05.300798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB9AD7590>]}
[0m20:13:07.117481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.src_data.stage
- models.capston.tgt_dm.fact
[0m20:13:07.149448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBC7F3250>]}
[0m20:13:07.261558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:13:07.261558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:13:07.324042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBCC90090>]}
[0m20:13:07.324042 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m20:13:07.324042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBC80A250>]}
[0m20:13:07.324042 [info ] [MainThread]: 
[0m20:13:07.324042 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:13:07.324042 [info ] [MainThread]: 
[0m20:13:07.336138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:07.339242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:13:07.543048 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:13:07.543048 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:13:07.543048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:09.594320 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.063 seconds
[0m20:13:09.609744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BHARATHDEV, now create_BHARATHDEV_src_data_src_data)
[0m20:13:09.609744 [debug] [ThreadPool]: Creating schema "database: "BHARATHDEV"
schema: "src_data_src_data"
"
[0m20:13:09.609744 [debug] [ThreadPool]: Using snowflake connection "create_BHARATHDEV_src_data_src_data"
[0m20:13:09.609744 [debug] [ThreadPool]: On create_BHARATHDEV_src_data_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "create_BHARATHDEV_src_data_src_data"} */
create schema if not exists BHARATHDEV.src_data_src_data
[0m20:13:09.828648 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.220 seconds
[0m20:13:09.844063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data_src_data'
[0m20:13:09.844063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m20:13:09.859685 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data_src_data"
[0m20:13:09.859685 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m20:13:09.859685 [debug] [ThreadPool]: On list_BHARATHDEV_src_data_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data_src_data"} */
show objects in BHARATHDEV.src_data_src_data limit 10000;
[0m20:13:09.859685 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m20:13:09.859685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:09.859685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:11.425540 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.559 seconds
[0m20:13:11.441361 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.577 seconds
[0m20:13:11.441361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBCAAC590>]}
[0m20:13:11.456784 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:13:11.456784 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data_src_data.pharmacy .................. [RUN]
[0m20:13:11.456784 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:13:11.456784 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:13:11.456784 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:13:11.475880 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:13:11.544472 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:13:11.560133 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:13:11.560133 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace transient table BHARATHDEV.src_data_src_data.pharmacy
         as
        (
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
        );
[0m20:13:11.560133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:13:14.512018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.954 seconds
[0m20:13:14.527472 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data_src_data.pharmacy__dbt_tmp
[0m20:13:14.527472 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:13:14.527472 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.src_data_src_data.pharmacy__dbt_tmp cascade
[0m20:13:14.714926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m20:13:14.761789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e03b930-32fb-4d72-bef7-cc7f36aa0405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBC79FB10>]}
[0m20:13:14.761789 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data_src_data.pharmacy ............. [[32mSUCCESS 1[0m in 3.29s]
[0m20:13:14.761789 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:13:14.761789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:14.761789 [debug] [MainThread]: Connection 'create_BHARATHDEV_src_data_src_data' was left open.
[0m20:13:14.761789 [debug] [MainThread]: On create_BHARATHDEV_src_data_src_data: Close
[0m20:13:15.029104 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data_src_data' was left open.
[0m20:13:15.029104 [debug] [MainThread]: On list_BHARATHDEV_src_data_src_data: Close
[0m20:13:15.294677 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m20:13:15.294677 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m20:13:15.562779 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:13:15.562779 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:13:15.828311 [info ] [MainThread]: 
[0m20:13:15.828311 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m20:13:15.828311 [debug] [MainThread]: Command end result
[0m20:13:15.873841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:13:15.890871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:13:15.900844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:13:15.901844 [info ] [MainThread]: 
[0m20:13:15.903838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:13:15.905151 [info ] [MainThread]: 
[0m20:13:15.907150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:13:15.910143 [debug] [MainThread]: Command `dbt run` succeeded at 20:13:15.910143 after 12.48 seconds
[0m20:13:15.911139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FB429A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA4EB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FBA4EA950>]}
[0m20:13:15.912134 [debug] [MainThread]: Flushing usage events
[0m20:13:18.021229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:48.567650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273420679D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027341E8EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273420BB850>]}


============================== 20:13:48.567650 | 80bc5157-e154-4ee3-b961-7c48c2679cd7 ==============================
[0m20:13:48.567650 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:13:48.583241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:13:49.021330 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "capston", target "dev" invalid: 'schema' is a required property
[0m20:13:49.021330 [debug] [MainThread]: Command `dbt run` failed at 20:13:49.021330 after 0.57 seconds
[0m20:13:49.021330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027342067210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002733BC4A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273420AFE90>]}
[0m20:13:49.021330 [debug] [MainThread]: Flushing usage events
[0m20:13:50.620469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:14.026284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DA83210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DA80910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DA83850>]}


============================== 20:14:14.026284 | 58d951a1-cedf-4470-bd9a-eedf140d9159 ==============================
[0m20:14:14.026284 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:14:14.026284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:14.697602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DA92E50>]}
[0m20:14:14.760120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DD7E590>]}
[0m20:14:14.777140 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:14:15.560056 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:14:15.685062 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:14:15.685062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07FC17ED0>]}
[0m20:14:17.851025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.tgt_dm.fact
- models.capston.src_data.stage
- models.capston.tgt_dm.dim
[0m20:14:17.873997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07FEC2010>]}
[0m20:14:18.003822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:14:18.003822 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:14:18.050655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E000133A90>]}
[0m20:14:18.050655 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m20:14:18.050655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E000097490>]}
[0m20:14:18.050655 [info ] [MainThread]: 
[0m20:14:18.050655 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:14:18.050655 [info ] [MainThread]: 
[0m20:14:18.064497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:14:18.068213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:14:18.325751 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:14:18.325751 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:14:18.340010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:20.202393 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.869 seconds
[0m20:14:20.217841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm_src_data'
[0m20:14:20.217841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:14:20.217841 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm_src_data"
[0m20:14:20.233464 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:14:20.233464 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm_src_data"} */
show objects in BHARATHDEV.tgt_dm_src_data limit 10000;
[0m20:14:20.233464 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:14:20.233464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:20.233464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:21.922747 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.684 seconds
[0m20:14:21.928697 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.689 seconds
[0m20:14:21.935619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07FF146D0>]}
[0m20:14:21.939609 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:14:21.941612 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm_src_data.pharmacy .................... [RUN]
[0m20:14:21.943601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:14:21.944598 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:14:21.961384 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:14:21.964758 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:14:22.099057 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:22.099057 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m20:14:22.099057 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:23.810157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.713 seconds
[0m20:14:23.825578 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:23.825578 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
[0m20:14:23.981973 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.151 seconds
[0m20:14:23.981973 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:23.981973 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm_src_data.pharmacy
[0m20:14:24.115086 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.135 seconds
[0m20:14:24.130707 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:24.130707 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."TGT_DM_SRC_DATA"."PHARMACY"
[0m20:14:24.262284 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.132 seconds
[0m20:14:24.308943 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:14:24.308943 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:24.308943 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m20:14:24.481272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m20:14:24.481272 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:24.481272 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.tgt_dm_src_data.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")
    values
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")

;
[0m20:14:24.965594 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.473 seconds
[0m20:14:24.965594 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:24.965594 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m20:14:25.215535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m20:14:25.231157 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
[0m20:14:25.246782 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:14:25.246782 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp cascade
[0m20:14:25.479271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m20:14:25.526134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58d951a1-cedf-4470-bd9a-eedf140d9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07FF0CD90>]}
[0m20:14:25.526134 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm_src_data.pharmacy ............... [[32mSUCCESS 10[0m in 3.58s]
[0m20:14:25.526134 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:14:25.526134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:25.526134 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:14:25.541755 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:14:25.811471 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm_src_data' was left open.
[0m20:14:25.811471 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm_src_data: Close
[0m20:14:26.047270 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:14:26.062687 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:14:26.341711 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:14:26.342709 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:14:26.731673 [info ] [MainThread]: 
[0m20:14:26.731673 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m20:14:26.731673 [debug] [MainThread]: Command end result
[0m20:14:26.781703 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:14:26.781703 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:14:26.798195 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:14:26.799190 [info ] [MainThread]: 
[0m20:14:26.801271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:26.802871 [info ] [MainThread]: 
[0m20:14:26.913484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:14:26.913484 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:26.913484 after 13.02 seconds
[0m20:14:26.913484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07DAFABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07759A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07D7B7E10>]}
[0m20:14:26.913484 [debug] [MainThread]: Flushing usage events
[0m20:14:28.673305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:38.935399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309A2E27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309A2E3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309A2E1A90>]}


============================== 20:33:38.942594 | 77873ada-4cdd-4a4d-8419-38c21cd70f4c ==============================
[0m20:33:38.942594 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:33:38.945087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:33:39.739655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309C084810>]}
[0m20:33:39.816332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309AFDA590>]}
[0m20:33:39.818314 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:33:40.586603 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:33:40.889514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:40.890513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:40.901284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.src_data.stage
- models.capston.tgt_dm.fact
[0m20:33:40.959479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309C4223D0>]}
[0m20:33:41.094986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:33:41.102964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:33:41.160545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309C0C6790>]}
[0m20:33:41.161546 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 470 macros
[0m20:33:41.162358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309C30FB10>]}
[0m20:33:41.165417 [info ] [MainThread]: 
[0m20:33:41.165417 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:33:41.165417 [info ] [MainThread]: 
[0m20:33:41.170466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:41.173455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:33:41.395885 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:33:41.396882 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:33:41.397878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:43.160531 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.763 seconds
[0m20:33:43.171628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm_src_data'
[0m20:33:43.172655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:33:43.195903 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm_src_data"
[0m20:33:43.201885 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:33:43.202891 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm_src_data"} */
show objects in BHARATHDEV.tgt_dm_src_data limit 10000;
[0m20:33:43.203914 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:33:43.205876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:43.206872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:44.928439 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.722 seconds
[0m20:33:44.935533 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.729 seconds
[0m20:33:44.942642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309C59C450>]}
[0m20:33:44.947628 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:33:44.949621 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm_src_data.pharmacy .................... [RUN]
[0m20:33:44.951619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:33:44.952617 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:33:44.966577 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:33:44.973558 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:33:45.084121 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:45.085205 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m20:33:45.087238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:46.962023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.875 seconds
[0m20:33:46.973079 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:46.974075 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
[0m20:33:47.115573 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.151 seconds
[0m20:33:47.135392 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:47.137353 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm_src_data.pharmacy
[0m20:33:47.309181 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.171 seconds
[0m20:33:47.314233 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:47.314233 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."TGT_DM_SRC_DATA"."PHARMACY"
[0m20:33:47.455952 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.135 seconds
[0m20:33:47.490461 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:33:47.490461 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:47.490461 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m20:33:47.655974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m20:33:47.657138 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:47.658152 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.tgt_dm_src_data.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")
    values
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")

;
[0m20:33:49.390053 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.730 seconds
[0m20:33:49.391086 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:49.393048 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m20:33:49.689573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m20:33:49.689573 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp
[0m20:33:49.714561 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:33:49.714617 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm_src_data.pharmacy__dbt_tmp cascade
[0m20:33:49.926158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m20:33:49.953349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77873ada-4cdd-4a4d-8419-38c21cd70f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309CB8F550>]}
[0m20:33:49.954348 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm_src_data.pharmacy ............... [[32mSUCCESS 10[0m in 5.00s]
[0m20:33:49.956634 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:33:49.958628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:49.959708 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:33:49.960707 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:33:50.222051 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm_src_data' was left open.
[0m20:33:50.223018 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm_src_data: Close
[0m20:33:50.465069 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:33:50.467100 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:33:50.758922 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:33:50.760028 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:33:51.039978 [info ] [MainThread]: 
[0m20:33:51.039978 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m20:33:51.039978 [debug] [MainThread]: Command end result
[0m20:33:51.116799 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:33:51.124777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:33:51.140735 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:33:51.142731 [info ] [MainThread]: 
[0m20:33:51.146720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:51.148713 [info ] [MainThread]: 
[0m20:33:51.150708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:33:51.153700 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:51.153700 after 12.35 seconds
[0m20:33:51.155695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309A35A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023093E2A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023093E2B290>]}
[0m20:33:51.156693 [debug] [MainThread]: Flushing usage events
[0m20:33:53.150193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:22.059797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E4EF7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E4EF4D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E4EF7810>]}


============================== 20:43:22.067940 | 1dfdda15-733d-4742-9fca-45f5449429be ==============================
[0m20:43:22.067940 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:43:22.069517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:43:22.725469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E6C9ECD0>]}
[0m20:43:22.796364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E4F3C790>]}
[0m20:43:22.798359 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:43:23.580870 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:43:23.881691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:43:23.882655 [debug] [MainThread]: Partial parsing: added file: capston://macros\generate_schema_name.sql
[0m20:43:23.883651 [debug] [MainThread]: Partial parsing: updated file: capston://models\stage\pharmacy.sql
[0m20:43:23.887769 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m20:43:25.575663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.capston.tgt_dm.dim
- models.capston.src_data.stage
- models.capston.tgt_dm.fact
[0m20:43:25.602476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E7241690>]}
[0m20:43:25.728664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:43:25.736772 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:43:25.779389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E6F5E650>]}
[0m20:43:25.780390 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m20:43:25.782383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E708C610>]}
[0m20:43:25.784412 [info ] [MainThread]: 
[0m20:43:25.785489 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:43:25.787487 [info ] [MainThread]: 
[0m20:43:25.790477 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:43:25.793474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:43:25.990897 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:43:25.998395 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:43:25.999393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:27.948877 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.950 seconds
[0m20:43:27.958465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:43:27.970675 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:43:27.971672 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:43:27.972669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:29.793712 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.821 seconds
[0m20:43:29.800657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E6F1FD50>]}
[0m20:43:29.804906 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:43:29.806902 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.pharmacy ............................. [RUN]
[0m20:43:29.808896 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:43:29.810043 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:43:29.823010 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:43:29.826001 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:43:29.977201 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:29.978199 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m20:43:29.979196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:43:31.747772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.769 seconds
[0m20:43:31.760449 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:31.761454 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
[0m20:43:31.924013 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.161 seconds
[0m20:43:31.931992 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:31.932987 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.tgt_dm.pharmacy
[0m20:43:32.092732 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.158 seconds
[0m20:43:32.113791 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:32.115819 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."TGT_DM"."PHARMACY"
[0m20:43:32.264323 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.147 seconds
[0m20:43:32.315910 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:43:32.321895 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:32.322893 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m20:43:32.523411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m20:43:32.525405 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:32.527398 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.tgt_dm.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")
    values
        ("PHARMACY_ID", "PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "INSERT_DATE")

;
[0m20:43:34.024482 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 1.496 seconds
[0m20:43:34.025484 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:34.026478 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m20:43:34.312715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m20:43:34.324817 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.pharmacy__dbt_tmp
[0m20:43:34.335899 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:43:34.336892 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.tgt_dm.pharmacy__dbt_tmp cascade
[0m20:43:34.576056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m20:43:34.611085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfdda15-733d-4742-9fca-45f5449429be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E729BA90>]}
[0m20:43:34.613079 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.pharmacy ........................ [[32mSUCCESS 10[0m in 4.80s]
[0m20:43:34.615072 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:43:34.617296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:34.618294 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:43:34.619292 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:43:34.888210 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:43:34.890237 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:43:35.177348 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:43:35.179379 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:43:36.191163 [info ] [MainThread]: 
[0m20:43:36.193150 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m20:43:36.196144 [debug] [MainThread]: Command end result
[0m20:43:36.290248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:43:36.303294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:43:36.319840 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:43:36.321836 [info ] [MainThread]: 
[0m20:43:36.323830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:36.325824 [info ] [MainThread]: 
[0m20:43:36.327819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:43:36.331809 [debug] [MainThread]: Command `dbt run` succeeded at 20:43:36.330812 after 14.40 seconds
[0m20:43:36.332806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DE9CA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E4F69F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DEA0F090>]}
[0m20:43:36.334801 [debug] [MainThread]: Flushing usage events
[0m20:43:38.397391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:51.666117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E686423450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E686423110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E686423C10>]}


============================== 20:44:51.673101 | 21e101cd-9ae1-4e95-bb68-f98e50530af8 ==============================
[0m20:44:51.673101 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:44:51.674881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:52.330903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6858C11D0>]}
[0m20:44:52.393426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E685809390>]}
[0m20:44:52.393426 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:44:53.271508 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:44:53.380853 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:44:53.380853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E685837650>]}
[0m20:44:55.182900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m20:44:55.198523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E688562850>]}
[0m20:44:55.320690 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:44:55.320690 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:44:55.367593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6889F40D0>]}
[0m20:44:55.367593 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m20:44:55.367593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68873AB10>]}
[0m20:44:55.367593 [info ] [MainThread]: 
[0m20:44:55.367593 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:44:55.383174 [info ] [MainThread]: 
[0m20:44:55.385219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:44:55.388750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:44:55.595646 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:44:55.596645 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:44:55.596645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:57.298726 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.710 seconds
[0m20:44:57.314140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:44:57.314140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m20:44:57.329794 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:44:57.329794 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m20:44:57.329794 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:44:57.329794 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m20:44:57.329794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:57.329794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:58.833484 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.496 seconds
[0m20:44:58.911602 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.586 seconds
[0m20:44:58.927020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E685FAB550>]}
[0m20:44:58.927020 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:44:58.927020 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.pharmacy ........................... [RUN]
[0m20:44:58.927020 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:44:58.927020 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:44:58.953011 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:44:58.953011 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:44:59.082443 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:44:59.082443 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.src_data.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m20:44:59.082443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:00.619160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.537 seconds
[0m20:45:00.619160 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:00.619160 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.src_data.pharmacy__dbt_tmp
[0m20:45:00.790779 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.155 seconds
[0m20:45:00.790779 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:00.790779 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.src_data.pharmacy
[0m20:45:00.947919 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.165 seconds
[0m20:45:00.963372 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:00.963372 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."SRC_DATA"."PHARMACY"
[0m20:45:01.119725 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.148 seconds
[0m20:45:01.150833 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:45:01.150833 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:01.166414 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m20:45:01.322633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m20:45:01.322633 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:01.322633 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.src_data.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "INSERT_DATE")
    values
        ("PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "INSERT_DATE")

;
[0m20:45:01.933444 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.617 seconds
[0m20:45:01.949835 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:01.949835 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m20:45:02.263035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m20:45:02.278639 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.pharmacy__dbt_tmp
[0m20:45:02.278639 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:45:02.278639 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.src_data.pharmacy__dbt_tmp cascade
[0m20:45:02.514636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m20:45:02.545880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e101cd-9ae1-4e95-bb68-f98e50530af8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6888AF750>]}
[0m20:45:02.545880 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.pharmacy ...................... [[32mSUCCESS 10[0m in 3.62s]
[0m20:45:02.545880 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:45:02.545880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:02.545880 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:45:02.561501 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:45:02.898313 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:45:02.898313 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:45:03.171353 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m20:45:03.171353 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m20:45:03.436950 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:45:03.436950 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:45:03.690489 [info ] [MainThread]: 
[0m20:45:03.690489 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m20:45:03.795785 [debug] [MainThread]: Command end result
[0m20:45:03.856729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:45:03.861716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:45:03.873519 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:45:03.874516 [info ] [MainThread]: 
[0m20:45:03.875513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:03.877512 [info ] [MainThread]: 
[0m20:45:03.880500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:45:03.884284 [debug] [MainThread]: Command `dbt run` succeeded at 20:45:03.884284 after 12.34 seconds
[0m20:45:03.886279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E686157E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E68624EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6800EF090>]}
[0m20:45:03.887715 [debug] [MainThread]: Flushing usage events
[0m20:45:05.536696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:00.590125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3643A33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3643A3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3643A2D50>]}


============================== 20:52:00.590125 | 2ec5dc3a-f278-4378-99e1-343303bb07e2 ==============================
[0m20:52:00.590125 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:52:00.590125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s pharmacy --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:52:01.231318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B365026190>]}
[0m20:52:01.309421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36509E990>]}
[0m20:52:01.325074 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:52:02.060813 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:52:02.345774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:02.345774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:02.361397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m20:52:02.426896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B366534050>]}
[0m20:52:02.534657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:52:02.550274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:52:02.597170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3643FAE90>]}
[0m20:52:02.597170 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m20:52:02.597170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36190F950>]}
[0m20:52:02.597170 [info ] [MainThread]: 
[0m20:52:02.597170 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:52:02.597170 [info ] [MainThread]: 
[0m20:52:02.608516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:52:02.611352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:52:02.798402 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:52:02.814026 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:52:02.814026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:05.101697 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.288 seconds
[0m20:52:05.101697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m20:52:05.101697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:52:05.117171 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m20:52:05.117171 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:52:05.117171 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m20:52:05.117171 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:52:05.117171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:05.132796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:06.683327 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.564 seconds
[0m20:52:06.745812 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.628 seconds
[0m20:52:06.761233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B366387E90>]}
[0m20:52:06.761233 [debug] [Thread-1 (]: Began running node model.capston.pharmacy
[0m20:52:06.761233 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.pharmacy ........................... [RUN]
[0m20:52:06.761233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.pharmacy'
[0m20:52:06.761233 [debug] [Thread-1 (]: Began compiling node model.capston.pharmacy
[0m20:52:06.786563 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.pharmacy"
[0m20:52:06.820105 [debug] [Thread-1 (]: Began executing node model.capston.pharmacy
[0m20:52:06.965831 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:06.965831 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
create or replace  temporary view BHARATHDEV.src_data.pharmacy__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY pharmacy_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_pharmacy_data 
)
SELECT a.pharmacy_id,
  a.prescription_id,
a.patient_id,
a.medication_code,
a.fill_date,
a.days_supply,
a.quantity,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m20:52:06.965831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:08.642486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.681 seconds
[0m20:52:08.657934 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:08.657934 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.src_data.pharmacy__dbt_tmp
[0m20:52:08.814318 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.163 seconds
[0m20:52:08.829771 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:08.829771 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table BHARATHDEV.src_data.pharmacy
[0m20:52:09.001751 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.173 seconds
[0m20:52:09.001751 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:09.001751 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
describe table "BHARATHDEV"."SRC_DATA"."PHARMACY"
[0m20:52:09.174291 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.169 seconds
[0m20:52:09.205394 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.pharmacy"
[0m20:52:09.221049 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:09.221049 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
-- back compat for old kwarg name
  
  begin;
[0m20:52:09.392812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m20:52:09.392812 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:09.392812 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
merge into BHARATHDEV.src_data.pharmacy as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.pharmacy__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.pharmacy_id = DBT_INTERNAL_DEST.pharmacy_id
                )

    
    when matched then update set
        "PRESCRIPTION_ID" = DBT_INTERNAL_SOURCE."PRESCRIPTION_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","FILL_DATE" = DBT_INTERNAL_SOURCE."FILL_DATE","DAYS_SUPPLY" = DBT_INTERNAL_SOURCE."DAYS_SUPPLY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "INSERT_DATE")
    values
        ("PRESCRIPTION_ID", "PATIENT_ID", "MEDICATION_CODE", "FILL_DATE", "DAYS_SUPPLY", "QUANTITY", "PHARMACY_ID", "INSERT_DATE")

;
[0m20:52:10.130317 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.735 seconds
[0m20:52:10.130317 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:10.130317 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
COMMIT
[0m20:52:10.694140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m20:52:10.709726 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.pharmacy__dbt_tmp
[0m20:52:10.725382 [debug] [Thread-1 (]: Using snowflake connection "model.capston.pharmacy"
[0m20:52:10.725382 [debug] [Thread-1 (]: On model.capston.pharmacy: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.pharmacy"} */
drop view if exists BHARATHDEV.src_data.pharmacy__dbt_tmp cascade
[0m20:52:11.006564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m20:52:11.053401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec5dc3a-f278-4378-99e1-343303bb07e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B365160F50>]}
[0m20:52:11.053401 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.pharmacy ...................... [[32mSUCCESS 10[0m in 4.29s]
[0m20:52:11.053401 [debug] [Thread-1 (]: Finished running node model.capston.pharmacy
[0m20:52:11.053401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:11.069021 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:52:11.069021 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:52:11.428971 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m20:52:11.428971 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m20:52:11.697174 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:52:11.697174 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:52:11.994986 [debug] [MainThread]: Connection 'model.capston.pharmacy' was left open.
[0m20:52:11.994986 [debug] [MainThread]: On model.capston.pharmacy: Close
[0m20:52:12.572676 [info ] [MainThread]: 
[0m20:52:12.588300 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m20:52:12.588300 [debug] [MainThread]: Command end result
[0m20:52:12.664011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:52:12.669996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:52:12.681699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:52:12.682694 [info ] [MainThread]: 
[0m20:52:12.684691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:12.686683 [info ] [MainThread]: 
[0m20:52:12.687680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:52:12.690891 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:12.690891 after 12.22 seconds
[0m20:52:12.692886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3638BB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35DF4A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3643E0810>]}
[0m20:52:12.693883 [debug] [MainThread]: Flushing usage events
[0m20:52:14.186539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:33.339088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B5C03E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B5C03F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B5C13850>]}


============================== 20:54:33.339088 | b4b2d3e6-06d0-451e-9b12-476848124741 ==============================
[0m20:54:33.339088 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:54:33.339088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s patient --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:54:33.984065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b2d3e6-06d0-451e-9b12-476848124741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B5C40F90>]}
[0m20:54:34.046550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b2d3e6-06d0-451e-9b12-476848124741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B690E650>]}
[0m20:54:34.062175 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:54:34.828849 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:54:35.125658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:35.125658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:35.125658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m20:54:35.199429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b2d3e6-06d0-451e-9b12-476848124741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B7D1CB10>]}
[0m20:54:35.322666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:54:35.328317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:54:35.375182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b2d3e6-06d0-451e-9b12-476848124741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B79FA8D0>]}
[0m20:54:35.375182 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m20:54:35.375182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b2d3e6-06d0-451e-9b12-476848124741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B7C3FB10>]}
[0m20:54:35.375182 [warn ] [MainThread]: The selection criterion 'patient' does not match any enabled nodes
[0m20:54:35.375182 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:54:35.387881 [debug] [MainThread]: Command end result
[0m20:54:35.438310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:54:35.443297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:54:35.450045 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:54:35.451048 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:35.451048 after 2.35 seconds
[0m20:54:35.452039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186AF6CA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186B5A3A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186AF70F090>]}
[0m20:54:35.453036 [debug] [MainThread]: Flushing usage events
[0m20:54:37.100758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:49.018440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B373250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B19EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B3CBC90>]}


============================== 20:54:49.034092 | c50c72b2-9f60-4c3f-9721-d75d396c579a ==============================
[0m20:54:49.034092 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:54:49.034092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s patient_t --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m20:54:49.693446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B3C9190>]}
[0m20:54:49.770856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3C06EA10>]}
[0m20:54:49.772852 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m20:54:50.729684 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m20:54:51.062596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:51.062596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:51.079981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m20:54:51.145773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B3CA9D0>]}
[0m20:54:51.291851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:54:51.338676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:54:51.369953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3D6200D0>]}
[0m20:54:51.369953 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m20:54:51.385541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F38F794D0>]}
[0m20:54:51.385541 [info ] [MainThread]: 
[0m20:54:51.385541 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:54:51.392277 [info ] [MainThread]: 
[0m20:54:51.395003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:54:51.398979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m20:54:51.605679 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m20:54:51.605679 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m20:54:51.605679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:53.762428 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.156 seconds
[0m20:54:53.762428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m20:54:53.762428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m20:54:53.778030 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m20:54:53.794808 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m20:54:53.794808 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m20:54:53.794808 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m20:54:53.794808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:53.794808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:55.558389 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.760 seconds
[0m20:54:55.569100 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.769 seconds
[0m20:54:55.573628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3D98E710>]}
[0m20:54:55.577287 [debug] [Thread-1 (]: Began running node model.capston.patient_t
[0m20:54:55.577287 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.patient_t .......................... [RUN]
[0m20:54:55.577287 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.patient_t'
[0m20:54:55.577287 [debug] [Thread-1 (]: Began compiling node model.capston.patient_t
[0m20:54:55.598195 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.patient_t"
[0m20:54:55.602152 [debug] [Thread-1 (]: Began executing node model.capston.patient_t
[0m20:54:55.689835 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:55.689835 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
create or replace  temporary view BHARATHDEV.src_data.patient_t__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY PATIENT_ID ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_patient_data 
)
SELECT a.patient_id,
a.first_name,
a.last_name,
a.date_of_birth,
a.gender,
a.race,
a.ethnicity,
a.address,
a.city,
a.state,
a.zip_code,
a.insurance_type,
a.primary_care_provider_id,
A.insert_date FROM SRC A WHERE A.RNK = 1
  );
[0m20:54:55.689835 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:54:57.592554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.902 seconds
[0m20:54:57.592554 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:57.592554 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
describe table BHARATHDEV.src_data.patient_t__dbt_tmp
[0m20:54:57.748770 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.152 seconds
[0m20:54:57.764232 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:57.764232 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
describe table BHARATHDEV.src_data.patient_t
[0m20:54:57.902263 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.136 seconds
[0m20:54:57.902263 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:57.902263 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
describe table "BHARATHDEV"."SRC_DATA"."PATIENT_T"
[0m20:54:58.043018 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.143 seconds
[0m20:54:58.089680 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.patient_t"
[0m20:54:58.089680 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:58.089680 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
-- back compat for old kwarg name
  
  begin;
[0m20:54:58.251255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m20:54:58.251255 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:58.251255 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
merge into BHARATHDEV.src_data.patient_t as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.patient_t__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.patient_id = DBT_INTERNAL_DEST.patient_id
                )

    
    when matched then update set
        "FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","DATE_OF_BIRTH" = DBT_INTERNAL_SOURCE."DATE_OF_BIRTH","GENDER" = DBT_INTERNAL_SOURCE."GENDER","RACE" = DBT_INTERNAL_SOURCE."RACE","ETHNICITY" = DBT_INTERNAL_SOURCE."ETHNICITY","ADDRESS" = DBT_INTERNAL_SOURCE."ADDRESS","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CODE" = DBT_INTERNAL_SOURCE."ZIP_CODE","INSURANCE_TYPE" = DBT_INTERNAL_SOURCE."INSURANCE_TYPE","PRIMARY_CARE_PROVIDER_ID" = DBT_INTERNAL_SOURCE."PRIMARY_CARE_PROVIDER_ID","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PATIENT_ID", "FIRST_NAME", "LAST_NAME", "DATE_OF_BIRTH", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "INSERT_DATE")
    values
        ("PATIENT_ID", "FIRST_NAME", "LAST_NAME", "DATE_OF_BIRTH", "GENDER", "RACE", "ETHNICITY", "ADDRESS", "CITY", "STATE", "ZIP_CODE", "INSURANCE_TYPE", "PRIMARY_CARE_PROVIDER_ID", "INSERT_DATE")

;
[0m20:54:59.504030 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.253 seconds
[0m20:54:59.504030 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:59.504030 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
COMMIT
[0m20:54:59.911980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m20:54:59.927452 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.patient_t__dbt_tmp
[0m20:54:59.927452 [debug] [Thread-1 (]: Using snowflake connection "model.capston.patient_t"
[0m20:54:59.927452 [debug] [Thread-1 (]: On model.capston.patient_t: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.patient_t"} */
drop view if exists BHARATHDEV.src_data.patient_t__dbt_tmp cascade
[0m20:55:00.114877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m20:55:00.146161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c50c72b2-9f60-4c3f-9721-d75d396c579a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3DCDD710>]}
[0m20:55:00.146161 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.patient_t ..................... [[32mSUCCESS 100000[0m in 4.57s]
[0m20:55:00.146161 [debug] [Thread-1 (]: Finished running node model.capston.patient_t
[0m20:55:00.146161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:00.146161 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m20:55:00.146161 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m20:55:00.414684 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m20:55:00.414684 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m20:55:00.680261 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m20:55:00.680261 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m20:55:00.931659 [debug] [MainThread]: Connection 'model.capston.patient_t' was left open.
[0m20:55:00.931659 [debug] [MainThread]: On model.capston.patient_t: Close
[0m20:55:01.205145 [info ] [MainThread]: 
[0m20:55:01.206511 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m20:55:01.208987 [debug] [MainThread]: Command end result
[0m20:55:01.268317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m20:55:01.269459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m20:55:01.269459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m20:55:01.284477 [info ] [MainThread]: 
[0m20:55:01.286241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:01.286785 [info ] [MainThread]: 
[0m20:55:01.288128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:55:01.290525 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:01.290525 after 12.38 seconds
[0m20:55:01.291553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B19EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F34E9A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3B3A3790>]}
[0m20:55:01.292553 [debug] [MainThread]: Flushing usage events
[0m20:55:02.964637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:20.753812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305FDE16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305FE38E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305FDE3B50>]}


============================== 21:06:20.753812 | 5ee4ca9b-f640-4e07-ad84-ab168b1a82ac ==============================
[0m21:06:20.753812 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:06:20.753812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s medical_events --vars {source_database : BHARATHDEV}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:06:21.502900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013061C0D210>]}
[0m21:06:21.565345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305F1C9390>]}
[0m21:06:21.580969 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:06:22.606047 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:06:22.976450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:22.977450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:22.989549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m21:06:23.084211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013061F31BD0>]}
[0m21:06:23.230557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:06:23.239533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:06:23.280485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013061C40690>]}
[0m21:06:23.280485 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:06:23.280485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013060BB0FD0>]}
[0m21:06:23.280485 [info ] [MainThread]: 
[0m21:06:23.280485 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:06:23.280485 [info ] [MainThread]: 
[0m21:06:23.292436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:23.295866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:06:23.505812 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:06:23.505812 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:06:23.505812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:25.665340 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.157 seconds
[0m21:06:25.674106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:06:25.675107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:06:25.680865 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:06:25.680865 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:06:25.680865 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:06:25.696488 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:06:25.696488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:25.696488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:27.379562 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.683 seconds
[0m21:06:27.499330 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.800 seconds
[0m21:06:27.502790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013062067C10>]}
[0m21:06:27.502790 [debug] [Thread-1 (]: Began running node model.capston.medical_events
[0m21:06:27.502790 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.medical_events ..................... [RUN]
[0m21:06:27.513829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.medical_events'
[0m21:06:27.514829 [debug] [Thread-1 (]: Began compiling node model.capston.medical_events
[0m21:06:27.539439 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.medical_events"
[0m21:06:27.541522 [debug] [Thread-1 (]: Began executing node model.capston.medical_events
[0m21:06:27.665167 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:27.666167 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
create or replace  temporary view BHARATHDEV.src_data.medical_events__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY event_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_medical_events 
)
SELECT a.event_id, 
a.patient_id, 
a.event_date, 
a.event_type, 
a.diagnosis_code,
a.procedure_code,
a.medication_code,
a.provider_id,
a.facility_id,
a.notes,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m21:06:27.667162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:29.197381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.534 seconds
[0m21:06:29.213270 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:29.214066 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
describe table BHARATHDEV.src_data.medical_events__dbt_tmp
[0m21:06:29.446398 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.230 seconds
[0m21:06:29.447923 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:29.447923 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
describe table BHARATHDEV.src_data.medical_events
[0m21:06:29.597539 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.148 seconds
[0m21:06:29.615681 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:29.615681 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
describe table "BHARATHDEV"."SRC_DATA"."MEDICAL_EVENTS"
[0m21:06:29.747101 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.138 seconds
[0m21:06:29.798562 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.medical_events"
[0m21:06:29.815394 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:29.815394 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
-- back compat for old kwarg name
  
  begin;
[0m21:06:30.013458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m21:06:30.013458 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:30.013458 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
merge into BHARATHDEV.src_data.medical_events as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.medical_events__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.event_id = DBT_INTERNAL_DEST.event_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","EVENT_DATE" = DBT_INTERNAL_SOURCE."EVENT_DATE","EVENT_TYPE" = DBT_INTERNAL_SOURCE."EVENT_TYPE","DIAGNOSIS_CODE" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODE","PROCEDURE_CODE" = DBT_INTERNAL_SOURCE."PROCEDURE_CODE","MEDICATION_CODE" = DBT_INTERNAL_SOURCE."MEDICATION_CODE","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","NOTES" = DBT_INTERNAL_SOURCE."NOTES","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "INSERT_DATE")
    values
        ("EVENT_ID", "PATIENT_ID", "EVENT_DATE", "EVENT_TYPE", "DIAGNOSIS_CODE", "PROCEDURE_CODE", "MEDICATION_CODE", "PROVIDER_ID", "FACILITY_ID", "NOTES", "INSERT_DATE")

;
[0m21:06:31.284323 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.280 seconds
[0m21:06:31.299770 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:31.299770 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
COMMIT
[0m21:06:31.596032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m21:06:31.617677 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.medical_events__dbt_tmp
[0m21:06:31.629671 [debug] [Thread-1 (]: Using snowflake connection "model.capston.medical_events"
[0m21:06:31.629671 [debug] [Thread-1 (]: On model.capston.medical_events: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.medical_events"} */
drop view if exists BHARATHDEV.src_data.medical_events__dbt_tmp cascade
[0m21:06:31.867600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m21:06:31.941701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee4ca9b-f640-4e07-ad84-ab168b1a82ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013060B8BE90>]}
[0m21:06:31.944682 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.medical_events ................ [[32mSUCCESS 100000[0m in 4.41s]
[0m21:06:31.955651 [debug] [Thread-1 (]: Finished running node model.capston.medical_events
[0m21:06:32.028254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:32.030250 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:06:32.031246 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:06:33.043667 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:06:33.043667 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:06:33.289387 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:06:33.289387 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:06:33.629649 [debug] [MainThread]: Connection 'model.capston.medical_events' was left open.
[0m21:06:33.629649 [debug] [MainThread]: On model.capston.medical_events: Close
[0m21:06:33.869135 [info ] [MainThread]: 
[0m21:06:33.869135 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m21:06:33.884588 [debug] [MainThread]: Command end result
[0m21:06:33.922524 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:06:33.941655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:06:33.955838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:06:33.955838 [info ] [MainThread]: 
[0m21:06:33.955838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:33.955838 [info ] [MainThread]: 
[0m21:06:33.955838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:06:33.955838 [debug] [MainThread]: Command `dbt run` succeeded at 21:06:33.955838 after 13.47 seconds
[0m21:06:33.955838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130598EA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305FC0E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001305992F090>]}
[0m21:06:33.955838 [debug] [MainThread]: Flushing usage events
[0m21:06:35.450947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:34.951528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D683910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D680890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D683C90>]}


============================== 21:07:34.951528 | d05621ac-e5cf-409d-a7b8-7b2e85acbdde ==============================
[0m21:07:34.951528 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:07:34.967119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s care_gaps --vars {source_database : BHARATHDEV}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:35.611815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D682910>]}
[0m21:07:35.689958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88CA694D0>]}
[0m21:07:35.689958 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:07:36.440522 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:07:36.738320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:07:36.738320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:07:36.738320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m21:07:36.814871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88E403750>]}
[0m21:07:36.934348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:07:36.934348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:07:36.987761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88E499BD0>]}
[0m21:07:36.987761 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:07:36.987761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D681310>]}
[0m21:07:36.987761 [info ] [MainThread]: 
[0m21:07:36.987761 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:07:36.987761 [info ] [MainThread]: 
[0m21:07:37.004343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:07:37.008435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:07:37.294407 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:07:37.294407 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:07:37.294407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:39.119317 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.818 seconds
[0m21:07:39.119317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:07:39.119317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:07:39.134741 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:07:39.134741 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:07:39.134741 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:07:39.134741 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:07:39.134741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:39.150362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:40.621212 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.476 seconds
[0m21:07:40.700989 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.562 seconds
[0m21:07:40.716441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88E423590>]}
[0m21:07:40.716441 [debug] [Thread-1 (]: Began running node model.capston.care_gaps
[0m21:07:40.716441 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.care_gaps .......................... [RUN]
[0m21:07:40.716441 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.care_gaps'
[0m21:07:40.716441 [debug] [Thread-1 (]: Began compiling node model.capston.care_gaps
[0m21:07:40.742854 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.care_gaps"
[0m21:07:40.742854 [debug] [Thread-1 (]: Began executing node model.capston.care_gaps
[0m21:07:40.834374 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:40.834374 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
create or replace  temporary view BHARATHDEV.src_data.care_gaps__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY gap_id ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_care_gaps 
)
SELECT a.gap_id,
a.patient_id,
a.gap_type,
a.identified_date,
a.status,
a.recommended_action,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m21:07:40.834374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:07:42.783934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.947 seconds
[0m21:07:42.783934 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:42.799409 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
describe table BHARATHDEV.src_data.care_gaps__dbt_tmp
[0m21:07:42.956669 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.166 seconds
[0m21:07:42.956669 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:42.972292 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
describe table BHARATHDEV.src_data.care_gaps
[0m21:07:43.112888 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.147 seconds
[0m21:07:43.128507 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:43.128507 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
describe table "BHARATHDEV"."SRC_DATA"."CARE_GAPS"
[0m21:07:43.284719 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.158 seconds
[0m21:07:43.332111 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.care_gaps"
[0m21:07:43.347733 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:43.347733 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
-- back compat for old kwarg name
  
  begin;
[0m21:07:43.535190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m21:07:43.535190 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:43.535190 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
merge into BHARATHDEV.src_data.care_gaps as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.care_gaps__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.gap_id = DBT_INTERNAL_DEST.gap_id
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","GAP_TYPE" = DBT_INTERNAL_SOURCE."GAP_TYPE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RECOMMENDED_ACTION" = DBT_INTERNAL_SOURCE."RECOMMENDED_ACTION","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "INSERT_DATE")
    values
        ("GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "INSERT_DATE")

;
[0m21:07:44.772670 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 1.235 seconds
[0m21:07:44.772670 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:44.772670 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
COMMIT
[0m21:07:45.040840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m21:07:45.056463 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.care_gaps__dbt_tmp
[0m21:07:45.056463 [debug] [Thread-1 (]: Using snowflake connection "model.capston.care_gaps"
[0m21:07:45.056463 [debug] [Thread-1 (]: On model.capston.care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.care_gaps"} */
drop view if exists BHARATHDEV.src_data.care_gaps__dbt_tmp cascade
[0m21:07:45.322025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m21:07:45.384513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05621ac-e5cf-409d-a7b8-7b2e85acbdde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88FFFA210>]}
[0m21:07:45.384513 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.care_gaps ..................... [[32mSUCCESS 100000[0m in 4.65s]
[0m21:07:45.384513 [debug] [Thread-1 (]: Finished running node model.capston.care_gaps
[0m21:07:45.384513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:45.384513 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:07:45.384513 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:07:45.684587 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:07:45.684587 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:07:45.977737 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:07:45.979339 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:07:46.244934 [debug] [MainThread]: Connection 'model.capston.care_gaps' was left open.
[0m21:07:46.244934 [debug] [MainThread]: On model.capston.care_gaps: Close
[0m21:07:46.605884 [info ] [MainThread]: 
[0m21:07:46.605884 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m21:07:46.605884 [debug] [MainThread]: Command end result
[0m21:07:46.680906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:07:46.695840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:07:46.709812 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:07:46.710800 [info ] [MainThread]: 
[0m21:07:46.715430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:46.717424 [info ] [MainThread]: 
[0m21:07:46.720414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:07:46.724404 [debug] [MainThread]: Command `dbt run` succeeded at 21:07:46.723410 after 11.89 seconds
[0m21:07:46.725404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D6DB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8870DA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88D6B0810>]}
[0m21:07:46.726399 [debug] [MainThread]: Flushing usage events
[0m21:07:48.142080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:05.698271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29202F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29200790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29203750>]}


============================== 21:08:05.713928 | eec62ea0-d74b-4ced-8701-4bde9bf45c1e ==============================
[0m21:08:05.713928 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:08:05.713928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s claims --vars {source_database : BHARATHDEV}', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:06.355062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2B01ED90>]}
[0m21:08:06.433169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E285E9310>]}
[0m21:08:06.433169 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:08:07.294533 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:08:07.575721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:07.575721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:07.575721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m21:08:07.652148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29F80A10>]}
[0m21:08:07.846310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:08:07.861888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:08:07.908753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2B21EC50>]}
[0m21:08:07.908753 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:08:07.908753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29203B90>]}
[0m21:08:07.908753 [info ] [MainThread]: 
[0m21:08:07.924412 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:08:07.927240 [info ] [MainThread]: 
[0m21:08:07.929237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:08:07.933608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:08:08.133836 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:08:08.133836 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:08:08.133836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:09.927683 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.802 seconds
[0m21:08:09.943072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:08:09.943072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:08:09.958694 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:08:09.958694 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:08:09.958694 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:08:09.958694 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:08:09.958694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:09.958694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:11.416411 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.454 seconds
[0m21:08:11.541584 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.583 seconds
[0m21:08:11.541584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29F6BA50>]}
[0m21:08:11.557039 [debug] [Thread-1 (]: Began running node model.capston.claims
[0m21:08:11.557039 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.claims ............................. [RUN]
[0m21:08:11.557039 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.claims'
[0m21:08:11.557039 [debug] [Thread-1 (]: Began compiling node model.capston.claims
[0m21:08:11.572660 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.claims"
[0m21:08:11.576580 [debug] [Thread-1 (]: Began executing node model.capston.claims
[0m21:08:11.637318 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:11.637318 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
create or replace  temporary view BHARATHDEV.src_data.claims__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY CLAIM_ID ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_claims_data 
)
SELECT a.claim_id,
a.patient_id,
a.service_date,
a.claim_date,
a.claim_amount,
a.claim_status,
a.provider_id,
a.diagnosis_codes,
a.procedure_codes,
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m21:08:11.637318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:08:13.687061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.037 seconds
[0m21:08:13.702683 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:13.702683 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
describe table BHARATHDEV.src_data.claims__dbt_tmp
[0m21:08:13.858896 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.158 seconds
[0m21:08:13.858896 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:13.874521 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
describe table BHARATHDEV.src_data.claims
[0m21:08:14.015495 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.143 seconds
[0m21:08:14.031122 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:14.031122 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
describe table "BHARATHDEV"."SRC_DATA"."CLAIMS"
[0m21:08:14.171709 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.139 seconds
[0m21:08:14.218574 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.claims"
[0m21:08:14.218574 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:14.218574 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
-- back compat for old kwarg name
  
  begin;
[0m21:08:14.499791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m21:08:14.499791 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:14.499791 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
merge into BHARATHDEV.src_data.claims as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.claims__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.CLAIM_ID = DBT_INTERNAL_DEST.CLAIM_ID
                )

    
    when matched then update set
        "PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","SERVICE_DATE" = DBT_INTERNAL_SOURCE."SERVICE_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","CLAIM_AMOUNT" = DBT_INTERNAL_SOURCE."CLAIM_AMOUNT","CLAIM_STATUS" = DBT_INTERNAL_SOURCE."CLAIM_STATUS","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","DIAGNOSIS_CODES" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODES","PROCEDURE_CODES" = DBT_INTERNAL_SOURCE."PROCEDURE_CODES","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "INSERT_DATE")
    values
        ("CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "INSERT_DATE")

;
[0m21:08:16.882399 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 2.377 seconds
[0m21:08:16.882399 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:16.882399 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
COMMIT
[0m21:08:17.195434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m21:08:17.211055 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.claims__dbt_tmp
[0m21:08:17.226675 [debug] [Thread-1 (]: Using snowflake connection "model.capston.claims"
[0m21:08:17.226675 [debug] [Thread-1 (]: On model.capston.claims: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.claims"} */
drop view if exists BHARATHDEV.src_data.claims__dbt_tmp cascade
[0m21:08:17.476616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m21:08:17.507859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec62ea0-d74b-4ced-8701-4bde9bf45c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2B1ED510>]}
[0m21:08:17.507859 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.claims ........................ [[32mSUCCESS 100000[0m in 5.95s]
[0m21:08:17.507859 [debug] [Thread-1 (]: Finished running node model.capston.claims
[0m21:08:17.523480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:17.523480 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:08:17.523480 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:08:17.806333 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:08:17.806333 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:08:18.071894 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:08:18.071894 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:08:18.325554 [debug] [MainThread]: Connection 'model.capston.claims' was left open.
[0m21:08:18.325554 [debug] [MainThread]: On model.capston.claims: Close
[0m21:08:18.606737 [info ] [MainThread]: 
[0m21:08:18.606737 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m21:08:18.606737 [debug] [MainThread]: Command end result
[0m21:08:18.695620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:08:18.711726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:08:18.729489 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:08:18.731485 [info ] [MainThread]: 
[0m21:08:18.733479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:18.735474 [info ] [MainThread]: 
[0m21:08:18.737468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:08:18.740460 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:18.740460 after 13.15 seconds
[0m21:08:18.742466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E22E3A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2867ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E29203A90>]}
[0m21:08:18.744957 [debug] [MainThread]: Flushing usage events
[0m21:08:20.407709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:56.042247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67B473550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67B4C97D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67B4C8990>]}


============================== 21:08:56.050199 | 2dc35e5d-bf28-4ccc-a4a2-2b11d597218c ==============================
[0m21:08:56.050199 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:08:56.052193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s provider --vars {source_database : BHARATHDEV}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:57.054490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C227850>]}
[0m21:08:57.148219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67A859390>]}
[0m21:08:57.148219 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:08:58.174934 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:08:58.518583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:58.518583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:58.534205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.capston.fact
[0m21:08:58.628458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67D5E23D0>]}
[0m21:08:58.819812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:08:58.819812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:08:58.869778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67D72C110>]}
[0m21:08:58.886434 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:08:58.886434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67D773B50>]}
[0m21:08:58.886434 [info ] [MainThread]: 
[0m21:08:58.886434 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:08:58.886434 [info ] [MainThread]: 
[0m21:08:58.886434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:08:58.886434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:08:59.152900 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:08:59.152900 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:08:59.152900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:01.112077 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.951 seconds
[0m21:09:01.112077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:09:01.112077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:09:01.127525 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:09:01.143143 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:09:01.143143 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:09:01.143143 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:09:01.143143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:01.143143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:02.949791 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.809 seconds
[0m21:09:03.012244 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.879 seconds
[0m21:09:03.027751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DAD1250>]}
[0m21:09:03.027751 [debug] [Thread-1 (]: Began running node model.capston.provider
[0m21:09:03.027751 [info ] [Thread-1 (]: 1 of 1 START sql incremental model src_data.provider ........................... [RUN]
[0m21:09:03.027751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.provider'
[0m21:09:03.027751 [debug] [Thread-1 (]: Began compiling node model.capston.provider
[0m21:09:03.050878 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.provider"
[0m21:09:03.050878 [debug] [Thread-1 (]: Began executing node model.capston.provider
[0m21:09:03.116362 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:03.116362 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
create or replace  temporary view BHARATHDEV.src_data.provider__dbt_tmp
  
   as (
    
WITH SRC AS (
SELECT *, ROW_NUMBER() OVER(PARTITION BY PROVIDER_ID ORDER BY INSERT_DATE DESC) as rnk
FROM BHARATHDEV.rawstage.src_provider_data 
)
SELECT a.provider_id, 
a.provider_name, 
a.specialty, 
a.npi_number, 
a.facility_id, 
a.insert_date
FROM SRC A WHERE A.RNK = 1
  );
[0m21:09:03.116362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:09:04.877772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m21:09:04.893225 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:04.893225 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
describe table BHARATHDEV.src_data.provider__dbt_tmp
[0m21:09:05.065224 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.169 seconds
[0m21:09:05.065224 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:05.065224 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
describe table BHARATHDEV.src_data.provider
[0m21:09:05.223783 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.150 seconds
[0m21:09:05.230787 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:05.230787 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
describe table "BHARATHDEV"."SRC_DATA"."PROVIDER"
[0m21:09:05.372181 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.138 seconds
[0m21:09:05.403221 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.provider"
[0m21:09:05.403221 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:05.418843 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
-- back compat for old kwarg name
  
  begin;
[0m21:09:05.590874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m21:09:05.590874 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:05.590874 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
merge into BHARATHDEV.src_data.provider as DBT_INTERNAL_DEST
        using BHARATHDEV.src_data.provider__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.PROVIDER_ID = DBT_INTERNAL_DEST.PROVIDER_ID
                )

    
    when matched then update set
        "PROVIDER_NAME" = DBT_INTERNAL_SOURCE."PROVIDER_NAME","SPECIALTY" = DBT_INTERNAL_SOURCE."SPECIALTY","NPI_NUMBER" = DBT_INTERNAL_SOURCE."NPI_NUMBER","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","INSERT_DATE" = DBT_INTERNAL_SOURCE."INSERT_DATE"
    

    when not matched then insert
        ("PROVIDER_ID", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "INSERT_DATE")
    values
        ("PROVIDER_ID", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "INSERT_DATE")

;
[0m21:09:07.877083 [debug] [Thread-1 (]: SQL status: SUCCESS 100000 in 2.291 seconds
[0m21:09:07.877083 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:07.877083 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
COMMIT
[0m21:09:08.159946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m21:09:08.159946 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.src_data.provider__dbt_tmp
[0m21:09:08.176534 [debug] [Thread-1 (]: Using snowflake connection "model.capston.provider"
[0m21:09:08.176534 [debug] [Thread-1 (]: On model.capston.provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.provider"} */
drop view if exists BHARATHDEV.src_data.provider__dbt_tmp cascade
[0m21:09:08.426788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m21:09:08.443178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dc35e5d-bf28-4ccc-a4a2-2b11d597218c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67D799210>]}
[0m21:09:08.443178 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model src_data.provider ...................... [[32mSUCCESS 100000[0m in 5.42s]
[0m21:09:08.459753 [debug] [Thread-1 (]: Finished running node model.capston.provider
[0m21:09:08.459753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:08.459753 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:09:08.459753 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:09:08.764563 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:09:08.764563 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:09:09.042790 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:09:09.058578 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:09:09.333249 [debug] [MainThread]: Connection 'model.capston.provider' was left open.
[0m21:09:09.333249 [debug] [MainThread]: On model.capston.provider: Close
[0m21:09:09.598843 [info ] [MainThread]: 
[0m21:09:09.598843 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.71 seconds (10.71s).
[0m21:09:09.598843 [debug] [MainThread]: Command end result
[0m21:09:09.709409 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:09:09.725032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:09:09.756275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:09:09.771896 [info ] [MainThread]: 
[0m21:09:09.771896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:09.771896 [info ] [MainThread]: 
[0m21:09:09.771896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:09:09.781120 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:09.781120 after 13.91 seconds
[0m21:09:09.782154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D674F6A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67B29EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67B29EF50>]}
[0m21:09:09.784114 [debug] [MainThread]: Flushing usage events
[0m21:09:11.216084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:28.921044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC73DFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC73DE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC73DC410>]}


============================== 21:09:28.921044 | 2e167a20-33b9-4f41-b594-70d5387136bb ==============================
[0m21:09:28.921044 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:09:28.921044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_care_gaps --vars {source_database : BHARATHDEV}', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:29.594356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC823EDD0>]}
[0m21:09:29.656841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC67C9290>]}
[0m21:09:29.672424 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:09:30.408406 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:09:30.706832 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:09:30.706832 [debug] [MainThread]: Partial parsing: added file: capston://models\fact\patient_events_care_gaps_fact.sql
[0m21:09:30.706832 [debug] [MainThread]: Partial parsing: deleted file: capston://models\Fact\patient_events_care_gaps_fact.sql
[0m21:09:31.052056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC945D2D0>]}
[0m21:09:31.161406 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:09:31.177060 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:09:31.270755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC4683DD0>]}
[0m21:09:31.270755 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:09:31.270755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC960B510>]}
[0m21:09:31.270755 [info ] [MainThread]: 
[0m21:09:31.270755 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:09:31.270755 [info ] [MainThread]: 
[0m21:09:31.281880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:09:31.286222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:09:31.527353 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:09:31.527353 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:09:31.527353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:33.245002 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.719 seconds
[0m21:09:33.260426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:09:33.260426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:09:33.276081 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:09:33.276081 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:09:33.276081 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:09:33.276081 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:09:33.276081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:33.276081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:34.935867 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.650 seconds
[0m21:09:34.935867 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.655 seconds
[0m21:09:34.935867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC73CFA90>]}
[0m21:09:34.935867 [debug] [Thread-1 (]: Began running node model.capston.dim_care_gaps
[0m21:09:34.951485 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_care_gaps ........................ [RUN]
[0m21:09:34.951485 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_care_gaps'
[0m21:09:34.951485 [debug] [Thread-1 (]: Began compiling node model.capston.dim_care_gaps
[0m21:09:34.951485 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_care_gaps"
[0m21:09:34.970999 [debug] [Thread-1 (]: Began executing node model.capston.dim_care_gaps
[0m21:09:35.048541 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:35.048541 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
INSERT_DATE AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.care_gaps p

  where p.insert_date > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_care_gaps)
 
)
SELECT SEQ_DIM_CARE_GAPS.NEXTVAL AS ID,
GAP_ID,
PATIENT_ID,
GAP_TYPE,
IDENTIFIED_DATE,
STATUS,
RECOMMENDED_ACTION,
MD5(
COALESCE(GAP_ID::varchar, '') ||  '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(GAP_TYPE::varchar, '') || '-' ||
COALESCE(IDENTIFIED_DATE::varchar, '') || '-' ||
COALESCE(STATUS::varchar, '') || '-' || 
COALESCE(RECOMMENDED_ACTION::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY, 
BASE_ADD_DATE, 
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m21:09:35.048541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:09:36.518641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m21:09:36.518641 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:36.518641 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m21:09:36.706098 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.182 seconds
[0m21:09:36.706098 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:36.706098 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table BHARATHDEV.tgt_dm.dim_care_gaps
[0m21:09:36.847667 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.130 seconds
[0m21:09:36.847667 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:36.847667 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CARE_GAPS"
[0m21:09:36.989047 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.140 seconds
[0m21:09:37.066956 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_care_gaps"
[0m21:09:37.082578 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:37.082578 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
-- back compat for old kwarg name
  
  begin;
[0m21:09:37.270033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m21:09:37.270033 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:37.270033 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
merge into BHARATHDEV.tgt_dm.dim_care_gaps as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.gap_id = DBT_INTERNAL_DEST.gap_id
                )

    
    when matched then update set
        "GAP_ID" = DBT_INTERNAL_SOURCE."GAP_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","GAP_TYPE" = DBT_INTERNAL_SOURCE."GAP_TYPE","IDENTIFIED_DATE" = DBT_INTERNAL_SOURCE."IDENTIFIED_DATE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RECOMMENDED_ACTION" = DBT_INTERNAL_SOURCE."RECOMMENDED_ACTION","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "GAP_ID", "PATIENT_ID", "GAP_TYPE", "IDENTIFIED_DATE", "STATUS", "RECOMMENDED_ACTION", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m21:09:37.709116 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m21:09:37.709116 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:37.709116 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
COMMIT
[0m21:09:37.880945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m21:09:37.896401 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp
[0m21:09:37.912805 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_care_gaps"
[0m21:09:37.912805 [debug] [Thread-1 (]: On model.capston.dim_care_gaps: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_care_gaps"} */
drop view if exists BHARATHDEV.tgt_dm.dim_care_gaps__dbt_tmp cascade
[0m21:09:38.148074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m21:09:38.179229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e167a20-33b9-4f41-b594-70d5387136bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC9D68490>]}
[0m21:09:38.179229 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_care_gaps ................... [[32mSUCCESS 0[0m in 3.23s]
[0m21:09:38.179229 [debug] [Thread-1 (]: Finished running node model.capston.dim_care_gaps
[0m21:09:38.179229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:38.179229 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:09:38.179229 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:09:38.460962 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:09:38.460962 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:09:38.742147 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:09:38.742147 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:09:39.040837 [debug] [MainThread]: Connection 'model.capston.dim_care_gaps' was left open.
[0m21:09:39.040837 [debug] [MainThread]: On model.capston.dim_care_gaps: Close
[0m21:09:39.431271 [info ] [MainThread]: 
[0m21:09:39.431271 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m21:09:39.431271 [debug] [MainThread]: Command end result
[0m21:09:39.478698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:09:39.495380 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:09:39.505354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:09:39.507347 [info ] [MainThread]: 
[0m21:09:39.508347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:39.510857 [info ] [MainThread]: 
[0m21:09:39.512850 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:09:39.515844 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:39.515844 after 10.71 seconds
[0m21:09:39.517835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC68FB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0ECA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0F0F0D0>]}
[0m21:09:39.518833 [debug] [MainThread]: Flushing usage events
[0m21:09:41.530944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:27.021295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A130C42B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A13015B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A130C43190>]}


============================== 21:15:27.036889 | 3d9992e3-2408-47f2-8967-9fa1ac338fff ==============================
[0m21:15:27.036889 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:15:27.036889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_claim_provider --vars {source_database : BHARATHDEV}', 'send_anonymous_usage_stats': 'True'}
[0m21:15:27.774734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A132A0FD90>]}
[0m21:15:27.868478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1300291D0>]}
[0m21:15:27.868478 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:15:28.619608 [debug] [MainThread]: checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105, vars: {'source_database': 'BHARATHDEV'}, profile: , target: , version: 1.9.1
[0m21:15:28.916374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:28.916374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:28.978900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A132D906D0>]}
[0m21:15:29.104516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:15:29.104516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:15:29.166964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A132EF2810>]}
[0m21:15:29.166964 [info ] [MainThread]: Found 14 models, 4 data tests, 12 sources, 471 macros
[0m21:15:29.166964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A13192D890>]}
[0m21:15:29.166964 [info ] [MainThread]: 
[0m21:15:29.166964 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m21:15:29.176973 [info ] [MainThread]: 
[0m21:15:29.179860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:15:29.183226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV'
[0m21:15:29.448474 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV"
[0m21:15:29.448474 [debug] [ThreadPool]: On list_BHARATHDEV: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV"} */
show terse schemas in database BHARATHDEV
    limit 10000
[0m21:15:29.448474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:31.162619 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.702 seconds
[0m21:15:31.171572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_src_data'
[0m21:15:31.172568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BHARATHDEV_tgt_dm'
[0m21:15:31.175050 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_src_data"
[0m21:15:31.190709 [debug] [ThreadPool]: Using snowflake connection "list_BHARATHDEV_tgt_dm"
[0m21:15:31.190709 [debug] [ThreadPool]: On list_BHARATHDEV_src_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_src_data"} */
show objects in BHARATHDEV.src_data limit 10000;
[0m21:15:31.190709 [debug] [ThreadPool]: On list_BHARATHDEV_tgt_dm: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "connection_name": "list_BHARATHDEV_tgt_dm"} */
show objects in BHARATHDEV.tgt_dm limit 10000;
[0m21:15:31.190709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:31.190709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:32.817255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.624 seconds
[0m21:15:32.817255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.624 seconds
[0m21:15:32.817255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A132DE40D0>]}
[0m21:15:32.817255 [debug] [Thread-1 (]: Began running node model.capston.dim_claim_provider
[0m21:15:32.817255 [info ] [Thread-1 (]: 1 of 1 START sql incremental model tgt_dm.dim_claim_provider ................... [RUN]
[0m21:15:32.832876 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.capston.dim_claim_provider'
[0m21:15:32.832876 [debug] [Thread-1 (]: Began compiling node model.capston.dim_claim_provider
[0m21:15:32.832876 [debug] [Thread-1 (]: Writing injected SQL for node "model.capston.dim_claim_provider"
[0m21:15:32.848497 [debug] [Thread-1 (]: Began executing node model.capston.dim_claim_provider
[0m21:15:32.938357 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:32.938357 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
create or replace  temporary view BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
  
   as (
    

WITH SOURCE AS (
SELECT CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
P.PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
LEAST(C.INSERT_DATE,P.INSERT_DATE) AS BASE_ADD_DATE,
CURRENT_TIMESTAMP() AS INSERT_DATE,
CURRENT_TIMESTAMP() AS UPDATE_DATE
FROM BHARATHDEV.src_data.claims C 
JOIN BHARATHDEV.src_data.provider P ON C.PROVIDER_ID = P.PROVIDER_ID 
where LEAST(C.INSERT_DATE,P.INSERT_DATE) > (select coalesce(max(base_add_date),'1900-01-01 00:00:00.000') from BHARATHDEV.tgt_dm.dim_claim_provider)
)
SELECT SEQ_DIM_CLAIM_PROVIDER.NEXTVAL AS ID,
CLAIM_ID,
PATIENT_ID,
SERVICE_DATE,
CLAIM_DATE,
CLAIM_AMOUNT,
CLAIM_STATUS,
PROVIDER_ID,
DIAGNOSIS_CODES,
PROCEDURE_CODES,
PROVIDER_NAME,
SPECIALTY,
NPI_NUMBER,
FACILITY_ID,
MD5(
COALESCE(CLAIM_ID::varchar, '') || '-' ||
COALESCE(PATIENT_ID::varchar, '') || '-' ||
COALESCE(SERVICE_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_DATE::varchar, '') || '-' ||
COALESCE(CLAIM_AMOUNT::varchar, '') || '-' ||
COALESCE(CLAIM_STATUS::varchar, '') || '-' ||
COALESCE(PROVIDER_ID::varchar, '') || '-' ||
COALESCE(DIAGNOSIS_CODES::varchar, '') || '-' ||
COALESCE(PROCEDURE_CODES::varchar, '') || '-' ||
COALESCE(PROVIDER_NAME::varchar, '') || '-' ||
COALESCE(SPECIALTY::varchar, '') || '-' ||
COALESCE(NPI_NUMBER::varchar, '') || '-' ||
COALESCE(FACILITY_ID::varchar, '') || '-' ||
COALESCE(BASE_ADD_DATE::varchar, '')
) AS HASH_KEY,
BASE_ADD_DATE,
INSERT_DATE,
UPDATE_DATE
FROM SOURCE
  );
[0m21:15:32.938357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:15:34.696653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m21:15:34.712274 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:34.727892 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m21:15:34.916008 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.187 seconds
[0m21:15:34.916008 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:34.916008 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table BHARATHDEV.tgt_dm.dim_claim_provider
[0m21:15:35.072223 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.152 seconds
[0m21:15:35.087842 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:35.087842 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
describe table "BHARATHDEV"."TGT_DM"."DIM_CLAIM_PROVIDER"
[0m21:15:35.228402 [debug] [Thread-1 (]: SQL status: SUCCESS 18 in 0.143 seconds
[0m21:15:35.290921 [debug] [Thread-1 (]: Writing runtime sql for node "model.capston.dim_claim_provider"
[0m21:15:35.290921 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:35.290921 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
-- back compat for old kwarg name
  
  begin;
[0m21:15:35.651905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m21:15:35.667522 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:35.667522 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
merge into BHARATHDEV.tgt_dm.dim_claim_provider as DBT_INTERNAL_DEST
        using BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.CLAIM_ID = DBT_INTERNAL_DEST.CLAIM_ID
                ) and (
                    DBT_INTERNAL_SOURCE.PROVIDER_ID = DBT_INTERNAL_DEST.PROVIDER_ID
                )

    
    when matched then update set
        "CLAIM_ID" = DBT_INTERNAL_SOURCE."CLAIM_ID","PATIENT_ID" = DBT_INTERNAL_SOURCE."PATIENT_ID","SERVICE_DATE" = DBT_INTERNAL_SOURCE."SERVICE_DATE","CLAIM_DATE" = DBT_INTERNAL_SOURCE."CLAIM_DATE","CLAIM_AMOUNT" = DBT_INTERNAL_SOURCE."CLAIM_AMOUNT","CLAIM_STATUS" = DBT_INTERNAL_SOURCE."CLAIM_STATUS","PROVIDER_ID" = DBT_INTERNAL_SOURCE."PROVIDER_ID","DIAGNOSIS_CODES" = DBT_INTERNAL_SOURCE."DIAGNOSIS_CODES","PROCEDURE_CODES" = DBT_INTERNAL_SOURCE."PROCEDURE_CODES","PROVIDER_NAME" = DBT_INTERNAL_SOURCE."PROVIDER_NAME","SPECIALTY" = DBT_INTERNAL_SOURCE."SPECIALTY","NPI_NUMBER" = DBT_INTERNAL_SOURCE."NPI_NUMBER","FACILITY_ID" = DBT_INTERNAL_SOURCE."FACILITY_ID","HASH_KEY" = DBT_INTERNAL_SOURCE."HASH_KEY","BASE_ADD_DATE" = DBT_INTERNAL_SOURCE."BASE_ADD_DATE","UPDATE_DATE" = DBT_INTERNAL_SOURCE."UPDATE_DATE"
    

    when not matched then insert
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")
    values
        ("ID", "CLAIM_ID", "PATIENT_ID", "SERVICE_DATE", "CLAIM_DATE", "CLAIM_AMOUNT", "CLAIM_STATUS", "PROVIDER_ID", "DIAGNOSIS_CODES", "PROCEDURE_CODES", "PROVIDER_NAME", "SPECIALTY", "NPI_NUMBER", "FACILITY_ID", "HASH_KEY", "BASE_ADD_DATE", "INSERT_DATE", "UPDATE_DATE")

;
[0m21:15:36.200235 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.535 seconds
[0m21:15:36.200235 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:36.200235 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
COMMIT
[0m21:15:36.403312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m21:15:36.430306 [debug] [Thread-1 (]: Applying DROP to: BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp
[0m21:15:36.448116 [debug] [Thread-1 (]: Using snowflake connection "model.capston.dim_claim_provider"
[0m21:15:36.450109 [debug] [Thread-1 (]: On model.capston.dim_claim_provider: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "capston", "target_name": "dev", "node_id": "model.capston.dim_claim_provider"} */
drop view if exists BHARATHDEV.tgt_dm.dim_claim_provider__dbt_tmp cascade
[0m21:15:36.669471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m21:15:36.700684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9992e3-2408-47f2-8967-9fa1ac338fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A133513110>]}
[0m21:15:36.700684 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model tgt_dm.dim_claim_provider .............. [[32mSUCCESS 0[0m in 3.87s]
[0m21:15:36.700684 [debug] [Thread-1 (]: Finished running node model.capston.dim_claim_provider
[0m21:15:36.700684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:36.716303 [debug] [MainThread]: Connection 'list_BHARATHDEV' was left open.
[0m21:15:36.716303 [debug] [MainThread]: On list_BHARATHDEV: Close
[0m21:15:37.390749 [debug] [MainThread]: Connection 'list_BHARATHDEV_src_data' was left open.
[0m21:15:37.390749 [debug] [MainThread]: On list_BHARATHDEV_src_data: Close
[0m21:15:37.642346 [debug] [MainThread]: Connection 'list_BHARATHDEV_tgt_dm' was left open.
[0m21:15:37.642346 [debug] [MainThread]: On list_BHARATHDEV_tgt_dm: Close
[0m21:15:37.892250 [debug] [MainThread]: Connection 'model.capston.dim_claim_provider' was left open.
[0m21:15:37.892250 [debug] [MainThread]: On model.capston.dim_claim_provider: Close
[0m21:15:38.159532 [info ] [MainThread]: 
[0m21:15:38.159532 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m21:15:38.159532 [debug] [MainThread]: Command end result
[0m21:15:38.234492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\manifest.json
[0m21:15:38.234492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Bharath\Desktop\Trainings\capston\target\semantic_manifest.json
[0m21:15:38.254157 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Bharath\Desktop\Trainings\capston\target\run_results.json
[0m21:15:38.255125 [info ] [MainThread]: 
[0m21:15:38.257117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:15:38.259110 [info ] [MainThread]: 
[0m21:15:38.260107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:15:38.264102 [debug] [MainThread]: Command `dbt run` succeeded at 21:15:38.263104 after 11.36 seconds
[0m21:15:38.266093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A130977FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A12A6BA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A130CB87D0>]}
[0m21:15:38.267090 [debug] [MainThread]: Flushing usage events
[0m21:15:39.991106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:13.311747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785E0E6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785D4E8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785E0E7450>]}


============================== 12:37:13.423764 | bc72d266-8582-412c-8c70-a7f94ad289f9 ==============================
[0m12:37:13.423764 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:37:13.423764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Bharath\\Desktop\\Trainings\\capston\\logs', 'profiles_dir': 'C:\\Users\\Bharath\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stage/*', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:21.602887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc72d266-8582-412c-8c70-a7f94ad289f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785EE4A710>]}
[0m12:37:21.708238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc72d266-8582-412c-8c70-a7f94ad289f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785D4C92D0>]}
[0m12:37:21.708238 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:37:22.885798 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:37:23.055028 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:37:23.055028 [debug] [MainThread]: previous checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, current checksum: b88ab5e1f7c855828705c8af3a88c58ac29daeac66aae3736c0a32881f5a5105
[0m12:37:23.055028 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:37:23.055028 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:37:23.065809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc72d266-8582-412c-8c70-a7f94ad289f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785DC16D90>]}
[0m12:37:27.582863 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var("source_database") }}: Required var 'source_database' not found in config:
  Vars supplied to <Configuration> = {}
[0m12:37:27.587873 [debug] [MainThread]: Command `dbt run` failed at 12:37:27.587873 after 14.92 seconds
[0m12:37:27.587873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857C4C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278600D9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278601EE650>]}
[0m12:37:27.587873 [debug] [MainThread]: Flushing usage events
[0m12:37:29.654395 [debug] [MainThread]: An error was encountered while trying to flush usage events
